<!DOCTYPE html>
<html lang="en"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v6.6.1 <https://qwtel.com/hydejack/>
--><head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="format-detection" content="telephone=no"> <meta http-equiv="x-ua-compatible" content="ie=edge"> <title>Ka's Blog &middot; Ka's Blog</title> <meta name="description" content="Ka’s blog description… "> <link rel="canonical" href="http://localhost:4000/page-27/"> <link rel="alternate" type="application/atom+xml" title="Ka's Blog Feed" href="http://localhost:4000/feed.xml"> <link rel="apple-touch-icon" href="/apple-touch-icon.png"> <!-- Place favicon.ico in the root directory --> <link rel="stylesheet" href="/assets/style.css"> <link id="_katexJS" rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.js"> <link id="_katexCSS" rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css"> <!--[if gt IE 8]><!----> <script> WebFontConfig = { google: { families: 'Roboto+Slab:700|Noto+Sans:400,400i,700,700i'.split('|') }, custom: { families: ['icomoon'], urls: ['/assets/icomoon/style.css'] } }; </script> <!--<![endif]--> <script> !function(n,e){function t(n,e){n.onload=function(){this.onerror=this.onload=null,e(null,n)},n.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),n)}}function o(n,e){n.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,n))}}n._loaded=!1,n.loadJSDeferred=function(a,d){function r(){n._loaded=!0;var r=e.createElement("script");r.src=a,d&&(("onload"in r?t:o)(r,d),r.onload||t(r,d));var l=e.getElementsByTagName("script")[0];l.parentNode.insertBefore(r,l)}n._loaded?r():n.addEventListener?n.addEventListener("load",r,!1):n.attachEvent?n.attachEvent("onload",r):n.onload=r}}(window,document); !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); window.disablePushState = false; window.disableDrawer = false; </script> <!--[if lt IE 9]> <script src="/assets/bower_components/html5shiv/dist/html5shiv.min.js"></script> <![endif]--> <!--[if gt IE 8]><!----> <style> article, aside, dialog, figcaption, figure, footer, header, hgroup, main, nav, section { display: block; } mark { background: #FF0; color: #000; } * { box-sizing: border-box; } html, body { margin: 0; padding: 0; } html { font-size: 16px; line-height: 1.75; } body { color: #333; background-color: #fff; overflow-y: scroll; } a { text-decoration: none; } .lead { margin-left: -1rem; margin-right: -1rem; } img, .img { display: block; max-width: 100%; margin-bottom: 1rem; border: none; } img.lead, .img.lead { max-width: calc(100% + 2rem); width: calc(100% + 2rem); } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-weight: bold; text-rendering: optimizeLegibility; } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 { margin: 3rem 0 1rem; line-height: 1.6; } h1, .h1 { font-size: 2rem; line-height: 1.25; } h2, .h2 { font-size: 1.5rem; } h3, .h3 { font-size: 1.17em; } p { margin-top: 0; margin-bottom: 1rem; } p.lead { font-size: 1.25rem; font-weight: 300; padding: 0 1rem; } ul, ol, dl { margin-top: 0; margin-bottom: 1rem; } ul, ol { padding-left: 1.25rem; } hr { position: relative; margin: 1.5rem 0; border: 0; border-top: 1px solid #eee; } .hr { padding-bottom: .5rem; border-bottom: 1px solid #eee; margin-bottom: 1.5rem; } h4, h5, h6, .h4, .h5, .h6 { margin-bottom: 0.5rem; font-size: 1rem; } table { margin-bottom: 1rem; width: 100%; width: calc(100% + 2rem); margin-left: -1rem; border: 1px solid #e5e5e5; border-collapse: collapse; border-spacing: 0; } td, th { padding: .25rem .5rem; border: 1px solid #e5e5e5; } td:first-child, th:first-child { padding-left: 1rem; } td:last-child, th:last-child { padding-right: 1rem; } thead + tbody, tbody + tbody, tfoot { border-top: 3px double #e5e5e5; } tbody tr:nth-child(odd) td, tbody tr:nth-child(odd) th { background-color: #f9f9f9; } footer { margin-bottom: 2rem; } .page, .post { margin-bottom: 3em; } .page li + li, .post li + li { margin-top: .25rem; } .page > header, .post > header { margin-bottom: 2rem; } .page-title, .post-title { margin-top: 0; } .post-date { display: block; margin-top: -0.5rem; margin-bottom: 1rem; color: #9a9a9a; } .related-posts { padding-left: 0; list-style: none; } .related-posts > li, .related-posts > li + li { margin-top: 1rem; } .related-posts > li > small, .related-posts > li + li > small { font-size: 75%; color: #9a9a9a; } .message { margin-bottom: 1rem; padding: 1rem; color: #787878; background-color: #f9f9f9; margin-left: -1rem; margin-right: -1rem; } /* * Global resets * * Update the foundational and global aspects of the page. */ body, main { /* Prevent side-scrolling on mobile */ position: relative; overflow-x: hidden; } @media screen { body::before { content: ''; width: .5rem; background: #e5e5e5; position: absolute; left: 0; top: 0; bottom: 0; } } @media screen and (min-width: 40em) { html { font-size: 17px; } } @media screen and (min-width: 54em) { html { font-size: 16px; } } @media screen and (min-width: 72em) { html { font-size: 17px; } } @media screen and (min-width: 125em) { html { font-size: 18px; } } .sr-only { display: none; } .clearfix, .sidebar-social::after, .clearafter::after { content: ""; display: table; clear: both; } a, .a { position: relative; padding-bottom: .15rem; border-bottom: 1px solid; } .img { overflow: hidden; background-color: #f9f9f9; } .img > img { margin: 0; width: 100%; height: 100%; } .sixteen-nine { position: relative; } .sixteen-nine::before { display: block; content: ""; width: 100%; padding-top: 56.25%; } .sixteen-nine > * { position: absolute; top: 0; left: 0; right: 0; bottom: 0; } h1 + hr, h2 + hr, h3 + hr, h4 + hr, h5 + hr, h6 + hr { margin-top: 0; } .fade-in { animation-duration: 500ms; animation-name: fade-in; animation-fill-mode: forwards; } @keyframes fade-in { from { transform: translateY(-2rem); opacity: 0; } 50% { transform: translateY(-2rem); opacity: 0; } to { transform: translateY(0); opacity: 1; } } .mb6 { margin-bottom: 6rem; } .sidebar { color: rgba(255, 255, 255, 0.75); text-align: left; /* Sidebar links */ } .sidebar::before { /* make sidebar slightly darker to increase text readability (when using a background image) */ content: ""; position: absolute; z-index: 2; top: 0; left: 0; bottom: 0; right: 0; background: linear-gradient(to bottom, rgba(32, 32, 32, 0) 0%, rgba(32, 32, 32, 0.5) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */ } .sidebar a { color: #fff; border-bottom-color: rgba(255, 255, 255, 0.2); } #_yDrawer { position: relative; padding: 1rem 0; } @media screen { #_yDrawer { padding: 2rem 1rem; min-height: 640px; min-height: 100vh; } } @media screen and (min-width: 54em) { #_yDrawer { position: fixed; top: 0; left: 0; bottom: 0; width: 18rem; margin-left: 0; } } @media screen and (min-width: 97.5em) { #_yDrawer { width: calc(50% - 28rem); } } @media screen { #_yDrawer.loaded { min-height: 0; padding: 0; } } .sidebar-bg { position: absolute; top: 0; right: 0; bottom: 0; left: 0; background: #202020 center / cover; } .sidebar-sticky { position: relative; z-index: 3; } @media screen { .sidebar-sticky { position: absolute; right: 2rem; bottom: 1rem; left: auto; max-width: 14rem; } } @media print { .sidebar-sticky { padding: 0 2rem; } } /* About section */ .sidebar-about > h1 { color: #fff; font-size: 2rem; } .sidebar-nav > ul { list-style: none; padding-left: 0; margin-bottom: .5rem; } a.sidebar-nav-item { font-weight: bold; display: block; line-height: 1.75; padding: .25rem 0; border-bottom: 1px solid rgba(255, 255, 255, 0.2); } @media screen { .y-drawer-scrim { z-index: 2; } .y-drawer-content { width: 18rem; left: -17.5rem; z-index: 3; } } @media screen and (min-width: 97.5em) { .y-drawer-content { width: calc(50% - 28rem); } } .sidebar-social { margin-bottom: .5rem; } .sidebar-social > ul { list-style: none; padding-left: 0; margin: 0 -.25rem; } .sidebar-social > ul > li { float: left; margin: 0 .25rem; } .sidebar-social > ul > li > a { display: inline-block; text-align: center; font-size: 1.6rem; line-height: 3rem; width: 3.1249rem; height: 4rem; padding: .5rem 0; } .sidebar-social > ul li + li { margin-top: 0; } .fixed-top { position: fixed; top: 0; left: 0; width: 100%; z-index: 1; } .navbar > .content { padding-top: 0; padding-bottom: 0; min-height: 0; height: 0; } .menu { display: inline-block; padding: 1.75rem 1.5rem; border-bottom: none; margin-left: -1.5rem; color: #9a9a9a !important; } .menu::after { content: "\2630"; } @media screen and (min-width: 54em) { .menu { padding: 1.25rem 1.5rem; position: absolute; left: -9999px; } .menu:focus { position: static; } } .animation-main { pointer-events: none; } .loading { display: none; } @media print { .menu { display: none; } } .animation-main { opacity: 0; will-change: opacity; } .loading { position: absolute; top: 0; right: 0; padding: 5.25rem 4.5rem; transform-origin: top right; transform: scale(0.33); } .content { position: relative; margin-left: auto; margin-right: auto; padding: 5rem 1rem 12rem; } @media screen { .content { max-width: 38rem; padding-left: 1.5rem; min-height: 100vh; } } @media screen and (min-width: 54em) { .content { max-width: 42rem; padding: 4rem 1rem 12rem; margin-left: 22rem; margin-right: 4rem; } } @media screen and (min-width: 72em) { .content { margin-left: 22rem; margin-right: 4rem; } } @media screen and (min-width: 92em) { .content { max-width: 48rem; } } @media screen and (min-width: 97.5em) { .content { margin: auto; } } .me { float: right; width: 6.5rem; height: 6.5rem; margin-left: 1rem; margin-bottom: .5rem; border-radius: 100%; position: relative; } @media screen and (min-width: 40em) { .me { width: 7rem; height: 7rem; } } @media screen and (min-width: 54em) { .me { width: 6.5rem; height: 6.5rem; } } @media screen and (min-width: 60em) { .me { width: 7rem; height: 7rem; } } main > footer { position: absolute; bottom: 0; left: 0; right: 0; padding: 0 1rem; color: #9a9a9a; font-size: smaller; text-align: center; } main > footer > p { margin-bottom: 0; } /* .card, .pagination-item { border-radius: 0!important; } */ /* @media screen { .sidebar-sticky { left: 2rem; max-width: none; } } */ html { font-family: Helvetica, Arial, sans-serif; } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-family: Helvetica, Arial, sans-serif; } </style> <link id="_stylePreload" rel="preload" as="style" href="/assets/css/hydejack.css?v=6.6.1"> <script>document.getElementById('_stylePreload').onload=function(){this.rel='stylesheet'}</script> <!-- NOTE: These styles interact with JavsScript, so they MUST NOT be changed --> <style id="_pageStyle"> .content a { color: #4f86aa; border-color: rgba(79, 134, 170, 0.2); } .content a:hover { border-color: #4f86aa; } :focus { outline-color: #4f86aa; } ::selection { color: #fff; background: #4f86aa; } ::-moz-selection { color: #fff; background: #4f86aa; } </style> <noscript> <link rel="stylesheet" href="/assets/css/hydejack.css?v=6.6.1"> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700|Noto+Sans:400,400i,700,700i"> <style> html { font-family: 'Noto Sans', Helvetica, Arial, sans-serif } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-family: 'Roboto Slab', Helvetica, Arial, sans-serif } </style> <link rel="stylesheet" href="/assets/icomoon/style.css"> </noscript> <!--<![endif]--> <!--[if gt IE 8]><!----> <script async src="/assets/bower_components/webfontloader/webfontloader.js"></script> <!--<![endif]--> </head> <body> <div class="navbar fixed-top"> <div class="content"> <span class="sr-only">Jump to:</span> <a id="_menu" class="menu no-hover" href="#_title"> <span class="sr-only">Menu</span> </a> </div> </div> <div id="_yPushState"> <div class="fade-in"> <main id="_main" class="content" role="main" data-color="#4f86aa" data-image=""> <article id="post-web/2011/12/06/yui-compressor%e4%bd%bf%e7%94%a8" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/web/2011/12/06/yui-compressor-e4-bd-bf-e7-94-a8.html" data-flip="title"> YUI Compressor使用 </a> </h1> <p class="post-date heading"> <time datetime="2011-12-06T01:54:37+08:00">06 Dec 2011</time> in <span>Web</span> on <span>Javascript</span>, <span>压缩</span>, <span>混淆</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>一般来说，js脚本混淆是吃力不讨好的事。没有真正的混淆，做得再好的工具混淆后，仍然可以被反推理。</p> <p>花在混淆上面的功夫相对于脚本本来的价值很可能是不划算的。</p> <p>但是，混淆一下起码还是有些作用的。</p> <p>使用混淆最担心的是造成脚本错误。</p> <p>我尝试用了YUI Compressor <a href="http://developer.yahoo.com/yui/compressor/">http://developer.yahoo.com/yui/compressor/</a>，觉得还不错。</p> <p>首先，它的混淆还是比较安全的：</p> <p>The YUI Compressor is JavaScript minifier designed to be <font color="#0000ff"><strong>100% safe</strong></font> and yield a higher compression ratio than most other tools.</p> <p>in the face of <a href="http://www.jslint.com/lint.html">evil features</a> such as <code>eval</code> or <code>with</code>, the YUI Compressor takes a defensive approach by not obfuscating any of the scopes containing the evil statemen。对于eval和with采取保护措施。</p> <p>在yui-yuicompressor-6e2bc23中的reademe中，我发现:</p> <p>+ Supports wildcards for specifying multiple input files.</p> <p>但是实际使用确是不支持通配符和多文件的，一次只能处理一个文件。</p> <p>这样导致要处理多个文件要么写bat脚本，要么写ant文件。但是仍不能多个合并到一个。</p> <p>这两个方法真丑！ant支持文档也找不到！</p> <p>它不是java写的吗？我还是自己写代码来条用它得了！</p> <p>下面是对源码中Bootstrap类的使用，添加功能不难吧！</p> <div><pre><span style="color: #0000ff">public</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">void</span> main(String args[]) <span style="color: #0000ff">throws</span> Exception
	{
		ClassLoader loader = <span style="color: #0000ff">new</span> JarClassLoader();
		Thread.currentThread().setContextClassLoader(loader);
		Class c = loader.loadClass(YUICompressor.<span style="color: #0000ff">class</span>.getName());
		Method main = c.getMethod(&quot;<span style="color: #8b0000">main</span>&quot;, <span style="color: #0000ff">new</span> Class[] { String[].<span style="color: #0000ff">class</span> });
		String srcpath = &quot;<span style="color: #8b0000">E/html</span>&quot;;
		String despath = &quot;<span style="color: #8b0000">E:/dest/all.js</span>&quot;;
		<span style="color: #008000">// main.invoke(null, new Object[]{new String[]{&quot;-v&quot;,&quot;-o&quot;,path + &quot;\all.js&quot;,&quot;--type&quot;,&quot;js&quot;,path + &quot;\xxx.js&quot;}});</span>

		String[] jss = { &quot;a<span style="color: #8b0000">.js</span>&quot;, &quot;b<span style="color: #8b0000">.js</span>&quot; }; //note the order
		File[] dess = <span style="color: #0000ff">new</span> File[jss.length];

		<span style="color: #0000ff">for</span> (<span style="color: #0000ff">int</span> i = 0; i &lt; jss.length; i++)
		{
			File tmpFile = File.createTempFile(&quot;<span style="color: #8b0000">yuicp</span>&quot;, <span style="color: #0000ff">null</span>);
			tmpFile.deleteOnExit();
			main.invoke(<span style="color: #0000ff">null</span>,
						<span style="color: #0000ff">new</span> Object[] { <span style="color: #0000ff">new</span> String[] { &quot;<span style="color: #8b0000">-v</span>&quot;, &quot;<span style="color: #8b0000">-o</span>&quot;, tmpFile.getAbsolutePath(), &quot;<span style="color: #8b0000">--type</span>&quot;, &quot;<span style="color: #8b0000">js</span>&quot;, srcpath + &quot;<span style="color: #8b0000">/</span>&quot; + jss[i] } });			
			dess[i] = tmpFile;
		}

		FileOutputStream out = <span style="color: #0000ff">new</span> FileOutputStream(despath);
		<span style="color: #0000ff">for</span> (<span style="color: #0000ff">int</span> i = 0; i &lt; dess.length; i++)
		{
			FileInputStream in = <span style="color: #0000ff">null</span>;
			<span style="color: #0000ff">try</span>
			{
				in = <span style="color: #0000ff">new</span> FileInputStream(dess[i]);
				copyLarge(in, out);
			}
			<span style="color: #0000ff">finally</span>{
				<span style="color: #0000ff">if</span> (in != <span style="color: #0000ff">null</span>){
					in.close();
				}
			}
		}
		
		out.close();
		<span style="color: #008000">// main.invoke(null, new Object[]{args});</span>
	}

	<span style="color: #0000ff">public</span> <span style="color: #0000ff">static</span> <span style="color: #0000ff">long</span> copyLarge(InputStream input, OutputStream output) <span style="color: #0000ff">throws</span> IOException
	{
		<span style="color: #0000ff">byte</span>[] buffer = <span style="color: #0000ff">new</span> <span style="color: #0000ff">byte</span>[1024*4];
		<span style="color: #0000ff">long</span> count = 0;
		<span style="color: #0000ff">int</span> n = 0;
		<span style="color: #0000ff">while</span> (-1 != (n = input.read(buffer)))
		{
			output.write(buffer, 0, n);
			count += n;
		}
		<span style="color: #0000ff">return</span> count;
	}</pre></div> <p>&nbsp;</p> <p>尝试了一下，还不错，压缩了50%以上。而且没有错误！</p> <p><span style="color:#00f;">注意，合并的所有文件最好都是未压缩的，否则合并后可能出现错误。</span></p> <p>后来发现了eclipse插件<a href="http://marketplace.eclipse.org/content/yuicompressor">http://marketplace.eclipse.org/content/yuicompressor</a></p> <p>其实这个插件在我的myeclipse里面存在n年了，今天才注意！</p> <p class="read-more">Continue reading <a class="heading" href="/web/2011/12/06/yui-compressor-e4-bd-bf-e7-94-a8.html" data-flip="title">YUI Compressor使用</a></p> </article> <article id="post-web/2011/12/01/web%e4%b8%8b%e8%bd%bd%e5%bc%b9%e5%87%ba%e6%a1%86%ef%bc%8c%e4%b9%b1%e7%a0%81%e7%ad%89%e9%97%ae%e9%a2%98" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/web/2011/12/01/web-e4-b8-8b-e8-bd-bd-e5-bc-b9-e5-87-ba-e6-a1-86-ef-bc-8c-e4-b9-b1-e7-a0-81-e7-ad-89-e9-97-ae-e9-a2-98.html" data-flip="title"> web下载,弹出框，乱码等问题 </a> </h1> <p class="post-date heading"> <time datetime="2011-12-01T19:06:13+08:00">01 Dec 2011</time> in <span>Web</span> on <span>Web下载</span>, <span>乱码</span>, <span>弹出框</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>对于一个下载链接，要想浏览器弹出保存对话框而不是直接打开文件，需要再返回头中设置Content-disposition说明。</p> <p>以java servlet代码为例:</p> <div><pre style="width: 858px; height: 73px">resp.setContentType( &quot;<span style="color: #8b0000">application/octet-stream;</span>&quot;);
resp.setHeader( &quot;<span style="color: #8b0000">Content-disposition</span>&quot;,&quot;<span style="color: #8b0000">attachment;filename=</span>&quot;+ URLEncoder.encode(f.getName(),&quot;<span style="color: #8b0000">utf-8</span>&quot;));</pre></div> <p>这两句让浏览器认识到附件是一个二进制流，只管下载。即使是txt文件也是如此。</p> <p>因此对于一个a tag将其href指向这样的下载链接的话，浏览器会弹出保存对话框，页面也不会跳到空白页。也就是不需要指定target=”_blank”的。<br /> </p> <p>对于乱码问题，需要设置文件名的编码。但是对于有空格和中文的文件名来说，弹出框显示的文件名各浏览器并不相同：</p> <p>FF:完全是utf-8编码后的形式，看不出原文件名。</p> <p>IE:中文可显示，但是空格还是以+号显示。</p> <p>chrome:同IE。</p> <p>&#160;</p> <p>参见:<br /> <br /> Content-disposition说明以及中文乱码<a href="http://hi.baidu.com/_javaf/blog/item/93ae0710715e9d1ab9127b94.html">http://hi.baidu.com/_javaf/blog/item/93ae0710715e9d1ab9127b94.html</a></p> <p class="read-more">Continue reading <a class="heading" href="/web/2011/12/01/web-e4-b8-8b-e8-bd-bd-e5-bc-b9-e5-87-ba-e6-a1-86-ef-bc-8c-e4-b9-b1-e7-a0-81-e7-ad-89-e9-97-ae-e9-a2-98.html" data-flip="title">web下载,弹出框，乱码等问题</a></p> </article> <article id="post-java/2011/11/30/%e5%85%b3%e4%ba%8ejvm%e5%8f%82%e6%95%b0" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/java/2011/11/30/e5-85-b3-e4-ba-8ejvm-e5-8f-82-e6-95-b0.html" data-flip="title"> 关于jvm参数 </a> </h1> <p class="post-date heading"> <time datetime="2011-11-30T22:42:46+08:00">30 Nov 2011</time> in <span>Java</span> on <span>Jvm options</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <h5>Java HotSpot VM参数类别</h5> <ul> <li>以-X开头的参数是非标准的（不保证在所有的VM实现里都支持），并且在后续的JDK版本发布中修改后不作通告。 </li> <li>以-XX开头的参数是不稳定的，并且它也不推荐，只是临时使用。这些参数同样在修改后不作通告。</li> </ul> <h5>一些有用的-XX参数</h5> <p>这些参数的默认值在不同的平台上可能会有不同的值。不同平台的不同默认值列在描述里。</p> <ul> <li>Boolean参数可以通过<code>-</code>XX<code>:+&lt;option&gt;进行开启(true)，通过</code><code>-</code>XX<code>:-&lt;option&gt;进行关闭(false)</code>。 </li> <li>Numeric参数可以通过<code>-</code>XX<code>:&lt;option&gt;=&lt;number&gt;进行</code>设置<code>。</code>数据可以包含'm'或'M'来表示兆，'k'或'K'表示千字节。'g'或'G'表示千兆。(例如, 32k等于32768)。 </li> <li>String参数可以通过<code>-</code>XX<code>:&lt;option&gt;=&lt;string&gt;进行设置</code>, 它通常用来指文件，路径或一些命令的列表。</li> </ul> <p>详见:<a href="http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html">http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html</a></p> <p class="read-more">Continue reading <a class="heading" href="/java/2011/11/30/e5-85-b3-e4-ba-8ejvm-e5-8f-82-e6-95-b0.html" data-flip="title">关于jvm参数</a></p> </article> <article id="post-web%E5%89%8D%E7%AB%AF/2011/11/25/javascript-%e6%97%b6%e9%97%b4%e6%93%8d%e4%bd%9c" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/web%E5%89%8D%E7%AB%AF/2011/11/25/javascript-e6-97-b6-e9-97-b4-e6-93-8d-e4-bd-9c.html" data-flip="title"> javascript 时间操作 </a> </h1> <p class="post-date heading"> <time datetime="2011-11-25T01:07:54+08:00">25 Nov 2011</time> in <span>Web前端</span> on <span>Javascript</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <ul> <li>时间相加减: </li> </ul> <blockquote><p>var dt = new Date();</p> <p>dt.setMonth(dt.getMonth() - 1); //减一个月</p> <p>dt.setMonth(dt.getMonth() + 1); //加一个月</p> <p>如果恰好是第一月即dt.getMonth()=0;那么dt.setMonth(dt.getMonth() - 1) = dt.setMonth(- 1),这时dt会变为上一年最后一个月，也是保证了减一个月的逻辑。</p> <p>同理适用于加法dt.setMinutes(60);这样dt是下一个小时了。</p> <p>其他依此类推……</p> </blockquote> <ul> <li>判断最近的整点: </li> </ul> <blockquote><p>往前最近的分钟:</p> <p>var dt = new Date();</p> <p>dt.setUTCSeconds(0);</p> <p>dt.setUTCMillSeconds(0);</p> <p>往后最近的分钟(包括本身如果就是整点分钟)：</p> <p>dt.setUTCSeconds(dt.getUTCSeconds() + 59);</p> <p>dt.setUTCMilliseconds(0); <br />dt.setUTCSeconds(0);</p></p> <p>其他依此类推……</p> </blockquote> <p class="read-more">Continue reading <a class="heading" href="/web%E5%89%8D%E7%AB%AF/2011/11/25/javascript-e6-97-b6-e9-97-b4-e6-93-8d-e4-bd-9c.html" data-flip="title">javascript 时间操作</a></p> </article> <article id="post-php/2011/11/24/wordpress%e9%97%ae%e9%a2%98" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/php/2011/11/24/wordpress-e9-97-ae-e9-a2-98.html" data-flip="title"> wordpress问题 </a> </h1> <p class="post-date heading"> <time datetime="2011-11-24T05:31:34+08:00">24 Nov 2011</time> in <span>Php</span> on <span>Wordpress</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>将网站上的wordpress安装到本机，数据库在wp-config.php中配好了，但是访问主页一直报500 internal错误。看apahe日志，</p> <p>[Wed Nov 23 20:53:42 2011] [warn] [client 127.0.0.1] mod_fcgid: read timeout from pipe <br />[Wed Nov 23 20:53:42 2011] [error] [client 127.0.0.1] Premature end of script headers: index.php</p> <p>在网上查，没有对症的。</p> <p>以我的经验很可能是数据库连接问题，于是另写个页面专门连数据库，成功了！这就让人郁闷了。</p> <p>没办法，打开define('WP_DEBUG', true);只好一行行用echo定位了，最后发现确实是数据库问题。在load.php中require_wp_db函数,定位到wp-db.php::db_connect函数。</p> <p>mysql_connect这一句有问题。晕，我不是专门测试了吗？</p> <p>经过比照，就只host一个用127.0.0.1可以，而用localhost就不行！</p> <p>问题在这！但是我使用jdbc使用localhost是可以的啊？</p> <p>查看host文件,果然localhost没有配置，映射localhost 127.0.0.1后，再测试就可以了。</p> <p>仍然不懂为什么jdbc可以自动找到localhost而php需要通过dns配置才行？</p> <p>这个问题解决后，数据库需要修改wp_options表，将siteurl和home设置成本机url。</p> <p>打开Mod_Rewrite模块,因为wordpress使用到了这个模块，所以要在apache http.conf中将LoadModule rewrite_module modules/mod_rewrite.so前面的注释去掉来启用此模块。另外需要为文件夹配置打开.htcaccess配置。如:</p> <p>&lt;Directory &quot;xxxx/public_html&quot;&gt;&#160;&#160;&#160; <br />&#160;&#160;&#160; AddHandler fcgid-script .php&#160; <br />&#160;&#160;&#160; FcgidWrapper &quot;xxxx/php-cgi.exe&quot; .php <br />&#160;&#160;&#160; Options execCGI <font color="#0000ff">FollowSymLinks</font> <br />&#160;&#160;&#160; AllowOverride <font color="#0000ff">All</font> <br />&#160;&#160;&#160; Order allow,deny <br />&#160;&#160;&#160; Allow from all&#160;&#160;&#160; <br />&lt;/Directory&gt;</p> <p>注意蓝字部分配置。</p> <p>wordpress根目录下的.htcaccess文件直接拷贝过来就行了。</p> <p>到这一步，本机的wordpress环境基本可用了！</p> <p>至于.htcaccess中的php.ini配置什么的，是虚拟主机具体环境需要的，这是wordpress安装时自动生成的？？反正对本机环境运行wordpress没什么问题。</p> <p>参见:</p> <p><a href="http://www.leapsoul.cn/?p=25">http://www.leapsoul.cn/?p=25</a>&#160; Apache Mod_Rewrite实现URL重写的配置方法</p> <p><a href="http://hi.baidu.com/%D1%F8%C0%CF%D4%BA%B3%A4/blog/item/6fb6764fd0533ff4d72afcd8.html">http://hi.baidu.com/%D1%F8%C0%CF%D4%BA%B3%A4/blog/item/6fb6764fd0533ff4d72afcd8.html</a>&#160; suPHP - 以属主身份来运行php</p> <p>但是访问本机wordpress比访问站点还慢！这是怎么回事？关了xdebug也是一样！后来发现是wp-utf8-excerpt这个插件比较慢，关了就好了。</p> <p>另外xdebug也是性能因素的很重要的个原因，打开xdebug会慢一倍以上，但是不打开又不好看调试信息。</p> <p>有的环境下会出现admin中样式乱套，发现是load-styles.php这个样式加载有问题，换个php版本试试看,例如5.3.3就可以解决这个问题。</p> <p>&#160;</p> <p>将最后编辑时间显示在文章上，需要在single.php和index.php中添加如下代码:</p> <div><pre><span style="color: #0000ff">&lt;?</span>php 
$u_time = get_the_time('<span style="color: #8b0000">U</span>');
$u_modified_time = get_the_modified_time('<span style="color: #8b0000">U</span>');
<a style="color: #0000ff" href="http://www.php.net/if">if</a> ($u_modified_time &gt;= $u_time + 86400) {
<a style="color: #0000ff" href="http://www.php.net/echo">echo</a> &quot;<span style="color: #8b0000">and last modified on </span>&quot;;
the_modified_time('<span style="color: #8b0000">F jS, Y</span>');
<a style="color: #0000ff" href="http://www.php.net/echo">echo</a> &quot;<span style="color: #8b0000"> at </span>&quot;;
the_modified_time();
<a style="color: #0000ff" href="http://www.php.net/echo">echo</a> &quot;<span style="color: #8b0000">, </span>&quot;; } 
<span style="color: #0000ff">?&gt;</span></pre></div> <p>&#160;</p> <p>无法使用wlw发布私有文章。MS宣称还没提供这种功能也没有提供插件的方式。</p> <div>&#160;</div> <p class="read-more">Continue reading <a class="heading" href="/php/2011/11/24/wordpress-e9-97-ae-e9-a2-98.html" data-flip="title">wordpress问题</a></p> </article> <article id="post-php/web/2011/11/23/%e3%80%90%e8%bd%ac%e3%80%91%e5%a6%82%e4%bd%95%e9%80%9a%e8%bf%87-apache-virtualhost-%e6%9d%a5%e8%ae%be%e7%bd%ae%e5%a4%9a%e4%b8%aa%e8%99%9a%e6%8b%9f%e4%b8%bb%e6%9c%ba" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/php/web/2011/11/23/e3-80-90-e8-bd-ac-e3-80-91-e5-a6-82-e4-bd-95-e9-80-9a-e8-bf-87-apache-virtualhost-e6-9d-a5-e8-ae-be-e7-bd-ae-e5-a4-9a-e4-b8-aa-e8-99-9a-e6-8b-9f-e4-b8-bb-e6-9c-ba.html" data-flip="title"> 如何通过 apache VirtualHost 来设置多个虚拟主机 </a> </h1> <p class="post-date heading"> <time datetime="2011-11-23T05:11:41+08:00">23 Nov 2011</time> in <span>Php</span> / <span>Web</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>本机调试php,开发的方法：</p> <p>httpd.conf 需要添加监听端口:</p> <p>Listen 10080 <br />Listen 10085</p> <p> 然后添加</p> <div>>NameVirtualHost 127.0.0.1:10080 <p class="read-more">Continue reading <a class="heading" href="/php/web/2011/11/23/e3-80-90-e8-bd-ac-e3-80-91-e5-a6-82-e4-bd-95-e9-80-9a-e8-bf-87-apache-virtualhost-e6-9d-a5-e8-ae-be-e7-bd-ae-e5-a4-9a-e4-b8-aa-e8-99-9a-e6-8b-9f-e4-b8-bb-e6-9c-ba.html" data-flip="title">如何通过 apache VirtualHost 来设置多个虚拟主机</a></p> </article> <article id="post-web%E5%89%8D%E7%AB%AF/2011/11/22/raphael-%e4%bb%8b%e7%bb%8d" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/web%E5%89%8D%E7%AB%AF/2011/11/22/raphael-e4-bb-8b-e7-bb-8d.html" data-flip="title"> raphael 介绍 </a> </h1> <p class="post-date heading"> <time datetime="2011-11-22T22:59:43+08:00">22 Nov 2011</time> in <span>Web前端</span> on <span>Extjs4</span>, <span>Raphael</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>对于无插件web chart，不久前还是头疼的事情，大部分解决方案是flash,包括extjs3。当前extjs4出来了，发现它是封装了vml和svg。虽然extjs4是基于沙箱的，可以和extjs3合用，但是我试过了，那性能是惨不忍睹。</p> <p>我看到jquery的chart插件flot <a href="http://code.google.com/p/flot/">http://code.google.com/p/flot/</a>, 但是它是使用canvas的，对于ie使用excanvas来包装,但是在我的ie浏览器中就报错了。</p> <p>让我们看看raphael,它是封装了vml和svg,而且，extjs4的chart也是基于它的！所以，完全可以使用raphael来画图！</p> <p>文档: <a href="http://raphaeljs.com/reference.html">http://raphaeljs.com/reference.html</a></p> <p>它的接口是按照svg来设计的，所以会参考到 w3c svg文档 <a href="http://www.w3.org/TR/SVG/painting.html">http://www.w3.org/TR/SVG/painting.html</a></p> <p>首先创建一个raphael对象:</p> <div><pre><span style="color: #0000ff">var</span> r = Raphael('holder', 500, 300);</pre></div> <p>上面的代码在页面的holder元素下创建了一个Paper对象。</p> <p>下面画一条线: Paper.path</p> <div><pre>r.path('M0,0,L200,200');</pre></div> <p>这里画了一个斜线，从画布原点，也就是左上角向坐标200,200处画线。其中的M表示将画笔起点移动到,L表示向某处画线。这是svg的语法，可参见: <a href="http://www.w3.org/TR/SVG/paths.html#PathData">http://www.w3.org/TR/SVG/paths.html#PathData</a></p> <p>上面的代码返回的是Element对象。</p> <p>然后我们来为这条线添加颜色:Element.attr</p> <div><pre>r.path('M0,0,L200,200').attr({stroke:'red','stroke-width':'5px'});</pre></div> <p>使用attr方法将画笔属性设置成红色和5像素宽。</p> <p>效果如图:</p> <p><a href="http://kazge.com/wp-content/uploads/2011/11/Snap1.gif"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Snap1" border="0" alt="Snap1" src="/assets/Snap1_thumb.gif" width="221" height="218" /></a></p> <p>我们再画个三角形:</p> <div><pre style="width: 858px; height: 33px">r.path('M{0},{1},L{2},{3}L{4},{5}Z',0,100,50,150,0,200).attr({fill:'blue'});</pre></div> <p>注意到，使用path的另外的形式，使用大括号中的参数来生成语句。其中的索引分别对应后面的参数位置。更多的格式见Raphael.format。另外我们指定了三个顶点，最后一个Z表示将此路径封闭。然后我们使用蓝色来填充这个封闭的三角形。</p> <p><a href="http://kazge.com/wp-content/uploads/2011/11/Snap2.gif"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Snap2" border="0" alt="Snap2" src="/assets/Snap2_thumb.gif" width="219" height="218" /></a></p> <p>我们再来写上文本：</p> <div><pre style="width: 858px; height: 48px">r.text(100,90,'Hello!').attr({stroke:'black','stroke-width':'2px',fill:'green','font-size':'90px'});</pre></div> <p>在上面的代码中，我们在100,90坐标处，写上了hello的文本。它是用2px黑色外框，绿色填充，90px大小的字体来绘制的。</p> <p><a href="http://kazge.com/wp-content/uploads/2011/11/Snap3.gif"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="Snap3" border="0" alt="Snap3" src="/assets/Snap3_thumb.gif" width="222" height="212" /></a></p> <p>完整的代码是:</p> <p>html代码:</p> <div>><span style="color: #0000ff">&lt;</span>!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;<span style="color: #0000ff">&gt;</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">html</span><span style="color: #0000ff">&gt;</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">head</span><span style="color: #0000ff">&gt;</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span>test.html<span style="color: #0000ff">&lt;/</span><span style="color: #800000">title</span><span style="color: #0000ff">&gt;</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta</span> <span style="color: #ff0000">http</span>-<span style="color: #ff0000">equiv</span>=<span style="color: #0000ff">&quot;keywords&quot;</span> <span style="color: #ff0000">content</span>=<span style="color: #0000ff">&quot;keyword1,keyword2,keyword3&quot;</span><span style="color: #0000ff">&gt;</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta</span> <span style="color: #ff0000">http</span>-<span style="color: #ff0000">equiv</span>=<span style="color: #0000ff">&quot;description&quot;</span> <span style="color: #ff0000">content</span>=<span style="color: #0000ff">&quot;this is my page&quot;</span><span style="color: #0000ff">&gt;</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">meta</span> <span style="color: #ff0000">http</span>-<span style="color: #ff0000">equiv</span>=<span style="color: #0000ff">&quot;content-type&quot;</span> <span style="color: #ff0000">content</span>=<span style="color: #0000ff">&quot;text/html; charset=ISO-8859-1&quot;</span><span style="color: #0000ff">&gt;</span> <span style="color: #008000">&lt;!--&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;--&gt;</span> <span style="color: #0000ff">&lt;</span><span style="color: #800000">script</span> <span style="color: #ff0000">type</span>=<span style="color: #0000ff">&quot;text/javascript&quot;</span> <span style="color: #ff0000">src</span>=<span style="color: #0000ff">&quot;raphael.js&quot;</span><span style="color: #0000ff">&gt;</span><span style="color: #0000ff">&lt;/</span><span style="color: #800000">script</span><span style="color: #0000ff">&gt;</span> <p class="read-more">Continue reading <a class="heading" href="/web%E5%89%8D%E7%AB%AF/2011/11/22/raphael-e4-bb-8b-e7-bb-8d.html" data-flip="title">raphael 介绍</a></p> </article> <article id="post-web%E5%89%8D%E7%AB%AF/2011/11/22/%e3%80%90%e8%bd%ac%e3%80%91extjs-4-0-%e7%9a%84%e6%94%b9%e5%8f%98-%e8%be%83%e4%b8%ba%e5%ae%8c%e6%95%b4%e7%9a%84%e4%bb%8b%e7%bb%8d%e3%80%82" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/web%E5%89%8D%E7%AB%AF/2011/11/22/e3-80-90-e8-bd-ac-e3-80-91extjs-4-0-e7-9a-84-e6-94-b9-e5-8f-98-e8-be-83-e4-b8-ba-e5-ae-8c-e6-95-b4-e7-9a-84-e4-bb-8b-e7-bb-8d-e3-80-82.html" data-flip="title"> 【转】ExtJS 4.0 的改变--较为完整的介绍。 </a> </h1> <p class="post-date heading"> <time datetime="2011-11-22T18:57:55+08:00">22 Nov 2011</time> in <span>Web前端</span> on <span>Extjs4</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>因为有过删帖的经验，还是转过来吧！ 原文:<a title="http://andy-ghg.iteye.com/blog/1133456" href="http://andy-ghg.iteye.com/blog/1133456">http://andy-ghg.iteye.com/blog/1133456</a></p> <p>惯例，看之前先看看我的很久很久以前的学习笔记（就是那个Word文档，没兴趣的可以不看，不影响）： <br /><a href="http://wenku.baidu.com/view/ce8d3e08763231126edb1146.html">http://wenku.baidu.com/view/ce8d3e08763231126edb1146.html</a><img src="/assets/icon_biggrin.gif" /> <br />本文里面不会详细介绍某些方法函数具体如何使用，例子全部自己写的（部分参考API和ExtJS 4.0 Developer Preview），应该不会有错，提到的方法函数只提供名字，自己去API看（在此严重鄙视一些照搬API就出本书捞钱的人） <br />基础上的变化： <br />兼容性 <br />ExtJS4最终会提供一个兼容ExtJS 3的解决方案。 <br />沙箱模式 <br />可是使用alias来为组件添加别名，类似以前的Ext.reg，不过alias会用不同的类别区分开来，例如，widget.xxxxx和feature.xxxxx是不一样的，虽然它们都是用alias来定义的，但是类别完全不同。 <br />包和命名空间的改变 <br />现在的ExtJS不再使用混乱的分包机制（其实以前的感觉更加直白），例如以前的Window，包名是Ext.Window，但是现在则是 Ext.window.Window，Ext.window包下还包括了Ext.window.MessageBox等。SplitButton则是 Ext.button.Split。 <br />创建新的对象 <br />现在ExtJS使用Ext.define函数来创建组件类，该函数还能实现自动加载JS类（uses属性，需设置Ext.Loader为开启详见下文，看不懂看API），它会自动的完成以前的ns（namespace）功能。例如下面 </p> <p>Js代码 </p> <ol> <li>Ext.ns(&quot;Foo.bar&quot;);&#160; </li> <li></li> <li>Foo.bar = Ext.extend(Ext.util.Observable,{&#160; </li> <li>//your code here </li> <li>});&#160; </li> <li>Ext.reg(&quot;foobar&quot;,Foo.bar);&#160; </li> </ol> <p>所以现在创建一个组件应该是这样的： </p> <p>Js代码 </p> <ol> <li>Ext.define(&quot;Foo.bar&quot;,{&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; extend : &quot;xxxxxx&quot;,&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; alias : &quot;widget.foobar&quot; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160; //your code here </li> <li>});&#160; </li> </ol> <p>现在ExtJS不再使用new关键字（当然你想用也没关系），而是推荐使用Ext.create函数来解决这个问题，例如以往我们创建一个组件的代码是 </p> <p>Js代码 </p> <ol> <li>var win = new Ext.Window({&#160; </li> <li>//some options </li> <li>});&#160; </li> </ol> <p>而现在则是 </p> <p>Js代码 </p> <ol> <li>var win = Ext.create(&quot;Ext.window.Window&quot;,{&#160; </li> <li>//some options </li> <li>});&#160; </li> </ol> <p>新的类加载方法--Class Loading <br />现在ExtJS可以动态加载JS文件（类）了，新的Ext.Loader类和一些其它的方法可以完成分别加载所需的JS文件，例如Ext.Loader里的setPath、require等方法函数可以做到动态加载。 <br />如果要使用这个功能，你首先得启用它： </p> <p>Js代码 </p> <ol> <li>Ext.Loader.setConfig({&#160; </li> <li>&#160;&#160;&#160;&#160;&#160; enabled: true,&#160; </li> <li>&#160;&#160;&#160;&#160;&#160; paths: {&#160; </li> <li>'My': 'my_own_path' </li> <li>&#160;&#160;&#160;&#160;&#160; }&#160; </li> <li>});&#160; </li> </ol> <p>path的意思是，当前引用这个JS的HTML文件同级的my_own_path目录被命名为My,所以以后该目录下的所有类名为My.xxxx的类都能被动态加载。 <br />例如以下文件目录： <br /><a href="http://kazge.com/wp-content/uploads/2011/11/d.gif"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="d副本" border="0" alt="d副本" src="/assets/d_thumb.gif" width="254" height="472" /></a> <br />在定义的时候就是： </p> <p>Js代码 </p> <ol> <li>Ext.Loader.setConfig({&#160; </li> <li>&#160;&#160;&#160;&#160;&#160; enabled: true,&#160; </li> <li>&#160;&#160;&#160;&#160;&#160; paths: {&#160; </li> <li>'NS': 'app' </li> <li>&#160;&#160;&#160;&#160;&#160; }&#160; </li> <li>});&#160; </li> </ol> <p>app/person文件夹中的类名为LKPerson的定义代码为： </p> <p>Js代码 </p> <ol> <li>Ext.define(&quot;NS.person.LKPerson&quot;, {&#160; </li> <li>&#160;&#160;&#160; extend : &quot;Ext.panel.Panel&quot;,&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; alias : &quot;widget.lkperson&quot;,//当然，这个属性不是必须的 </li> <li>&#160;&#160;&#160; border : false,&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; initComponent : function(){&#160; </li> <li>this.callParent(arguments);//这个arguments你懂，不懂Google </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </li> <li>})&#160; </li> </ol> <p>注意一点的就是，NS.person.LKPerson中的LKPerson就是文件名称（换句话说文件名必须是LKPerson且必须在person目录下） <br />好了，下面看看动态加载的两种方式： <br />require的用法如下： </p> <p>Js代码 </p> <ol> <li>Ext.require(&quot;Foo.bar&quot;);&#160; </li> <li></li> <li>Ext.define(&quot;AA.bb.CC&quot;,{&#160; </li> <li>//some options </li> <li>});&#160; </li> </ol> <p>require的意思是：在这个类（AA.bb.CC）被加载之前必须要加载Foo.bar并且被实例化（虽然好用但是劝各位不要滥用）。 <br />uses的用法如下： </p> <p>Js代码 </p> <ol> <li>Ext.define(&quot;AA.bb.CC&quot;,{&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; uses:[&quot;Foo.bar&quot;]&#160; </li> <li>});&#160; </li> </ol> <p>uses的意思是：在这个类（AA.bb.CC）在运行过程中要用到Foo.bar这个类，用到的时候再加载。 <br />其它的就不多解释，具体看API（这句话我最后说一遍<img src="/assets/icon_smile.gif" /> ） <br />混入类 <br />将一个类混入到另外一个类中，创建的时候一同创建： </p> <p>Js代码 </p> <ol> <li>Ext.define(&quot;Dog&quot;,{&#160; </li> <li>&#160;&#160;&#160; sayHello : function(){&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; alert(&quot;AAAA&quot;)&#160; </li> <li>&#160;&#160;&#160; }&#160; </li> <li>})&#160; </li> <li></li> <li>Ext.define(&quot;Animal&quot;,{&#160; </li> <li>&#160;&#160;&#160; mixins:{&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; dog:&quot;Dog&quot; </li> <li>&#160;&#160;&#160; }&#160; </li> <li>});&#160; </li> <li></li> <li></li> <li>Ext.onReady(function(){&#160; </li> <li>var an = Ext.create(&quot;Animal&quot;);&#160; </li> <li>&#160;&#160;&#160; an.mixins.dog.sayHello();&#160; </li> <li>})&#160; </li> </ol> <p>静态方法 <br />现在所有的类（是所有的ExtJS类，Ext.define定义的）都提供静态方法，可以很方便的定义： </p> <p>Js代码 </p> <ol> <li>Ext.define('Computer', {&#160; </li> <li>&#160;&#160;&#160;&#160; statics: {&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; factory: function(brand) {&#160; </li> <li>// 'this' in static methods refer to the class itself </li> <li>return new this(brand);&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </li> <li>&#160;&#160;&#160;&#160; },&#160; </li> <li></li> <li>&#160;&#160;&#160;&#160; constructor: function() { ... }&#160; </li> <li>});&#160; </li> <li></li> <li>var dellComputer = Computer.factory('Dell');&#160; </li> </ol> <p>Config <br />这个东西很时髦，看看用法： </p> <p>Js代码 </p> <ol> <li>Ext.define(&quot;Foo&quot;,{&#160; </li> <li>&#160;&#160;&#160; config: {&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; title: 'Default Title' </li> <li>&#160;&#160;&#160; },&#160; </li> <li>&#160;&#160;&#160; constructor: function(cfg) {&#160; </li> <li>this.initConfig(cfg);&#160; </li> <li>&#160;&#160;&#160; }&#160; </li> <li>});&#160; </li> <li></li> <li></li> <li>Ext.onReady(function(){&#160; </li> <li>var an = Ext.create(&quot;Foo&quot;,{&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; title:&quot;My Title&quot; </li> <li>&#160;&#160;&#160; });&#160; </li> <li>&#160;&#160;&#160; console.log(an.getTitle());&#160; </li> <li>});&#160; </li> </ol> <p>运行以下看看会出现什么？是My Title，config会自动生成getter和setter还有apply方法。 <br />Ext.env.Browser <br />这个东西很好很强大。。。。记得以前有Ext.isIE、Ext.isFF等方法判断浏览器，这次ExtJS 4不仅保留了以前的函数，还提供了更为强大Ext.env包来干这些事情，这个包下面还有其它两个类： <br />Ext.env.OS，顾名思义判断操作系统的，印象中ExtJS3中好像也有，不过这次新增了一些操作系统（主要是移动领域的操作系统）。 </p> <p>Js代码 </p> <ol> <li>if (Ext.os.is.Windows) {&#160; </li> <li>// Windows specific code here </li> <li>}&#160; </li> <li></li> <li>if (Ext.os.is.iOS) {&#160; </li> <li>// iPad, iPod, iPhone, etc. </li> <li>}&#160; </li> </ol> <p>Ext.env.FeatureDetector,这个绝对是新加的，主要用于判断HTML5和CSS3的，例如 </p> <ul> <li>CSS3/动画/转换 </li> <li>Canvas/ SVG/ VML </li> <li>触摸屏是否可用/方向 </li> <li>地理位置（HTML5的东西相信不陌生吧？） </li> <li>SqlDatabase </li> <li>WebSockets </li> <li>History </li> <li>音频 </li> <li>视频 </li> </ul> <p>Lang包的修改 <br />不知道lang是什么意思？（想想java.lang.String和java.lang.Number吧） <br />现在ExtJS 4一直在为新的ECMAScript标准做准备，这就是为什么要有这个包存在的原因，新的ECMAScript标准大家可以在ActionScript3 中详细看看，AS3基本上是遵循了下一代ECMAScript标准的，例如数据类型String、Number、Array、uint等等，ExtJS 4为了能与下一代的ECMAScript标准兼容，提前提供了这些东西的JS实现。 <br />Ext.Function <br />这个东西不知道大家平时用不用（也许大家用了没察觉到），我是经常用的。例如在以往的ExtJS版本中的代码： <p>Js代码 </p> <ol> <li>function foo(){&#160; </li> <li>//这里 </li> <li>}.createDelegate(scope,arguments);&#160; </li> </ol> <p>现在变成了（这里使用了一个综合的例子，大家可以重点看看bind的用法）： </p> <p>Js代码 </p> <ol> <li>Ext.define(&quot;Foo&quot;,{&#160; </li> <li>&#160;&#160;&#160; config:{&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; bar:&quot;I don't need sex,the government fucks me every day!&quot; </li> <li>&#160;&#160;&#160; },&#160; </li> <li>&#160;&#160;&#160; constructor : function(cfg){&#160; </li> <li>this.initConfig(cfg);&#160; </li> <li>&#160;&#160;&#160; }&#160; </li> <li>});&#160; </li> <li></li> <li>function fun(str){&#160; </li> <li>if(str){&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; alert(str);&#160; </li> <li>return;&#160; </li> <li>&#160;&#160;&#160; }&#160; </li> <li>&#160;&#160;&#160; alert(this.getBar());&#160; </li> <li>}&#160; </li> <li></li> <li>Ext.onReady(function(){&#160; </li> <li>var foo = Ext.create(&quot;Foo&quot;);&#160; </li> <li>&#160;&#160;&#160; Ext.bind(fun,foo)();//后面的括号你懂 </li> <li>//如果要传递参数可以以数组的形式放入，例如这样： </li> <li>//Ext.bind(fun,foo,[&quot;私はセックスを必要としない、政府は毎日私をファック！&quot;])(); </li> <li>});&#160; </li> </ol> <p>好了，我承认我有点那啥，不过希望不影响你继续读下去的兴趣。 <br />相同的还有 <br />ExtJS 3中的 </p> <p>Js代码 </p> <ol> <li>myFunction.defer(1000, scope);&#160; </li> </ol> <p>变成了4中的 </p> <p>Js代码 </p> <ol> <li>Ext.defer(myFunction, 1000, scope);&#160; </li> </ol> <p>还有callBack变成了pass，其它的自己去发掘。 <br />ExtJS的工具， <br />就是它：&#160; </p> <p>使用工具来编译你的JS，别想歪了，我知道JS是解释性的，详细的先看看这篇文章关于JSBuilder的作用： <br />http://hi.baidu.com/mallor/blog/item/5aec22f3e3dcbadc0b46e074.html <br />ExtJS的senchaSDKtools里面还提供了theme的制作（命令行的？？！！！），如果嫌ExtJS审美疲劳了可以试试这个。没玩过，所以不多解释，这里就告诉大家有这么回事儿就行了。 <br />关于大家最关心的数据 <br />这个Store想必是最关心的吧？（好了，外面貌似下冰雹了我晕，楼顶啪啪的！没时间去核实有北京的2011年七月二十六号晚上21：40：00左右的网友如果核实了留言证实一下）。 <br />嗯，说到冰雹，我觉得转载这篇文章的人应该注意一下告诉出处，这篇文章来自流水无心的ITEYE博客http://andy-ghg.iteye.com/ <br />扯远了，再回来继续说，这个Store现在改变可不小，详细的参看一下这个文章 <br />[url src='http://www.sencha.com/blog/ext-js-4-anatomy-of-a-model/']Countdown to Ext JS 4: Anatomy of a Model[/url] <br />好了，我知道我很懒，但是我可以简单说一下：modal代替了以往store中fields:[&quot;&quot;]的功能，但是我没用（实际使用有问题－ －！学艺不精），其实它是一个对象。。。对的是对象，MVC中的Model，好了，具体看API中关于MVC的介绍吧。 <br />Store中有一个变化就是baseParams变程了extraParams，注意下。每一个Store必须（？是否必须我也不知道，不过我现在是这么用的）要有一个Proxy且必须给一个type，现在的Store是这样写的： </p> <p>Js代码 </p> <ol> <li>Ext.define('User', {&#160; </li> <li>&#160;&#160;&#160; extend: 'Ext.data.Model',&#160; </li> <li>&#160;&#160;&#160; fields: [&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; {name: 'name',&#160; type: 'string'},&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; {name: 'age',&#160;&#160; type: 'int'}&#160; </li> <li>&#160;&#160;&#160; ]&#160; </li> <li>});&#160; </li> <li></li> <li>Ext.create(&quot;Ext.data.Store&quot;,{&#160; </li> <li>&#160;&#160;&#160; modal:&quot;User&quot;,&#160; </li> <li>&#160;&#160;&#160; proxy{&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; url : &quot;xxxx.do&quot;,&#160; </li> <li>&#160;&#160;&#160;&#160;&#160;&#160;&#160; type : &quot;ajax&quot; </li> <li>&#160;&#160;&#160; }&#160; </li> <li>})&#160; </li> </ol> <p>确实像那么回事儿，但是我不买账。。。在实际项目中我还是用我的fileds，在没彻底搞明白之前，不太敢这么弄<img src="/assets/icon_sad.gif" /> 。 <br />当然Store的改动远远不止这些，例如Proxy中新增了一个localStorage（Ext.data.proxy.LocalStorage）用于过渡到HTML5的localStorage等等。 <br />Draw绘图 <br />这个东西喜欢吗？我喜欢嘿嘿 <br />ExtJS4中提供了绘图，夸浏览器的，它内部实现了Canvas、SVG、VML等绘图方法，所以不同的浏览器它会自动使用该浏览器支持的绘图方式。支持IE6789、基于Gecko的浏览器(FF)、基于WebKit内核的浏览器(Chrome)。 <br />FX <br />从ExtJS提供这个以来我就不怎么用，原因很简单，浪费我的资源。。。。在新的ExtJS中，提供了类似Flex中关于动画的包方法Ext.fx.target.*，因为我不怎么用，所以不再阐述。 <br />布局 <br />这里的改变也很大，但是我觉得我在这个博客里说再多也没有你自己去运行它的例子来得要直观。 <br />好了，说了这么多，当然没有说完。。。。更多细节的改变的大家自己去发掘，推荐一篇文章《ExtJS 4.0 Developer Preview》，地址我忘了，网络时代相信对你来说找到它不难。 <br />最后做一下小小的广告： <br />我自己写的AS3（Flex）流程图例子快要完工了～！以前提供了一个简易的Demo版本，这次是经过重大修改后的（不是说以前有重大的BUG，而是以前的实在太难用－ －！），虽然是例子，但是如果您喜欢，完全可以用来做二次开发～！嘿嘿。下面是最新版的截图：&#160; </p> <p>目前提供了这些小组件：&#160; </p> <p>最后的最后 <br />从ExtJS 2.0一直用到4.0，从Flex 3用到Flex 4.5，感慨很多，在ExtJS成长的过程中我已渐渐的从前端转向了后端，不是因为我不再热爱前端和RIA，而是因为我觉得多方的了解与涉及能让自己得到更好的升华，目前专注j2ee开发，主要涉及Spring、Spring Security、CAS SSO、JMS ActiveMQ、Hibernate、jBPM、Oracle。 <br />其它的包括C#、C++QT4、jQuery等等也装模作样的学了些，所以不要再讨论某个语言某个框架的优劣，有这个时间可以学到很多很多东西。何必眼光这么狭隘呢？<img src="/assets/icon_smile.gif" />，争论太浪费精力。少点争论多点实际付出。<img src="/assets/icon_biggrin.gif" /> <br />Happy coding～！</p> <p>&#160;</p> <p>参见:</p> <p><a title="http://blog.csdn.net/zhangxin09/article/details/6191740" href="http://blog.csdn.net/zhangxin09/article/details/6191740">http://blog.csdn.net/zhangxin09/article/details/6191740</a>&#160; Ext JS 4的倒数：程序员预览 Countdown to Ext JS 4: Developer Preview</p> <p class="read-more">Continue reading <a class="heading" href="/web%E5%89%8D%E7%AB%AF/2011/11/22/e3-80-90-e8-bd-ac-e3-80-91extjs-4-0-e7-9a-84-e6-94-b9-e5-8f-98-e8-be-83-e4-b8-ba-e5-ae-8c-e6-95-b4-e7-9a-84-e4-bb-8b-e7-bb-8d-e3-80-82.html" data-flip="title">【转】ExtJS 4.0 的改变--较为完整的介绍。</a></p> </article> <article id="post-%E6%95%B0%E6%8D%AE%E5%BA%93/2011/11/22/%e9%87%8d%e8%a3%85mysql%e6%97%a0%e6%b3%95%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1%e7%9a%84%e9%97%ae%e9%a2%98" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/%E6%95%B0%E6%8D%AE%E5%BA%93/2011/11/22/e9-87-8d-e8-a3-85mysql-e6-97-a0-e6-b3-95-e5-90-af-e5-8a-a8-e6-9c-8d-e5-8a-a1-e7-9a-84-e9-97-ae-e9-a2-98.html" data-flip="title"> 重装mysql无法启动服务的问题 </a> </h1> <p class="post-date heading"> <time datetime="2011-11-22T06:27:48+08:00">22 Nov 2011</time> in <span>数据库</span> on <span>Mysql</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>之前装的mysql5.1，但是经过系统还原后服务没有了，干脆升级到5.5，但是安装好了，配置时最后一步就是启动不了！</p> <p>查看日志:programdata/data/pc.err发现：</p> <p>111121 22:16:50&#160; InnoDB: Log file .\ib_logfile0 did not exist: new to be created <br />InnoDB: Setting log file .\ib_logfile0 size to 10 MB <br />InnoDB: Database physically writes the file full: wait... <br />111121 22:16:50&#160; InnoDB: Log file .\ib_logfile1 did not exist: new to be created <br />InnoDB: Setting log file .\ib_logfile1 size to 10 MB <br />InnoDB: Database physically writes the file full: wait... <br /><font color="#ff0000">111121 22:16:50 InnoDB: Cannot initialize created log files because <br />111121 22:16:50 InnoDB: data files are corrupt, or new data files were <br />111121 22:16:50 InnoDB: created when the database was started previous <br />111121 22:16:50 InnoDB: time but the database was not shut down <br />111121 22:16:50 InnoDB: normally after that. <br /></font>111121 22:16:50 [ERROR] Plugin 'InnoDB' init function returned error. <br />111121 22:16:50 [ERROR] Plugin 'InnoDB' registration as a STORAGE ENGINE failed. <br />111121 22:16:50 [ERROR] Unknown/unsupported storage engine: INNODB <br />111121 22:16:50 [ERROR] Aborting</p> <p>在网上一查，原来要将ib_logfile0,ib_logfile1,还有ibdata1这三个文件删掉才行，它们分别在data和programdata目录中(在配置时由你指定的)。</p> <p>但是最后还是连不上，即使是服务启动了，就是连不上。</p> <p>总是在第四步的security setting上提示1045 Error,死活不能连接'root'@'localhost' password[YES]</p> <p>找这篇文章来:<a href="http://marclee.blog.163.com/blog/static/40317017201157101349210/">http://marclee.blog.163.com/blog/static/40317017201157101349210/</a> 任然不行。</p> <p>没办法，退回去下载5.1的，安装顺利。</p> <p>╮(╯▽╰)╭，还是老老实实用5.1吧！</p> <p class="read-more">Continue reading <a class="heading" href="/%E6%95%B0%E6%8D%AE%E5%BA%93/2011/11/22/e9-87-8d-e8-a3-85mysql-e6-97-a0-e6-b3-95-e5-90-af-e5-8a-a8-e6-9c-8d-e5-8a-a1-e7-9a-84-e9-97-ae-e9-a2-98.html" data-flip="title">重装mysql无法启动服务的问题</a></p> </article> <article id="post-php/2011/11/21/php%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1%e9%ab%98%e7%ba%a7%e5%8a%9f%e8%83%bd" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/php/2011/11/21/php-e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e9-ab-98-e7-ba-a7-e5-8a-9f-e8-83-bd.html" data-flip="title"> php面向对象高级功能 </a> </h1> <p class="post-date heading"> <time datetime="2011-11-21T22:41:07+08:00">21 Nov 2011</time> in <span>Php</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>php不支持函数重载(但可以使用__call模拟)，不支持运算符重载，不支持多继承。</p> <p>延迟静态绑定(版本需要php5.3以后):</p> <div>><span style="color: #0000ff">&lt;?</span>php <a style="color: #0000ff" href="http://www.php.net/class">class</a> A { static <a style="color: #0000ff" href="http://www.php.net/function">function</a> call() { <a style="color: #0000ff" href="http://www.php.net/echo">echo</a> __CLASS__; } <p class="read-more">Continue reading <a class="heading" href="/php/2011/11/21/php-e9-9d-a2-e5-90-91-e5-af-b9-e8-b1-a1-e9-ab-98-e7-ba-a7-e5-8a-9f-e8-83-bd.html" data-flip="title">php面向对象高级功能</a></p> </article> <h2 class="sr-only">Pagination</h2> <nav class="pagination heading" role="navigation"> <ul> <li class="pagination-item older" > <a rel="next" href="/page-28/">Older</a> </li> <li class="pagination-item newer" > <a rel="prev" href="/page-26/">Newer</a> </li> </ul> </nav> <footer> <hr/> <p>© 2011 - 2017. All rights reserved.</p> <p> <code>Powered by <a href="https://qwtel.com/hydejack/">Hydejack</a> v<span id="_version">6.6.1</span></code> </p> </footer> </main> </div> <div id="_yDrawer"> <div id="_sidebar" class="sidebar"> <div class="sidebar-bg" style="background-color:#4f86aa;background-image:url()"></div> <header class="sidebar-sticky" role="banner"> <div class="sidebar-about"> <img src="https://avatars0.githubusercontent.com/u/4122902?v=4&s=460" class="me" /> </div> <div class="sidebar-about"> <h1><a id="_title" href="/">Ka's Blog</a></h1> <p>Ka’s blog description…</p> </div> <nav class="sidebar-nav heading" role="navigation"> <span class="sr-only">Navigation:</span> <ul> <li> <a class="sidebar-nav-item" href="/categories.html">Categories</a> </li> <li> <a class="sidebar-nav-item" href="/archive.html">Archive</a> </li> <li> <a class="sidebar-nav-item" href="/tags.html">Tags</a> </li> <li> <a class="sidebar-nav-item" href="/about.html">About</a> </li> </ul> </nav> <div class="sidebar-social"> <span class="sr-only">Social:</span> <ul> <li> <a href="https://twitter.com/imhazige" title="Twitter"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a> </li> <li> <a href="https://github.com/imhazige" title="GitHub"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a> </li> <li> <a href="mailto:imhazige@gmail.com" title="Email"> <span class="icon-mail"></span> <span class="sr-only">Email</span> </a> </li> <li> <a href="https://imhazige.github.io/myblog/feed.xml" title="RSS"> <span class="icon-rss2"></span> <span class="sr-only">RSS</span> </a> </li> </ul> </div> </header> </div> </div> </div> <!--[if gt IE 9]><!----> <script>loadJSDeferred('/assets/js/hydejack.js?v=6.6.1');</script> <!--<![endif]--> </body>
</html>
