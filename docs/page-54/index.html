<!DOCTYPE html>
<html lang="en"><!--
 __  __                __                                     __
/\ \/\ \              /\ \             __                    /\ \
\ \ \_\ \   __  __    \_\ \      __   /\_\      __       ___ \ \ \/'\
 \ \  _  \ /\ \/\ \   /'_` \   /'__`\ \/\ \   /'__`\    /'___\\ \ , <
  \ \ \ \ \\ \ \_\ \ /\ \L\ \ /\  __/  \ \ \ /\ \L\.\_ /\ \__/ \ \ \\`\
   \ \_\ \_\\/`____ \\ \___,_\\ \____\ _\ \ \\ \__/.\_\\ \____\ \ \_\ \_\
    \/_/\/_/ `/___/> \\/__,_ / \/____//\ \_\ \\/__/\/_/ \/____/  \/_/\/_/
                /\___/                \ \____/
                \/__/                  \/___/

Powered by Hydejack v6.6.1 <https://qwtel.com/hydejack/>
--><head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="format-detection" content="telephone=no"> <meta http-equiv="x-ua-compatible" content="ie=edge"> <title>Ka's Blog &middot; Ka's Blog</title> <meta name="description" content="Ka’s blog description… "> <link rel="canonical" href="http://localhost:4000/page-54/"> <link rel="alternate" type="application/atom+xml" title="Ka's Blog Feed" href="http://localhost:4000/feed.xml"> <link rel="apple-touch-icon" href="/apple-touch-icon.png"> <!-- Place favicon.ico in the root directory --> <link rel="stylesheet" href="/assets/style.css"> <link id="_katexJS" rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.js"> <link id="_katexCSS" rel="dns-prefetch" href="/assets/bower_components/katex/dist/katex.min.css"> <!--[if gt IE 8]><!----> <script> WebFontConfig = { google: { families: 'Roboto+Slab:700|Noto+Sans:400,400i,700,700i'.split('|') }, custom: { families: ['icomoon'], urls: ['/assets/icomoon/style.css'] } }; </script> <!--<![endif]--> <script> !function(n,e){function t(n,e){n.onload=function(){this.onerror=this.onload=null,e(null,n)},n.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),n)}}function o(n,e){n.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,n))}}n._loaded=!1,n.loadJSDeferred=function(a,d){function r(){n._loaded=!0;var r=e.createElement("script");r.src=a,d&&(("onload"in r?t:o)(r,d),r.onload||t(r,d));var l=e.getElementsByTagName("script")[0];l.parentNode.insertBefore(r,l)}n._loaded?r():n.addEventListener?n.addEventListener("load",r,!1):n.attachEvent?n.attachEvent("onload",r):n.onload=r}}(window,document); !function(a){"use strict";var b=function(b,c,d){function e(a){return h.body?a():void setTimeout(function(){e(a)})}function f(){i.addEventListener&&i.removeEventListener("load",f),i.media=d||"all"}var g,h=a.document,i=h.createElement("link");if(c)g=c;else{var j=(h.body||h.getElementsByTagName("head")[0]).childNodes;g=j[j.length-1]}var k=h.styleSheets;i.rel="stylesheet",i.href=b,i.media="only x",e(function(){g.parentNode.insertBefore(i,c?g:g.nextSibling)});var l=function(a){for(var b=i.href,c=k.length;c--;)if(k[c].href===b)return a();setTimeout(function(){l(a)})};return i.addEventListener&&i.addEventListener("load",f),i.onloadcssdefined=l,l(f),i};"undefined"!=typeof exports?exports.loadCSS=b:a.loadCSS=b}("undefined"!=typeof global?global:this); !function(a){if(a.loadCSS){var b=loadCSS.relpreload={};if(b.support=function(){try{return a.document.createElement("link").relList.supports("preload")}catch(b){return!1}},b.poly=function(){for(var b=a.document.getElementsByTagName("link"),c=0;c<b.length;c++){var d=b[c];"preload"===d.rel&&"style"===d.getAttribute("as")&&(a.loadCSS(d.href,d,d.getAttribute("media")),d.rel=null)}},!b.support()){b.poly();var c=a.setInterval(b.poly,300);a.addEventListener&&a.addEventListener("load",function(){b.poly(),a.clearInterval(c)}),a.attachEvent&&a.attachEvent("onload",function(){a.clearInterval(c)})}}}(this); window.disablePushState = false; window.disableDrawer = false; </script> <!--[if lt IE 9]> <script src="/assets/bower_components/html5shiv/dist/html5shiv.min.js"></script> <![endif]--> <!--[if gt IE 8]><!----> <style> article, aside, dialog, figcaption, figure, footer, header, hgroup, main, nav, section { display: block; } mark { background: #FF0; color: #000; } * { box-sizing: border-box; } html, body { margin: 0; padding: 0; } html { font-size: 16px; line-height: 1.75; } body { color: #333; background-color: #fff; overflow-y: scroll; } a { text-decoration: none; } .lead { margin-left: -1rem; margin-right: -1rem; } img, .img { display: block; max-width: 100%; margin-bottom: 1rem; border: none; } img.lead, .img.lead { max-width: calc(100% + 2rem); width: calc(100% + 2rem); } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-weight: bold; text-rendering: optimizeLegibility; } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 { margin: 3rem 0 1rem; line-height: 1.6; } h1, .h1 { font-size: 2rem; line-height: 1.25; } h2, .h2 { font-size: 1.5rem; } h3, .h3 { font-size: 1.17em; } p { margin-top: 0; margin-bottom: 1rem; } p.lead { font-size: 1.25rem; font-weight: 300; padding: 0 1rem; } ul, ol, dl { margin-top: 0; margin-bottom: 1rem; } ul, ol { padding-left: 1.25rem; } hr { position: relative; margin: 1.5rem 0; border: 0; border-top: 1px solid #eee; } .hr { padding-bottom: .5rem; border-bottom: 1px solid #eee; margin-bottom: 1.5rem; } h4, h5, h6, .h4, .h5, .h6 { margin-bottom: 0.5rem; font-size: 1rem; } table { margin-bottom: 1rem; width: 100%; width: calc(100% + 2rem); margin-left: -1rem; border: 1px solid #e5e5e5; border-collapse: collapse; border-spacing: 0; } td, th { padding: .25rem .5rem; border: 1px solid #e5e5e5; } td:first-child, th:first-child { padding-left: 1rem; } td:last-child, th:last-child { padding-right: 1rem; } thead + tbody, tbody + tbody, tfoot { border-top: 3px double #e5e5e5; } tbody tr:nth-child(odd) td, tbody tr:nth-child(odd) th { background-color: #f9f9f9; } footer { margin-bottom: 2rem; } .page, .post { margin-bottom: 3em; } .page li + li, .post li + li { margin-top: .25rem; } .page > header, .post > header { margin-bottom: 2rem; } .page-title, .post-title { margin-top: 0; } .post-date { display: block; margin-top: -0.5rem; margin-bottom: 1rem; color: #9a9a9a; } .related-posts { padding-left: 0; list-style: none; } .related-posts > li, .related-posts > li + li { margin-top: 1rem; } .related-posts > li > small, .related-posts > li + li > small { font-size: 75%; color: #9a9a9a; } .message { margin-bottom: 1rem; padding: 1rem; color: #787878; background-color: #f9f9f9; margin-left: -1rem; margin-right: -1rem; } /* * Global resets * * Update the foundational and global aspects of the page. */ body, main { /* Prevent side-scrolling on mobile */ position: relative; overflow-x: hidden; } @media screen { body::before { content: ''; width: .5rem; background: #e5e5e5; position: absolute; left: 0; top: 0; bottom: 0; } } @media screen and (min-width: 40em) { html { font-size: 17px; } } @media screen and (min-width: 54em) { html { font-size: 16px; } } @media screen and (min-width: 72em) { html { font-size: 17px; } } @media screen and (min-width: 125em) { html { font-size: 18px; } } .sr-only { display: none; } .clearfix, .sidebar-social::after, .clearafter::after { content: ""; display: table; clear: both; } a, .a { position: relative; padding-bottom: .15rem; border-bottom: 1px solid; } .img { overflow: hidden; background-color: #f9f9f9; } .img > img { margin: 0; width: 100%; height: 100%; } .sixteen-nine { position: relative; } .sixteen-nine::before { display: block; content: ""; width: 100%; padding-top: 56.25%; } .sixteen-nine > * { position: absolute; top: 0; left: 0; right: 0; bottom: 0; } h1 + hr, h2 + hr, h3 + hr, h4 + hr, h5 + hr, h6 + hr { margin-top: 0; } .fade-in { animation-duration: 500ms; animation-name: fade-in; animation-fill-mode: forwards; } @keyframes fade-in { from { transform: translateY(-2rem); opacity: 0; } 50% { transform: translateY(-2rem); opacity: 0; } to { transform: translateY(0); opacity: 1; } } .mb6 { margin-bottom: 6rem; } .sidebar { color: rgba(255, 255, 255, 0.75); text-align: left; /* Sidebar links */ } .sidebar::before { /* make sidebar slightly darker to increase text readability (when using a background image) */ content: ""; position: absolute; z-index: 2; top: 0; left: 0; bottom: 0; right: 0; background: linear-gradient(to bottom, rgba(32, 32, 32, 0) 0%, rgba(32, 32, 32, 0.5) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */ } .sidebar a { color: #fff; border-bottom-color: rgba(255, 255, 255, 0.2); } #_yDrawer { position: relative; padding: 1rem 0; } @media screen { #_yDrawer { padding: 2rem 1rem; min-height: 640px; min-height: 100vh; } } @media screen and (min-width: 54em) { #_yDrawer { position: fixed; top: 0; left: 0; bottom: 0; width: 18rem; margin-left: 0; } } @media screen and (min-width: 97.5em) { #_yDrawer { width: calc(50% - 28rem); } } @media screen { #_yDrawer.loaded { min-height: 0; padding: 0; } } .sidebar-bg { position: absolute; top: 0; right: 0; bottom: 0; left: 0; background: #202020 center / cover; } .sidebar-sticky { position: relative; z-index: 3; } @media screen { .sidebar-sticky { position: absolute; right: 2rem; bottom: 1rem; left: auto; max-width: 14rem; } } @media print { .sidebar-sticky { padding: 0 2rem; } } /* About section */ .sidebar-about > h1 { color: #fff; font-size: 2rem; } .sidebar-nav > ul { list-style: none; padding-left: 0; margin-bottom: .5rem; } a.sidebar-nav-item { font-weight: bold; display: block; line-height: 1.75; padding: .25rem 0; border-bottom: 1px solid rgba(255, 255, 255, 0.2); } @media screen { .y-drawer-scrim { z-index: 2; } .y-drawer-content { width: 18rem; left: -17.5rem; z-index: 3; } } @media screen and (min-width: 97.5em) { .y-drawer-content { width: calc(50% - 28rem); } } .sidebar-social { margin-bottom: .5rem; } .sidebar-social > ul { list-style: none; padding-left: 0; margin: 0 -.25rem; } .sidebar-social > ul > li { float: left; margin: 0 .25rem; } .sidebar-social > ul > li > a { display: inline-block; text-align: center; font-size: 1.6rem; line-height: 3rem; width: 3.1249rem; height: 4rem; padding: .5rem 0; } .sidebar-social > ul li + li { margin-top: 0; } .fixed-top { position: fixed; top: 0; left: 0; width: 100%; z-index: 1; } .navbar > .content { padding-top: 0; padding-bottom: 0; min-height: 0; height: 0; } .menu { display: inline-block; padding: 1.75rem 1.5rem; border-bottom: none; margin-left: -1.5rem; color: #9a9a9a !important; } .menu::after { content: "\2630"; } @media screen and (min-width: 54em) { .menu { padding: 1.25rem 1.5rem; position: absolute; left: -9999px; } .menu:focus { position: static; } } .animation-main { pointer-events: none; } .loading { display: none; } @media print { .menu { display: none; } } .animation-main { opacity: 0; will-change: opacity; } .loading { position: absolute; top: 0; right: 0; padding: 5.25rem 4.5rem; transform-origin: top right; transform: scale(0.33); } .content { position: relative; margin-left: auto; margin-right: auto; padding: 5rem 1rem 12rem; } @media screen { .content { max-width: 38rem; padding-left: 1.5rem; min-height: 100vh; } } @media screen and (min-width: 54em) { .content { max-width: 42rem; padding: 4rem 1rem 12rem; margin-left: 22rem; margin-right: 4rem; } } @media screen and (min-width: 72em) { .content { margin-left: 22rem; margin-right: 4rem; } } @media screen and (min-width: 92em) { .content { max-width: 48rem; } } @media screen and (min-width: 97.5em) { .content { margin: auto; } } .me { float: right; width: 6.5rem; height: 6.5rem; margin-left: 1rem; margin-bottom: .5rem; border-radius: 100%; position: relative; } @media screen and (min-width: 40em) { .me { width: 7rem; height: 7rem; } } @media screen and (min-width: 54em) { .me { width: 6.5rem; height: 6.5rem; } } @media screen and (min-width: 60em) { .me { width: 7rem; height: 7rem; } } main > footer { position: absolute; bottom: 0; left: 0; right: 0; padding: 0 1rem; color: #9a9a9a; font-size: smaller; text-align: center; } main > footer > p { margin-bottom: 0; } /* .card, .pagination-item { border-radius: 0!important; } */ /* @media screen { .sidebar-sticky { left: 2rem; max-width: none; } } */ html { font-family: Helvetica, Arial, sans-serif; } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-family: Helvetica, Arial, sans-serif; } </style> <link id="_stylePreload" rel="preload" as="style" href="/assets/css/hydejack.css?v=6.6.1"> <script>document.getElementById('_stylePreload').onload=function(){this.rel='stylesheet'}</script> <!-- NOTE: These styles interact with JavsScript, so they MUST NOT be changed --> <style id="_pageStyle"> .content a { color: #4f86aa; border-color: rgba(79, 134, 170, 0.2); } .content a:hover { border-color: #4f86aa; } :focus { outline-color: #4f86aa; } ::selection { color: #fff; background: #4f86aa; } ::-moz-selection { color: #fff; background: #4f86aa; } </style> <noscript> <link rel="stylesheet" href="/assets/css/hydejack.css?v=6.6.1"> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:700|Noto+Sans:400,400i,700,700i"> <style> html { font-family: 'Noto Sans', Helvetica, Arial, sans-serif } h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6, .heading { font-family: 'Roboto Slab', Helvetica, Arial, sans-serif } </style> <link rel="stylesheet" href="/assets/icomoon/style.css"> </noscript> <!--<![endif]--> <!--[if gt IE 8]><!----> <script async src="/assets/bower_components/webfontloader/webfontloader.js"></script> <!--<![endif]--> </head> <body> <div class="navbar fixed-top"> <div class="content"> <span class="sr-only">Jump to:</span> <a id="_menu" class="menu no-hover" href="#_title"> <span class="sr-only">Menu</span> </a> </div> </div> <div id="_yPushState"> <div class="fade-in"> <main id="_main" class="content" role="main" data-color="#4f86aa" data-image=""> <article id="post-html5/2011/06/09/%e3%80%90%e8%bd%ac%e3%80%91novnc-html5" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/html5/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91novnc-html5.html" data-flip="title"> 【转】noVNC html5 </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T20:36:57+08:00">09 Jun 2011</time> in <span>Html5</span> on <span>Html5</span>, <span>Javascript web 前端</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> </p> <p> <a id="internal-source-marker_0.5069436758926215" href="http://github.com/kanaka/noVNC"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">noVNC</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">是个VNC客户端，采用HTML 5 WebSockets、Canvas和JavaScript实现。近日，InfoQ有幸采访到了Joel Martin以了解noVNC及其在</span><a href="http://www.infoq.com/html-5"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">HTML 5</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">应用开发上的经验：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">InfoQ：Joel，能否谈谈noVNC的整体架构，各个组件是如何搭配到一起的？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">Joel</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">：noVNC的架构主要由以下6个组件构成：</span> <ul> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">核心的VNC/RFB实现：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">该组件封装了所有的RFB协议相关的内容，是驱动其他组件的主要状态机。</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">Canvas抽象：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">该组件为HTML5 canvas API提供了一个抽象，还会进行Canvas特性检测，对于没有完整支持HTML5 canvas规范或是实现有问题的浏览器，组件会采取其他一些办法解决这个问题。</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">用户界面：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">封装了所有的HTML DOM交互（除了canvas）。该组件会渲染页面控件，如连接/断开连接按钮、设置以及状态反馈。noVNC的一个设计目标就是要能轻松加到现有的套件当中，因此该组件是可选的。</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">辅助功能：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">包含了noVNC所用的一些杂项功能与扩展，包括对JavaScript数组的扩展（使之可以当作队列使用）、跨浏览器的事件处理以及调试与日志等。我还会从其他一些资源中引入一些JavaScript库以处理base64编解码和DES加密（用于VNC认证）。</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">WebSockets回退：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">现在的大多数浏览器都没有本地的WebSockets支持，因此我为这些浏览器添加了一个</span><a href="http://github.com/gimite/web-socket-js"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">Flash（Flex）仿真器</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">，使用WebSockets加密技术扩展了最初的项目。</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">WebSockets到TCP的代理：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">WebSockets 标准并非纯粹的TCP socket实现。标准中有类似于HTTP的握手以建立初始连接，接下来的每一帧都以0字节开始，255字节结束。在VNC服务器开始支持 WebSockets前（ 我很希望能做到这一点），我们还是需要代理在WebSockets和标准的TCP sockets之间进行转换。我已经实现了一个通用代理（有Python和C两个版本），这对于那些从事着WebSockets开发的人来说有一定的帮助 作用。</span></li> </ul> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">InfoQ：在开发HTML5应用时遇到的挑战主要有哪些？开发者需要提防哪些陷阱呢？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">Joel：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">主要的挑战在于对那些缺乏HTML5特性以及只支持部分HTML5特性、甚至连部分特性都支持不好的 浏览器提供回退支持。比如说，虽然Chrome 5和Safari 5都提供了本地的WebSockets支持，但当前版本的Firefox和Opera则不支持。一些老版本的浏览器也没有提供canvas像素操纵 API（更糟的是，有的浏览器虽然提供了支持，但一使用Arora 0.5就崩溃了）。已发布的各个版本的Internet Explorer都没有内置WebSockets，甚至连最基本的内置canvas支持都没有（IE 9 Preview开始提供canvas支持）。另一个挑战在于跨越多个浏览器的性能优化问题。每个浏览器都有不同的性能特质，在同一浏览器的不同版本中这一 点也不尽相同（甚至同一个浏览器的不同操作系统版本也不一样）。只有很少的地方需要使用到浏览器检测技术，但对于性能优化问题，我觉得浏览器检测技术是必 不可少的。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">InfoQ：你都使用了哪些工具？目前的开发工具足以承担起构建HTML5应用的重任么？你希望今后能出来哪些新工具呢？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">Joel：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">我的开发环境非常精简，使用vim（加上很多扩展）在Linux上编写代码。频繁使用firefox上的firebug和Chrome中内置的开发者工具进行调试与分析。我还使用了Crockford的JSLint以保持JavaScript代码的整洁性。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">我希望firebug与Chrome中的分析工具能给出比函数级别粒度更细的反馈信息，能告诉我们哪部分代码对垃圾收集产生了重要影响。现在noVNC代码还在不断优化，垃圾收集器已经成为一个主要的性能瓶颈，我开始深入到其中解决问题了。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">我希望出来的新工具是代码分析器（就像JSLint那样），可以扫描Javascript代码基并生成好看的浏览器支持表格。我期望的输出形式是这样的： 上面是代码中所用的特性列表，左边则是主要的浏览器与版本号。接下来，每个单元格就会报告代码使用特性的方式是否为给定的浏览器/版本所支持。虽说这么做 并不会导致不同浏览器上代码测试的工作量，但毫无疑问，它有助于我们在开发过程中了解是否已经偏离了轨道。在理想情况下，扫描器还应该检测出 Javascript是否针对某个特性使用了恰当的检测/问题解决办法。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">InfoQ：对于目前的规范与实现来说，要克服的局限性主要有哪些呢？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">Joel：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">值得庆幸的是规范做的很棒。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">RFB（VNC）协议的文档在这里</span><a href="http://tigervnc.org/cgi-bin/rfbproto"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">http://tigervnc.org/cgi-bin/rfbproto</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">这个站点提供了很好的Javascript参考信息（包括哪个浏览器版本支持哪些特性）：</span><a href="http://www.hunlock.com/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">http://www.hunlock.com/</span></a> <br /><a href="http://www.hunlock.com/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline"></span></a> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">我发现一个非常棒的站点，里面归纳了哪些浏览器支持哪些特性（涵盖了HTML5等内容），网址是</span><a href="http://caniuse.com/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">http://caniuse.com/</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">。站点</span><a href="http://quirksmode.org/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">http://quirksmode.org</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">更 是无价之宝（这就是著名的PPK站点，他是知名的JavaScript图书PPK on JavaScript的作者——译者注），详尽列出了哪些浏览器支持哪些API以及如何解决众多的限制。我要克服的最困难的浏览器限制就是缺乏本地的跨浏 览器WebSockets支持。这是最近才出来的标准，还处在变更当中，但很多浏览器都纷纷采用了该标准。目前webkit支持该标准，因此Chrome 5和Safari 5都支持，不久之后iPhone也会支持。firefox 4可能也会加入对其的支持。当然了，Opera也会在不久的将来支持它。最大的问题在于IE 9是否会支持。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">如前所述，我使用Flash WebSockets仿真器来支持那些没有本地支持的浏览器。扩展、修复以及解决Flash（ActionScript）代码中的bug是个艰巨的任务。 桥接Javascript和Flash也是个让人头疼的问题。Adobe提供了FABridge（仿真器使用到了），但这个桥太慢、太笨重，难以调试。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">听说IE 9将提供完整（速度也很快）的canvas支持后我感到兴奋异常，但我还得解决旧版本IE缺乏本地canvas支持这个局限性，因为IE用的实在是太多 了。现在有两个办法，一个是explorercanvas，另一个是fxcanvas。前者是个JavaScript库，它基于IE的VML支持创建了一 个canvas API；后者则是个canvas的Flash实现，但这两个办法都不是十全十美的。Explorercanvas不支持像素操纵（这是因为VML是矢量而 非光栅），而fxcanvas则提供了一个类似于canvas的API，它存在一些严重的异步处理问题。遗憾的是，相对于其他支持canvas模拟的浏览 器来说，IE 6、7和8中的JavaScript引擎太慢了，这两个办法都没法很好地应用到IE上，现在我只能期望人们使用Chrome Frame了。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">InfoQ：关于noVNC项目，未来的计划如何？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Joel：现在，我感觉最兴奋的事情就是能与一些QEMU/KVM开发者们（包括一个Google编码之夏的学生）一起工作来设 计新的VNC编码器，新的编码器针对浏览器渲染进行了大量的优化，这个新的VNC/RFB编码器会以PNG格式传输图像数据。除了极佳的无损图像压缩外 （相对于紧密编码来说），浏览器几乎不需要什么解码工作就能渲染PNG数据流（这一点与紧密压缩大不相同）。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">WebSockets 到TCP sockets代理的需求对于noVNC的普及是个障碍，我希望VNC服务器能加入WebSockets支持，现在我的主要精力都放在了 libvncserver（用于构建不同的VNC服务器）和QEMU/KVM上，但还是希望能帮助并鼓励其他的VNC服务器开发者增加对 WebSockets的支持。将WebSockets支持加到其他的VNC客户端用处也很大，因为WebSockets协议设计之初就考虑到支持的方便性 并且可由Web服务器代理（因此会有兼容于HTTP的握手）。这将有助于解决VNC的一个老大难问题：与防火墙的交互。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">之所以把这个项目命名为“noVNC”，一个原因是我还希望出现其他的“虚拟网络计算机”协议的实现，比如RDP、NX以及Red Hat的Spice协议。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">如果iPhone能增加本地的WebSockets支持（显然Flash的回退已经超出了问题本身），我就会让noVNC运行在iPhone之上。我想增 加的一个非常有用的特性是视角与缩放支持，这对于智能手机来说也非常关键。对于Google来说，如果能在Android上支持noVNC将是一件多么美 妙的事情啊。</span> <br /><a href="http://guacamole.sourceforge.net/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">Guacamole项目</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">也采取了类似的处理方式，它同样是一个HTML5 VNC查看器，利用了服务器端的代理，它使用Java编写。目前版本的响应速度号称可以达到VNC的水平，只要浏览器支持HTML5 canvas标签就可以使用Guacamole。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">感兴趣的读者可以在InfoQ上找到关于</span><a href="http://www.infoq.com/html-5"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: underline">HTML5</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">和</span><a href="http://www.infoq.com/RIA"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: underline">RIA</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">的更多信息！</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">查看英文原文：</span><a href="http://www.infoq.com/news/2010/07/html5-novnc"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">HTML5 Case Study: Building the noVNC Client with WebSockets, Canvas and JavaScript</span></a> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></p> <p class="read-more">Continue reading <a class="heading" href="/html5/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91novnc-html5.html" data-flip="title">【转】noVNC html5</a></p> </article> <article id="post-%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/2011/06/09/%e6%89%93%e5%8d%b0%e5%b0%8f%e5%86%8c%e5%ad%90%e6%93%8d%e4%bd%9c%e7%a4%ba%e6%84%8f%e5%9b%be" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/2011/06/09/e6-89-93-e5-8d-b0-e5-b0-8f-e5-86-8c-e5-ad-90-e6-93-8d-e4-bd-9c-e7-a4-ba-e6-84-8f-e5-9b-be.html" data-flip="title"> 打印小册子操作示意图 </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T20:35:13+08:00">09 Jun 2011</time> in <span>默认分类</span> on <span>办公</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p><a href="http://kazge.com/archives/294.html/haha" rel="attachment wp-att-296"><img alt="" class="alignnone size-full wp-image-296" height="720" src="/assets/haha.jpg" title="haha" width="960" /></a></p> <p class="read-more">Continue reading <a class="heading" href="/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/2011/06/09/e6-89-93-e5-8d-b0-e5-b0-8f-e5-86-8c-e5-ad-90-e6-93-8d-e4-bd-9c-e7-a4-ba-e6-84-8f-e5-9b-be.html" data-flip="title">打印小册子操作示意图</a></p> </article> <article id="post-%E5%88%86%E5%B8%83%E5%BC%8F/%E6%95%B0%E6%8D%AE%E5%BA%93/2011/06/09/%e3%80%90%e8%bd%ac%e3%80%91%e6%88%91%e5%9b%bd%e9%87%91%e8%9e%8d%e4%b8%9a%e7%9a%84%e7%81%be%e9%9a%be%e5%a4%87%e4%bb%bd%e7%8e%b0%e7%8a%b6" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/%E5%88%86%E5%B8%83%E5%BC%8F/%E6%95%B0%E6%8D%AE%E5%BA%93/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91-e6-88-91-e5-9b-bd-e9-87-91-e8-9e-8d-e4-b8-9a-e7-9a-84-e7-81-be-e9-9a-be-e5-a4-87-e4-bb-bd-e7-8e-b0-e7-8a-b6.html" data-flip="title"> 【转】我国金融业的灾难备份现状 </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T18:52:21+08:00">09 Jun 2011</time> in <span>分布式</span> / <span>数据库</span> on <span>灾难备份</span>, <span>金融</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">一、我国金融业的灾难备份现状</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">人民银行1998年在无锡建立了灾备中心，并于2001年完成全国电子联行系统的灾难备份系统，2005年实现支付系统的无锡灾难备份系统。目前在上海建立了完善的支付系统异地灾难备份中心。四大国有商业银行和银联也已经或正在建灾难备份系统，具体情况见表。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">其他商业银行也都在建设信息系统的灾难备份中心。如招商银行信息系统的主运行中心在深圳，异地灾难备份系统在南京；交通银行主运行中心在上海，且建设了同城灾难备份中心，并正在筹建异地灾难备份中心。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">二、我国金融信息系统运行及故障分析</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">我国金融信息系统所涉及的金融业务种类繁多，如果从信息系统本身的可靠性分析，现有信息系统分为如下几种。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">1.单机系统运行</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">该模式运行风险最大、可靠性最差，没有抵御系统故障和突发灾难的能力。一旦系统因任何原因出现故障，业务就要停止，且系统及业务数据无法恢复。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">2.单机系统运行，每天做业务数据备份</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">当系统出现故障时，首先重建或恢复系统，然后恢复昨天以前备份的业务数据。在这种情况下，系统可以恢复，但时间较长；业务数据可以恢复，但会丢失半天或一天的数据。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">3.冷备份系统</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">冷备份系统包括两种情况。一是除运行系统外还安装一套和运行系统一样的备份系统。一旦运行系统出现故障，启动备份系统，将备份的业务数据在备份系统中恢复，用备份系统的应用系统代替原运行系统，保证业务的连续运行。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">另一种情况是在运行系统运行时，备份系统也处于运行状态。虽然备份系统中的应用系统不运行，但系统软件都在运行，且运行系统每隔一定时间会把业务数据的增量数据备份到备份系统。一旦运行系统出现故障，直接启动备份系统来代运行系统。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">4.双机热备份</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">双机热备份是安装两套信息系统，一般用磁盘阵列或存储区域网络（SAN）来做业务数据的存储系统。有些系统将数据库也安装在磁盘阵列或SAN上， 并且安装热备份软件。系统和业务数据都不需要在热备份系统上恢复，从故障系统将业务切换到热备份系统只需几分钟时间。双机热备份系统当一套系统有故障而切 换到另一套系统后，数据不会丢失。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">尽管双机热备份系统解决了主机系统等出现故障后的业务连续性问题，对于电源、网络故障，特别是自然灾难引起的故障如地震、火灾、水灾、台风飓风等以及战争、恐怖袭击等引起故障都还没有任何解决办法。对于要防止这些故障的信息系统，就要建立灾难备份中心。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">5.灾难备份中心</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">灾难备份中心分为同城灾难备份中心和异地灾难备份中心。如果建立了同城灾难备份中心，当运行信息系统运行时，可以同步将业务数据和相关信息传送到 同城灾难备份中心的备份信息系统中。一旦运行中心因故障不能正常运行时，同城灾难备份中心可以很快接管运行中心的系统继续运行，而且不会丢失业务数据。也 可以用异步备份、每天一次或定期备份的形式，虽然建设成本低，但切换到同城灾难备份中心后，业务数据会有一定丢失。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">同城灾难备份用于城市局部地方发生灾难时的应急备份措施。对于地震、水灾、台风、飓风以及战争等灾难，需要进行异地灾难备份。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">异地灾难备份中心和运行中心不在一个城市，而且距离要远。一旦运行中心的城市发生灾难，业务可以在异地灾难备份中心继续运行，虽然可能丢失数据，但可以保证业务的不间断连续运行。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">三、目前灾难备份的主要技术</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">一个完整的灾难备份系统主要由数据备份系统、备份数据处理系统、备份通信网络系统和完善的灾难恢复计划所组成。在灾难备份系统建设中，数据备份是关键，如何将数据完整地实时复制到灾难备份中心，是金融单位灾难备份建设中需要重点考虑的问题。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">目前，灾难备份技术主要有两种，一是基于磁盘系统的硬件方式灾难备份技术，二是软件方式的灾难备份技术。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">1.基于磁盘系统的灾难备份技术</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">基于磁盘系统的远程数据备份技术是以磁盘系统为基础，利用磁盘控制器提供的功能，采用磁盘镜像技术在物理磁盘卷级上实现两地磁盘机之间数据的复 制。这种方式独立于主机和主机操作系统，不占用主机CPU、主机通道和网络资源，对应用透明，不需要对现有应用系统做任何改动和变化。为保证数据的及时 性、完整性和系统性能之间的平衡，基于磁盘系统的远程数据备份主要有两种工作方式。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">同步数据复制模式：来自处理器的更新数据在被写入本地连接的磁盘系统前，通过磁盘镜像技术，将更新数据转发至异地磁盘系统中。只有更新数据在两个 磁盘系统完成写操作后，本地磁盘系统才会向处理器返回写完成指令，确保两地磁盘系统数据的一致性、完整性，无数据丢失。在同步数据复制模式下，应用系统会 因等待写I/O操作完成而被延迟。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">异步数据复制模式：来自处理器的更新数据首先被写入本地连接的磁盘系统，并立即向处理器返回一个I/O写完成指示，其后磁盘镜像系统在很短的时间内，将更新数据发送至异地磁盘系统。异步数据复制模式对应用程序性能影响最小，但远程磁盘系统的数据和本地磁盘系统相比有延迟。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">磁盘镜像数据复制支持几乎所有的主机平台，能够有效地实现操作系统、程序、数据库和文件系统的复制功能。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">2.基于软件方式的灾难备份技术</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">软件方式的灾难备份技术是操作系统级的灾难备份解决方案，它与操作系统平台相关，但对应用程序透明。它通过通信网络，实现数据在两个不同地点间的实时备份。下面针对不同的系统平台分别介绍软件方式的灾难备份技术。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">S/390 平台的软件方式灾难备份技术:异地并行耦合系统（GDPS）是目前IBM S/390平台较为完善的灾难备份技术。GDPS将S/390的并行Sysplex技术与磁盘系统远程数据复制技术（PPRC或XRC）集成在一起，并通 过多系统耦合技术，组成完整的灾难备份与恢复整体解决方案，使客户的生产系统在灾难发生的情况下快速恢复。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">AS/400平台的软件方式灾难备份技术:一般利用AS400的数据库日志和目标日志，通过一定的数据备份技术，将更新的日志实时传送到远程异地AS400上，不断更新异地AS400上的数据库和目标，使灾难备份中心可实时拥有一套完整的可供灾难恢复的数据库和应用系统。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">目前业界的主要热备份产品不仅具有本地的双机实时热备份和灾难恢复功能，还被广泛用于实现本地或异地一对一、一对多的备份形式，实现多台 AS400的相互数据镜像。其主要技术特点有：备份数据的实时更新,保证数据及时、完整、可用;满足不同距离的灾难备份要求;迅速恢复业务处理系统，保证 业务连续运作;提供灵活快速的备份通信网络系统。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">UNIX 平台的软件方式灾难备份技术: 该技术独立于硬件存储设备，利用软件的复制功能特性，提供逻辑卷级和文件系统级的远程数据复制能力。它可通过IP网络将数据及时复制到异地灾难备份中心， 确保用户备份数据的及时性和完整性。如果同时结合相应的灾难恢复软件功能，一旦电脑中心发生灾难，灾备中心的主机可自动（或手动）接管电脑中心主机的运行 并提供服务，确保业务的连续性，把意外灾难造成的损失降至最低。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">其主要特点：支持数据在两个地点之间实时镜像，两地点之间距离没有限制; 支持所有数据库和文件类型，对应用程序明; 数据复制基于TCP/IP网络; 只复制实际发生变化的数据;有效地利用网络资源，并使数据复制通信量降至最低水平; 无论是同步模式还是异步模式，都能确保备份数据的完整性; 当灾难发生时，在备份地点可自动恢复应用。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">3.其他灾难备份技术解决方案</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">对于数据的远程复制，还有如下数据远程复制技术解决方案：通过磁带库技术实现数据远程备份解决方案；数据库镜像技术解决方案等。灾难备份的另外一 个核心技术是数据的存储备份。存储优化是提高灾难备份系统性能的重要指标之一。目前比较通用的优化技术有直接连接存储（DAS）、网络连接存储 （NAS）、存储区域网络（SAN）。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">四、灾难备份建设的主要流程</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">1.建立专门的灾难备份机构</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">实施灾难备份应由董事会或高级管理层决策，指定高层管理人员组织实施。由科技、业务、财务、后勤等支持并与灾难备份相关的部门组成专门机构。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">2.分析灾难备份需求</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">重要信息系统灾难备份需求分析应包括对数据处理中心的风险分析和对重要信息系统的业务分析，以确定灾难恢复目标。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">数据处理中心风险分析：明确防范风险的技术与管理手段。确定需要采取灾难恢复的类型，如灾备中心距离，数据备份方式和频率等。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">业务分析：分析各项业务停业将造成的损失，须考虑流失客户、损失营业额、企业形象、法律纠纷、社会安定等因素。分析每项业务停顿的最大容忍时间；分析各项业务的恢复优先级；分析各项业务的相关性；分析可接受的交易丢失程度。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">确定灾难恢复目标：确定恢复业务品种范围及优先级。确定灾难备份中心及服务界面的恢复时限。确定需要恢复的服务网点和服务渠道。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">3.制订灾难备份方案</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">一个完整的灾难备份方案的设计基于灾难备份需求分析所得出的各业务系统灾难恢复目标，可能涉及多个级别的应用，并且需要考虑技术手段、投资成本、管理方式等多方面的因素。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">数据备份方案:根据灾难备份需求分析所确定的业务恢复时间和交易丢失程度确定对数据备份的要求。根据应用的重要级别、最大停顿时间、数据传输量、最大数据丢失度、数据相关性、应用相关性确定数据备份方案。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">备份处理系统:灾难备份应根据重要信息系统灾难备份需求配置相应的备份处理系统。根据数据备份方案确定相应的数据备份所需的主机、存储、网络、系 统、软件等。根据灾难恢复应用对主机系统、磁盘系统、磁带备份、打印及外围设备的需求确定硬件配置。根据服务界面的范围、备份网络拓扑结构、网络传输速率 需求、网络切换方式、网络恢复时间要求以及本地的网络通信状况确定网络配置。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">灾难备份中心建设：配备了各种资源在灾难发生时接替数据处理中心运行的计算机处理中心。重要信息系统可采用自行建设、联合建设和租用商业化灾难备份中心的模式。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">规程与管理制度：包括数据备份日常管理制度、备份数据保存制度、灾难备份切换流程、灾难备份系统变更管理规程以及人力资源规程等。重要信息系统需要制订有关灾难备份与灾难恢复的各项规程和管理制度，同时修改数据处理中心原有规程和管理制度以确保灾难恢复的成功。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">4.实施灾难备份方案</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">其主要目标是按照所制订的灾难备份方案，完成灾难备份工作。在实施过程中，要严格按照灾难备份方案的要求和内容进行，落实相应的规章制度，应用灾难备份方案，建设并运行灾难备份中心。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">5.制订灾难恢复计划</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">其主要目的是规范灾难恢复流程，使重要信息系统在灾难发生后能够快速恢复数据处理系统的运行和业务运作。同时，重要的信息系统可以根据灾难恢复计划对其数据处理中心的灾难恢复能力进行测试，并将灾难恢复计划作为相关人员的培训资料之一。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">6.保持灾难恢复计划持续可用</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">灾难恢复计划制订后，为保证计划的可用性和完整性，需要形成工作底稿，制订变更管理流程、定期审核制度和定期演练制度。</span></p> <p class="read-more">Continue reading <a class="heading" href="/%E5%88%86%E5%B8%83%E5%BC%8F/%E6%95%B0%E6%8D%AE%E5%BA%93/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91-e6-88-91-e5-9b-bd-e9-87-91-e8-9e-8d-e4-b8-9a-e7-9a-84-e7-81-be-e9-9a-be-e5-a4-87-e4-bb-bd-e7-8e-b0-e7-8a-b6.html" data-flip="title">【转】我国金融业的灾难备份现状</a></p> </article> <article id="post-web%E5%89%8D%E7%AB%AF/2011/06/09/%e3%80%90%e8%bd%ac%e3%80%91%e8%b7%a8%e5%9f%9f%e9%97%ae%e9%a2%98-%e4%b9%8b-window-name" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/web%E5%89%8D%E7%AB%AF/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91-e8-b7-a8-e5-9f-9f-e9-97-ae-e9-a2-98-e4-b9-8b-window-name.html" data-flip="title"> 【转】跨域问题 之 window.name </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T18:48:54+08:00">09 Jun 2011</time> in <span>Web前端</span> on <span>Javascript web 前端</span>, <span>跨域</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <h3 id="internal-source-marker_0.10942681373307284">&#160;</h3> <h3><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">很早以前&#160; 写了个 </span><a href="http://yiminghe.javaeye.com/admin/blog/263429"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: underline">Ext XMLHttpRequest 之外的 刷新</span></a></h3> <p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">其中&#160; </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000080;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(1) iframe&#160; 动态创建&#160; onload 读取 iframe.innerHTML</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">只适合 同域下 主页面 无刷新 上传文件的情况&#160; ,&#160; 当跨域访问 时 就不行了 。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000080;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(2) script 动态创建（每次创建设置定时器）</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; server 调用 回调函数，摧毁定时器&#160; 则是可以跨域取得数据的，当然这是Ext</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">跨域的标准做法。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000080;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">iframe 下 跨域</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> 暂时 知道 有两种方法 ：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000080;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">1. window.name 方法</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> ，见 转载 ,&#160;&#160;&#160; </span><a href="http://yiminghe.javaeye.com/topics/download/1ee1d3b7-6b22-306e-8ec4-2a32526b8e0e"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">附件zip代码可直接本地运行</span></a> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000080;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">2.window.location.hash 方法</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> ，parent，children 设置定时器 监控 url 的 #部分 ，具体待述</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 18pt;vertical-align: baseline;font-weight: normal;text-decoration: none">ps : </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #ff0000;font-size: 18pt;vertical-align: baseline;font-weight: bold;text-decoration: none">转载</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">d</span> <br /> <br /> <h1><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 24pt;vertical-align: baseline;font-weight: bold;text-decoration: none">使用 window.name 解决跨域问题&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></h1> <p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">window.name 传输技术，原本是</span><a href="http://www.thomasfrank.se/about.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">Thomas Frank</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> 用于解决 cookie 的一些劣势（每个域名 4 x 20 Kb 的限制、数据只能是字符串、设置和获取 cookie 语法的复杂等等）而发明的（详细见原文：</span><a href="http://www.thomasfrank.se/sessionvars.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">《Session variables without cookies》</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> ），后来</span><a href="http://www.sitepen.com/blog/2008/07/22/windowname-transport/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">Kris Zyp</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> 在此方法的基础上强化了 window.name 传输 ，并引入到了</span><a href="http://dojotoolkit.org/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">Dojo</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">（</span><a href="http://bugs.dojotoolkit.org/ticket/6893"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">dojox.io.windowName</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> ），用来解决跨域数据传输问题。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">window.name 的美妙之处：</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">name 值在不同的页面（甚至不同域名）加载后依旧存在，并且可以支持非常长的 name 值（2MB）。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">window.name 传输技术的基本原理和步骤为：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">name 在浏览器环境中是一个全局/window对象的属性，且当在 frame 中加载新页面时，name 的属性值依旧保持不变。通过在 iframe 中加载一个资源，该目标页面将设置 frame 的 name 属性。此 name 属性值可被获取到，以访问 Web 服务发送的信息。但 name 属性仅对相同域名的 frame 可访问。这意味着为了访问 name 属性，当远程 Web 服务页面被加载后，必须导航 frame 回到原始域。同源策略依旧防止其他 frame 访问 name 属性。一旦 name 属性获得，销毁 frame 。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">在最顶层，name 属性是不安全的，对于所有后续页面，设置在 name 属性中的任何信息都是可获得的。然而 windowName 模块总是在一个 iframe 中加载资源，并且一旦获取到数据，或者当你在最顶层浏览了一个新页面，这个 iframe 将被销毁，所以其他页面永远访问不到 window.name 属性。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">基本实现代码，基于</span><a href="http://developer.yahoo.com/yui/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">YUI</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> ，源自</span><a href="http://hikejun.com/demo/windowname/demo_windowname.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">克军写的样例</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> ：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Js代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(function(){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; var YUD = YAHOO.util.Dom, YUE = YAHOO.util.Event;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; dataRequest = {&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; _doc: document,&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; cfg: {&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; proxyUrl: 'proxy.html'&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; };&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; dataRequest.send = function(sUrl, fnCallBack){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; if(!sUrl || typeof sUrl !== 'string'){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; sUrl += (sUrl.indexOf('?') &gt; 0 ? '&amp;' : '?') + 'windowname=true';&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; var frame = this._doc.createElement('iframe'), state = 0, self = this;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; this._doc.body.appendChild(frame);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; frame.style.display = 'none';&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; var clear = function(){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; try{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; frame.contentWindow.document.write('');&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; frame.contentWindow.close();&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; self._doc.body.removeChild(frame);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }catch(e){}&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; };&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; var getData = function(){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; try{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; var da = frame.contentWindow.name;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }catch(e){}&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clear();&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if(fnCallBack &amp;&amp; typeof fnCallBack === 'function'){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fnCallBack(da);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; };&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; YUE.on(frame, 'load', function(){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if(state === 1){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; getData();&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } else if(state === 0){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; state = 1;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; frame.contentWindow.location = self.cfg.proxyUrl;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; });&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; frame.src = sUrl;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; };&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">})();&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(function(){ <br class="kix-line-break" />&#160;&#160; var YUD = YAHOO.util.Dom, YUE = YAHOO.util.Event; <br class="kix-line-break" /> <br class="kix-line-break" />&#160;&#160; dataRequest = { <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; _doc: document, <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; cfg: { <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; proxyUrl: 'proxy.html' <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" />&#160;&#160; }; <br class="kix-line-break" /> <br class="kix-line-break" />&#160;&#160; dataRequest.send = function(sUrl, fnCallBack){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; if(!sUrl || typeof sUrl !== 'string'){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" /> <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; sUrl += (sUrl.indexOf('?') &gt; 0 ? '&amp;' : '?') + 'windowname=true'; <br class="kix-line-break" /> <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; var frame = this._doc.createElement('iframe'), state = 0, self = this; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; this._doc.body.appendChild(frame); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; frame.style.display = 'none'; <br class="kix-line-break" /> <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; var clear = function(){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; try{ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; frame.contentWindow.document.write(''); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; frame.contentWindow.close(); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; self._doc.body.removeChild(frame); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }catch(e){} <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; }; <br class="kix-line-break" /> <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; var getData = function(){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; try{ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; var da = frame.contentWindow.name; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }catch(e){} <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; clear(); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if(fnCallBack &amp;&amp; typeof fnCallBack === 'function'){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; fnCallBack(da); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; }; <br class="kix-line-break" /> <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; YUE.on(frame, 'load', function(){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if(state === 1){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; getData(); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } else if(state === 0){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; state = 1; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; frame.contentWindow.location = self.cfg.proxyUrl; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; }); <br class="kix-line-break" /> <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; frame.src = sUrl; <br class="kix-line-break" />&#160;&#160; }; <br class="kix-line-break" />})();</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">Web 服务器如何提供 window.name 数据</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">为了让 Web 服务器实现 window.name，服务器应该只寻找请求中是否包含 windowname 参数。如果包含了 windowname 参数，服务器应该返回一个设置了 window.name 字符串值的 HTML 文档，回应此请求并传送到客户端。例如：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">http://www.planabc.net/getdata.html?windowname=true</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">如果服务器想用 Hello 响应客服端，它应该返回一个 HTML 页面：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; window.name=&quot;Hello&quot;;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/script&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/html&gt;&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt; <br class="kix-line-break" />&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; window.name=&quot;Hello&quot;; <br class="kix-line-break" />&#160;&#160; &lt;/script&gt; <br class="kix-line-break" />&lt;/html&gt;</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">同样也可以转换为 JSON 数据：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; window.name='{&quot;foo&quot;:&quot;bar&quot;}';&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/script&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/html&gt;&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt; <br class="kix-line-break" />&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; window.name='{&quot;foo&quot;:&quot;bar&quot;}'; <br class="kix-line-break" />&#160;&#160; &lt;/script&gt; <br class="kix-line-break" />&lt;/html&gt;</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">如果你手动创建资源，书写大量的多行的 JSON 对象为一个引用的字符串应该是比较困难的并且易于出错的。可以使用这样的 HTML 样例简单的创建 JSON 数据，将会转换为一个 JSON 字符串而无需手动转义 JSON 为字符串：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;script type=&quot;\'text/javascript\'&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; window.name = document.getElementsByTagName(&quot;script&quot;)[0].innerHTML.match(/temp\s*=([\w\W]*)/)[1];&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; temp= {&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; foo:&quot;bar&quot;, // put json data here&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; baz:&quot;foo&quot;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/script&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/html&gt;&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt; <br class="kix-line-break" />&#160;&#160; &lt;script type=&quot;\'text/javascript\'&quot;&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; window.name = document.getElementsByTagName(&quot;script&quot;)[0].innerHTML.match(/temp\s*=([\w\W]*)/)[1]; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; temp= { <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; foo:&quot;bar&quot;, // put json data here <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; baz:&quot;foo&quot; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" />&#160;&#160; &lt;/script&gt; <br class="kix-line-break" />&lt;/html&gt;</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">同样的，如果你想传递 HTML/XML 数据，这里有一个样例实现，而无需手动将这些数据转换成字符串：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;body&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;p id=&quot;content&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; some &lt;strong&gt;html/xml-style&lt;/strong&gt;data&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;/p&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/body&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; window.name = document.getElementById(&quot;content&quot;).innerHTML;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/script&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/html&gt;&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt; <br class="kix-line-break" />&#160;&#160; &lt;body&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; &lt;p id=&quot;content&quot;&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; some &lt;strong&gt;html/xml-style&lt;/strong&gt;data <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; &lt;/p&gt; <br class="kix-line-break" />&#160;&#160; &lt;/body&gt; <br class="kix-line-break" />&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; window.name = document.getElementById(&quot;content&quot;).innerHTML; <br class="kix-line-break" />&#160;&#160; &lt;/script&gt; <br class="kix-line-break" />&lt;/html&gt;</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">window.name 传输技术相比其他的跨域传输的一些优势：</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">它是安全的。也就是说，它和其他的基于安全传输的 frame 一样安全，例如 Fragment Identifier messaging （FIM）和</span><a href="http://research.microsoft.com/%7Ehelenw/papers/subspace.pdf"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">Subspace</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> 。(I)Frames 也有他们自己的安全问题，由于 frame 可以改变其他 frame 的 location，但是这个是非常不同的安全溢出，通常不太严重。</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">它比 FIM 更快，因为它不用处理小数据包大小的 Fragment Identifier ，并且它不会有更多的 IE 上的“机关枪”声音效果。它也比 Subspace 快，Subspace 需要加载两个 Iframe 和两个本地的 HTML 文件来处理一个请求。window.name 仅需要一个 Iframe 和一个本地文件。</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">它比 FIM 和 Subspace 更简单和安全。FIM 稍微复杂，而 Subspace 非常复杂。Subspace 也有一些额外的限制和安装要求，如预先声明所有的目标主机和拥有针对若干不同特殊主机的 DNS 入口。window.name 非常简单和容易使用。</span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">它不需要任何插件（比如 Flash）或者替代技术（例如 Java）。</span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></p> <p class="read-more">Continue reading <a class="heading" href="/web%E5%89%8D%E7%AB%AF/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91-e8-b7-a8-e5-9f-9f-e9-97-ae-e9-a2-98-e4-b9-8b-window-name.html" data-flip="title">【转】跨域问题 之 window.name</a></p> </article> <article id="post-java/2011/06/09/itsnat-%e8%87%aa%e5%ae%9a%e4%b9%89%e6%8e%a7%e4%bb%b6%e5%85%a5%e9%97%a8%e5%92%8c%e5%8f%8b%e5%a5%bd%e7%9a%84url" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/java/2011/06/09/itsnat-e8-87-aa-e5-ae-9a-e4-b9-89-e6-8e-a7-e4-bb-b6-e5-85-a5-e9-97-a8-e5-92-8c-e5-8f-8b-e5-a5-bd-e7-9a-84url.html" data-flip="title"> itsnat--自定义控件入门和友好的url </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T18:43:40+08:00">09 Jun 2011</time> in <span>Java</span> on <span>Javascript web 前端</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>As I see that itsnat referred this post as their tutorial, so I post a copy that in english, you can view it at&#160; <a href="http://kazge.com/archives/501.html" target="_blank">itsnat -- Custom components and friendly URLs</a> .</p> <p>&#160;</p> <p><a id="internal-source-marker_0.5152134992879932" href="http://www.innowhere.com:8080/itsnat/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">itsnat</span></a> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">是个很有意思的java web框架,实现了“浏览器就是服务器”(The Browser Is The Server TBITS),在服务器端模仿了一个一般概念的W3C Java 浏览器，客户端动作通过AJAX发送到服务器端，并且转换为W3C Java DOM动作，在DOM服务器端改变结果自动发送到客户端，用JavaScript 更新客户端DOM。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">要自定义一个组件，需要如下步骤：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></span><br /> <h5>1:监听模板 </h5> <h5></h5></p> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Java代码</span></p> <div>>String html = &quot;<span style="color: #8b0000">E:/projects/ItsNat/wb/test/WebRoot/apps/pto/frontpage.html</span>&quot;; ItsNatDocumentTemplate docTemplate = getItsNatHttpServlet().registerItsNatDocumentTemplate(&quot;<span style="color: #8b0000">pto</span>&quot;,&quot;<span style="color: #8b0000">text/html</span>&quot;, html); docTemplate.addItsNatServletRequestListener(<span style="color: #0000ff">new</span> ItsNatServletRequestListener(){ <p class="read-more">Continue reading <a class="heading" href="/java/2011/06/09/itsnat-e8-87-aa-e5-ae-9a-e4-b9-89-e6-8e-a7-e4-bb-b6-e5-85-a5-e9-97-a8-e5-92-8c-e5-8f-8b-e5-a5-bd-e7-9a-84url.html" data-flip="title">itsnat--自定义控件入门和友好的url</a></p> </article> <article id="post-java/web%E5%89%8D%E7%AB%AF/2011/06/09/wicket-tapestry5-sopo-%e6%a8%a1%e6%9d%bf%e5%ae%9e%e7%8e%b0%e6%b5%85%e6%9e%90" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/java/web%E5%89%8D%E7%AB%AF/2011/06/09/wicket-tapestry5-sopo-e6-a8-a1-e6-9d-bf-e5-ae-9e-e7-8e-b0-e6-b5-85-e6-9e-90.html" data-flip="title"> wicket tapestry5 sopo 模板实现浅析 </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T18:42:35+08:00">09 Jun 2011</time> in <span>Java</span> / <span>Web前端</span> on <span>Javascript web 前端</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <h3 id="internal-source-marker_0.8637201135828881"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">1 Wicket实现</span></h3> <p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; Wicket模板是html格式,示例:index.html</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;head&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;title&gt;Index.html&lt;/title&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;!--&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;--&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;/head&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;body&gt;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;a wicket:id=&quot;edit&quot; href=&quot;UserEdit.html?uid=1&quot; target=&quot;_blank&quot; &gt;edit form&lt;/a&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;/body&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/html&gt;&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt; <br class="kix-line-break" />&lt;html&gt; <br class="kix-line-break" /> &lt;head&gt; <br class="kix-line-break" />&#160;&#160; &lt;title&gt;Index.html&lt;/title&gt; <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt; <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt; <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt; <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;!--&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;--&gt; <br class="kix-line-break" /> <br class="kix-line-break" /> &lt;/head&gt; <br class="kix-line-break" /> <br class="kix-line-break" /> &lt;body&gt; <br class="kix-line-break" />&#160;&#160; &lt;a wicket:id=&quot;edit&quot; href=&quot;UserEdit.html?uid=1&quot; target=&quot;_blank&quot; &gt;edit form&lt;/a&gt; <br class="kix-line-break" /> &lt;/body&gt; <br class="kix-line-break" />&lt;/html&gt;</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">还要在后台page类Index 中手动添加进组件列表中。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Java代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public class Index extends WebPage&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">/** </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">* Constructor </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">*/&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public Index()&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; PageLink link = new PageLink(&quot;edit&quot;,new IPageLink());&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; add(link);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public class Index extends WebPage <br class="kix-line-break" />{ <br class="kix-line-break" />/** <br class="kix-line-break" />* Constructor <br class="kix-line-break" />*/ <br class="kix-line-break" />public Index() <br class="kix-line-break" />{ <br class="kix-line-break" />&#160;&#160; PageLink link = new PageLink(&quot;edit&quot;,new IPageLink()); <br class="kix-line-break" />&#160;&#160; add(link); <br class="kix-line-break" />} <br class="kix-line-break" />}</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">add方法是继承自父类</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.MarkupContainer</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">的方法</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">，</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">会将组件添加到其字段children中去.</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">模板由</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.MarkupParser</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">解析，遇到</span><span style="background-color: transparent;font-style: normal;font-family: courier new;color: #ff0000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">wicket:id</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">属性的会转换为</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.MarkupElement,</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">最终将html模板解析成</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">MarkupElement</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">列表,添加到</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.Markup</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">的</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">List&lt;MarkupElement&gt; markupElements</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">集合中,在组件绘制的时候,将其</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">包装成</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.MarkupStream</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">，会遍历</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">MarkupElement</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">列表,依据组件id获得组件,让每个组件进行绘制--调用方法</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">void org.apache.wicket.Component.render(MarkupStream markupStream).</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">具体的主要的解析实现是由</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.parser.XmlPullParser</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">完成的,通过过字符串操作来解析,</span><span style="background-color: #ffff00;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">详见其next方法</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">,并没有使用第三方类库.</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: bold;text-decoration: none">2 tapestry实现</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">tapestry5模板时xml格式,示例Index.tml</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html xmlns:t=&quot;http://tapestry.apache.org/schema/tapestry_5_0_0.xsd&quot;&gt; &lt;head&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;title&gt;Test&lt;/title&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/head&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;body&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;h1&gt;Test&lt;/h1&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;h1&gt;Address Book&lt;/h1&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;t:span c=&quot;d&quot; &gt;${fi}&lt;/t:span&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;ul&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;li&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;a t:type=&quot;pagelink&quot; t:page=&quot;index&quot; &gt;Create new address&lt;/a&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/li&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/ul&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/body&gt; &lt;/html&gt;&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html xmlns:t=&quot;http://tapestry.apache.org/schema/tapestry_5_0_0.xsd&quot;&gt; &lt;head&gt; <br class="kix-line-break" />&lt;title&gt;Test&lt;/title&gt; <br class="kix-line-break" />&lt;/head&gt; <br class="kix-line-break" />&lt;body&gt; <br class="kix-line-break" />&lt;h1&gt;Test&lt;/h1&gt; <br class="kix-line-break" />&lt;h1&gt;Address Book&lt;/h1&gt; <br class="kix-line-break" />&lt;t:span c=&quot;d&quot; &gt;${fi}&lt;/t:span&gt; <br class="kix-line-break" />&lt;ul&gt; <br class="kix-line-break" />&lt;li&gt; <br class="kix-line-break" />&lt;a t:type=&quot;pagelink&quot; t:page=&quot;index&quot; &gt;Create new address&lt;/a&gt; <br class="kix-line-break" />&lt;/li&gt; <br class="kix-line-break" />&lt;/ul&gt; <br class="kix-line-break" />&lt;/body&gt; &lt;/html&gt;</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">因为已经在模板中指明了这个节点是什么类型的组件，所以，tapestry5就不需要再add组件了，它本身也不提供add方法。&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public class Index</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Java代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">@Inject&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">private Logger logger;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">private GridDataSource dss;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">private int fi;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public Index()&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">super();&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">System.out.println(&quot;call ctor.&quot;);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public int getFi()&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">return fi;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public void setFi(int fi)&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">this.fi = fi;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{ <br class="kix-line-break" />@Inject <br class="kix-line-break" />private Logger logger; <br class="kix-line-break" />private GridDataSource dss; <br class="kix-line-break" />private int fi; <br class="kix-line-break" />public Index() <br class="kix-line-break" />{ <br class="kix-line-break" />super(); <br class="kix-line-break" />System.out.println(&quot;call ctor.&quot;); <br class="kix-line-break" />} <br class="kix-line-break" />public int getFi() <br class="kix-line-break" />{ <br class="kix-line-break" />return fi; <br class="kix-line-break" />} <br class="kix-line-break" />public void setFi(int fi) <br class="kix-line-break" />{ <br class="kix-line-break" />this.fi = fi; <br class="kix-line-break" />} <br class="kix-line-break" />}</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tapastry5使用</span><a href="http://stax.codehaus.org/Home"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">stAx</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">实现的,</span></a><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">这篇文章</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">介绍了stax的用法,tapestry5通过注入的方式将</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.tapestry5.internal.services.TemplateParserImpl</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">注入到</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.ComponentTemplateSourceImpl</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">中的</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">private final TemplateParser parser;</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">字段中，</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">TemplateParserImpl</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 实际使用的是</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.tapestry5.internal.services.StaxTemplateParser,</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">在这里面会使用stax对模板进行解析。它通过节点是否有t:id,t:type属性来判断</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 是否是一个服务端组件。解析完模板会组建成一个节点列表，再在绘制页面的时候依据这个列表的顺序来调用相应的组件绘制。</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 逻辑主要在以下的类中</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.tapestry5.internal.parser.ComponentTemplateImpl</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.structure.PageImpl</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.PageRenderRequestHandlerImpl</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.PageResponseRendererImpl</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.PageMarkupRendererImpl</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.PageRenderQueueImpl</span></a> <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Page org.apache.tapestry5.internal.pageload.PageLoaderImpl.loadPage(String logicalPageName, Locale locale)</span></a> <br /> <br /> <h3><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">3</span></a><a href="http://sourceforge.net/projects/sopo/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: underline">sopo</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">的实现方法</span></h3> <p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; Sopo是可由每个page类来指明模板内容，只要是html格式就可以，示例:</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;head&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;title&gt;test.html&lt;/title&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;script type=&quot;text/javascript&quot; src=&quot;js/hello.js&quot; &gt;&lt;/script&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; function $(id){&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return document.getElementById(id);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; function test()&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; {&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; $('rst').innerHTML=reg.test($('d').value);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; var reg = new RegExp(&quot;^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$&quot;);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; //var reg = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/i;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/script&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;/head&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;body&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> h--------&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;!-- hahah&#160; --&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;![CDATA[jkjkjk]]&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;form action=&quot;&quot;&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;label stype=&quot;s:Label&quot; id=&quot;lab1&quot; &gt;Hello World1&lt;label stype=&quot;s:Label&quot; id=&quot;lab2&quot; &gt;Hello World3&lt;/label&gt;&lt;/label&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input type=&quot;password&quot; /&gt;&#160;&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;label stype=&quot;s:Label&quot; id=&quot;lab3&quot; &gt;Hello World2&lt;/label&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input stype=&quot;s:Checkbox&quot; id=&quot;chk&quot; name=&quot;chk&quot; &gt;sss&lt;/input&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;select stype=&quot;s:Select&quot; id=&quot;sel&quot; name=&quot;sel&quot; width=&quot;20px&quot; &gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;1&quot; &gt;&lt;/option&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;2&quot; selected=&quot;selected&quot; &gt;&lt;/option&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;3&quot; &gt;&lt;/option&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/select&gt;&#160;&#160;&#160;&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input id=&quot;d&quot; type=&quot;text&quot; /&gt;&lt;button onclick=&quot;test();&quot;&gt;Test&lt;/button&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;span id=&quot;rst&quot;&gt;true&lt;/span&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; &gt;1&lt;/input&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; &gt;2&lt;/input&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; onclick=&quot;alert(this.value);&quot; &gt;3&lt;/input&gt;3&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/form&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;/body&gt;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/html&gt;&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt; <br class="kix-line-break" />&lt;html&gt; <br class="kix-line-break" /> &lt;head&gt; <br class="kix-line-break" />&#160;&#160; &lt;title&gt;test.html&lt;/title&gt; <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt; <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt; <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt; <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt; <br class="kix-line-break" />&#160;&#160; &lt;script type=&quot;text/javascript&quot; src=&quot;js/hello.js&quot; &gt;&lt;/script&gt; <br class="kix-line-break" />&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; function $(id){ <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return document.getElementById(id); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; function test() <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; { <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; $('rst').innerHTML=reg.test($('d').value); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; var reg = new RegExp(&quot;^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$&quot;); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; //var reg = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/i; <br class="kix-line-break" />&#160;&#160; &lt;/script&gt; <br class="kix-line-break" /> &lt;/head&gt; <br class="kix-line-break" /> <br class="kix-line-break" /> &lt;body&gt; <br class="kix-line-break" /> h-------- <br class="kix-line-break" /> &lt;!-- hahah&#160; --&gt; <br class="kix-line-break" />&#160;&#160; &lt;![CDATA[jkjkjk]]&gt; <br class="kix-line-break" />&#160;&#160; &lt;form action=&quot;&quot;&gt; <br class="kix-line-break" />&#160;&#160; &lt;label stype=&quot;s:Label&quot; id=&quot;lab1&quot; &gt;Hello World1&lt;label stype=&quot;s:Label&quot; id=&quot;lab2&quot; &gt;Hello World3&lt;/label&gt;&lt;/label&gt; <br class="kix-line-break" />&#160;&#160; &lt;input type=&quot;password&quot; /&gt;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;label stype=&quot;s:Label&quot; id=&quot;lab3&quot; &gt;Hello World2&lt;/label&gt; <br class="kix-line-break" />&#160;&#160; &lt;input stype=&quot;s:Checkbox&quot; id=&quot;chk&quot; name=&quot;chk&quot; &gt;sss&lt;/input&gt; <br class="kix-line-break" />&#160;&#160; &lt;select stype=&quot;s:Select&quot; id=&quot;sel&quot; name=&quot;sel&quot; width=&quot;20px&quot; &gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;1&quot; &gt;&lt;/option&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;2&quot; selected=&quot;selected&quot; &gt;&lt;/option&gt; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;3&quot; &gt;&lt;/option&gt; <br class="kix-line-break" />&#160;&#160; &lt;/select&gt;&#160;&#160;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;input id=&quot;d&quot; type=&quot;text&quot; /&gt;&lt;button onclick=&quot;test();&quot;&gt;Test&lt;/button&gt; <br class="kix-line-break" />&#160;&#160; &lt;span id=&quot;rst&quot;&gt;true&lt;/span&gt; <br class="kix-line-break" />&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; &gt;1&lt;/input&gt; <br class="kix-line-break" />&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; &gt;2&lt;/input&gt; <br class="kix-line-break" />&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; onclick=&quot;alert(this.value);&quot; &gt;3&lt;/input&gt;3 <br class="kix-line-break" />&#160;&#160; &lt;/form&gt; <br class="kix-line-break" /> &lt;/body&gt; <br class="kix-line-break" />&lt;/html&gt;</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">它和tapestry有些像，因为模板里面指明了组件类型，所以就不需要再添加了.</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">Java代码</span> <ol> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">public class Index extends Page&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">{&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; @Override&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; public String getTemplate()&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; {&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; try&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; {&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return FileUtils.readFileToString(new File(getSession().getServletContext().getRealPath(&quot;Index.html&quot;)));&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; catch (IOException e)&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; {&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw new RuntimeException(e);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160;&#160;&#160;&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; @Override&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; public void onLoad()&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; {&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; Label lab = (Label)getRoot().findComponent(&quot;lab3&quot;);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; lab.addComponent(new Literal(&quot;&lt;a href=\&quot;#\&quot;&gt;hi i am dynamic!!&lt;/a&gt;&quot;));&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; Integer count = (Integer)getViewSate().get(&quot;count&quot;);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; if (null == count)&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; {&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; count = 0;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; count ++;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; getViewSate().put(&quot;count&quot;, count);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; Button btn = new Button(&quot;Ok&quot; + count);&#160;&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; lab.addComponent(btn);&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; }&#160;&#160;&#160; </span></li> <li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">}&#160; </span></li> </ol> <p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">public class Index extends Page <br class="kix-line-break" />{ <br class="kix-line-break" />&#160;&#160; @Override <br class="kix-line-break" />&#160;&#160; public String getTemplate() <br class="kix-line-break" />&#160;&#160; { <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; try <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; { <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return FileUtils.readFileToString(new File(getSession().getServletContext().getRealPath(&quot;Index.html&quot;))); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; catch (IOException e) <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; {&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw new RuntimeException(e);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; }&#160;&#160;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160; } <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; @Override <br class="kix-line-break" />&#160;&#160; public void onLoad() <br class="kix-line-break" />&#160;&#160; { <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; Label lab = (Label)getRoot().findComponent(&quot;lab3&quot;); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; lab.addComponent(new Literal(&quot;&lt;a href=\&quot;#\&quot;&gt;hi i am dynamic!!&lt;/a&gt;&quot;)); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; Integer count = (Integer)getViewSate().get(&quot;count&quot;); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; if (null == count) <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; { <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; count = 0; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; } <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; count ++; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; getViewSate().put(&quot;count&quot;, count); <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; Button btn = new Button(&quot;Ok&quot; + count);&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; lab.addComponent(btn); <br class="kix-line-break" />&#160;&#160; }&#160;&#160; <br class="kix-line-break" />}</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; Sopo则是由</span><a href="http://sourceforge.net/projects/nekohtml/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">neko</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">解析模板,生成页面的组件树，web.sopo.template这个包下面包含了所有的模板解析类。每个page都有一个根组件</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">ComponentRoot web.sopo.page.Page.getRoot(),当开始绘制的时候则会从跟组件开始绘制。它的特点是可以在程序逻辑阶段动态的改变组件树的构造，上面的例子可以看到动态的加了个链接和按钮。使用了它的viewstate特性—存贮页面级变量，这和asp.net很像。</span> <br /> <br /> <h3><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">比较</span></h3> <p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; 这三种都支持模板(包括页面模板和组件模板)，共同特点是模板是html格式，美工可以直接编辑模板，没有讨厌的jsp标签.wicket取经于 tapestry,tapestry取经于asp.net,而sopo也是学asp.net并且和它最像。Wicket需要后台add对应模板的组件,通过匹配,这样做虽然可以动态的决定绘制组件的类型但是也比较繁琐,它类似于swing的方式，但是Mode这个概念入侵很大，通过session来保持状态。tapestry通过模板和组件的绘制来展示页面，不允许你new 一个组件，并且和prototype, scriptaculous集成了，它的performance是这三个中最快的，虽然page和组件都是pojo,但是有注入依赖，到底这个特性有没有用那是见仁见智了。Sopo则是比较灵活，可以动态的修改组件树，和asp.net非常接近，写组件和tapestry一样非常清晰，概念和实现都很单，缺点是它的性能只适用于中小型应用。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></p> <p class="read-more">Continue reading <a class="heading" href="/java/web%E5%89%8D%E7%AB%AF/2011/06/09/wicket-tapestry5-sopo-e6-a8-a1-e6-9d-bf-e5-ae-9e-e7-8e-b0-e6-b5-85-e6-9e-90.html" data-flip="title">wicket tapestry5 sopo 模板实现浅析</a></p> </article> <article id="post-java/2011/06/09/struts2-%e8%87%aa%e5%ae%9a%e4%b9%89tiles-xml%e6%96%87%e4%bb%b6%e8%b7%af%e5%be%84" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/java/2011/06/09/struts2-e8-87-aa-e5-ae-9a-e4-b9-89tiles-xml-e6-96-87-e4-bb-b6-e8-b7-af-e5-be-84.html" data-flip="title"> struts2 自定义tiles.xml文件路径 </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T18:41:25+08:00">09 Jun 2011</time> in <span>Java</span> on <span>Javascript web 前端</span>, <span>Web</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none" id="internal-source-marker_0.6469215794347075">struts2+tiles时，tiles.xml默认是放在文件夹/web-inf/下面，使用ServletContext的方法查找,一般不需要改动，但是遇到BT的要求需要自定义这个titles的路径查找方式时，可以使用如下方法：</span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">1:在web.xml里面配置自定义监听器:</span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"></span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"></span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">Xml代码</span> <ol> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&lt;listener&gt;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;listener-class&gt;demo.MyStrutsTilesListener&lt;/listener-class&gt;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; &lt;/listener&gt;&#160; </span></li> </ol> <p><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">2:实现demo.MyStrutsTilesListener这个类,它继承自org.apache.struts2.tiles.StrutsTilesListener,重载方法</span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"></span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"></span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">Java代码</span> <ol> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">protected ServletContext decorate(ServletContext context)&#160;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">{&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; Map&lt;String, String&gt; INIT = new HashMap&lt;String, String&gt;();&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; INIT.put(TilesContainerFactory.CONTAINER_FACTORY_INIT_PARAM,&#160; StrutsTilesContainerFactory.class.getName());&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; ServletContext servletContext = new MyTilesContext(context,INIT);&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; return servletContext;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">}&#160; </span></li> </ol> <p><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">3:实现MyTilesContext:</span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"></span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">Java代码</span> <ol> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">public class CyberTilesContext extends ConfiguredServletContext&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">{&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; public static final String PREFIX = &quot;file:///&quot;;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; public CyberTilesContext(ServletContext context, Map&lt;String, String&gt; initParameters)&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; {&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; super(context, initParameters);&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; }&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;</span> </li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; @Override&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; public URL getResource(String string) throws MalformedURLException&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; {&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; if (!string.startsWith(PREFIX))&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; {&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return super.getResource(string);&#160;&#160;&#160;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; String path = string.substring(PREFIX.length());&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; File file = new File(path);&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; if (!file.exists())&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; {&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw new RuntimeException(&quot;file &quot; + path + &quot; not founded.&quot;);&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; }&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; return file.toURI().toURL();&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">&#160;&#160; }&#160; </span></li> <li style="background-color: transparent; list-style-type: decimal; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">}&#160; </span></li> </ol> <p><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none">通过重载getResource方法可以定制自己所需要的查找tiles.xml的方法，上面的例子就是实现以file:///开头查找绝对路径下的tiles.xml。</span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"></span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"><font color="#0000ff">PS:很不喜欢struts2,对于我来讲，它不适合快速开发，它也不适合大型网站。</font></span> <br /><span style="background-color: transparent; font-style: normal; font-family: arial; color: #000000; font-size: 11pt; vertical-align: baseline; font-weight: normal; text-decoration: none"></span></p> <p class="read-more">Continue reading <a class="heading" href="/java/2011/06/09/struts2-e8-87-aa-e5-ae-9a-e4-b9-89tiles-xml-e6-96-87-e4-bb-b6-e8-b7-af-e5-be-84.html" data-flip="title">struts2 自定义tiles.xml文件路径</a></p> </article> <article id="post-%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/2011/06/09/%e3%80%90%e8%bd%ac%e3%80%91%e9%a1%b9%e7%9b%ae%e7%ae%a1%e7%90%86%e5%b7%a5%e5%85%b7" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91-e9-a1-b9-e7-9b-ae-e7-ae-a1-e7-90-86-e5-b7-a5-e5-85-b7.html" data-flip="title"> 【转】项目管理工具 </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T18:38:55+08:00">09 Jun 2011</time> in <span>软件工程</span> on <span>项目管理</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: bold;text-decoration: none">项目管理工具(project management tool) : </span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: bold;text-decoration: none">用来支持软件生产中项目管理活动的软件。通常的软件项目管理活动包括项目的计划、调度、通信、费用估算、资源分配以及质量控制等。软件生产是智力密集型的活动，其产品无物理外形，生产状态也“不可见”，因而难于检查和驾驭。软件项目管理工具就是要使这种生产过程成为可见、可控的过程。使用它能帮助进行成本估算、作业调度和任务分配，并制定出成本较低、风险较小的项目开发计划；同时能设法在预计工期和经费之内适当调整项目的安排，以节省时间和人力，从而对软件生产的各个环节进行严格、科学的管理，使项目开发活动获得最佳的进程。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">项目管理工具能对项目的任务调度、成本估算、资源分配、预算跟踪、人时统计、配置控制等活动给予帮助，它具有以下一些特征：</span> <br /> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(1)覆盖整个软件生存周期；</span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(2)为项目调度提供多种有效手段；</span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(3)利用估算模型对软件费用和工作量进行估算；</span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(4)支持多个项目和子项目的管理；</span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(5)确定关键路径，松弛时间，超前时间和滞后时间；</span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(6)对项目组成员和项目任务之间的通信给予辅助；</span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(7)自动进行资源平衡；</span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(8)跟踪资源的使用；</span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(9)生成固定格式的报表和剪裁项目报告。 </span></p> <p> <span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; 项目管理工具通常都支持PERT和Gantt图。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; PERT是计划评价与评审技术。该技术把网络方法用于工作计划安排的评审和检查。通常以带箭头的边表示活动，边的起讫结点表示活动的开始事件和结束事件，边的长度表示该活动的工作量或工期，各结点的顺序反映了各个活动在时序上的制约关系。利用PERT的网络图能求出关键路径和松弛时间，并能对计划的各个活动和资源分配等进行调整。 </span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; Gantt图是一种二维横道图，它广泛用于各种工程活动的进度计划管理。图的横坐标为时间轴，每个活动用一条水平线段表示，其起讫点对应的横坐标值即为该活动的开始和结束时间。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; 尽管新的项目管理方法和技术会改变人们已经习惯的工作方式，学习和掌握新工具也要花费一些时间，但是使用</span><span style="background-color: #ffffaa;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">自动项目管理工具</span><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">比用手工方法管理有许多优点，如： </span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; (1)能对大型项目进行精确跟踪，使项目经理能及时掌握实际工作进展和实际资源&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 消耗情况。 </span> <br /> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(2)能辅助开发PERT，CPM(关键路径方法)和WBS(工作分解结构)，自动更新活动网络图和 Gantt图。 </span></p> <p style="margin-top: 0pt;margin-bottom: 0pt;margin-left: 36pt"><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">(3)能自动计算、自动积累数据、自动生成图形和报表来取代人工计算、调度、统计和文档工作，提高管理工作效率。 </span></p> <p> <span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">国内外已有许多可用于项目管理活动的通用或专用的产品，如</span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Microsoft公司的Project，</span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Lotus公司的Notes和Orgnizer，</span> <br /><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Primavera System公司的Primavera Project Planner等</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></p> <p class="read-more">Continue reading <a class="heading" href="/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91-e9-a1-b9-e7-9b-ae-e7-ae-a1-e7-90-86-e5-b7-a5-e5-85-b7.html" data-flip="title">【转】项目管理工具</a></p> </article> <article id="post-%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/2011/06/09/%e3%80%90%e8%bd%ac%e3%80%91%e6%b7%b1%e5%85%a5%e6%b5%85%e5%87%baood%ef%bc%88%e4%b8%80%ef%bc%89" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91-e6-b7-b1-e5-85-a5-e6-b5-85-e5-87-baood-ef-bc-88-e4-b8-80-ef-bc-89.html" data-flip="title"> 【转】深入浅出OOD（一） </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T18:37:28+08:00">09 Jun 2011</time> in <span>软件工程</span> on <span>Oo</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> </p> <p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">深入浅出OOD（一）</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">撰文/透明</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">有物昆成，先天地生。萧呵！谬呵！独立而不改，可以为天地母。吾未知其名，字之曰</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">道。吾强为之名曰大，大曰逝，逝曰远，远曰反。道大，天大，地大，王亦大。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">——《道德经》，第二十五章</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">软件不软</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">从 60 年代的软件危机，到今天传统软件工程方法处处碰壁的处境，都说明一个问题：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">软件不软（Software is Hard）[Martin, 95]。说实话，软件是一块硬骨头，真正开发过软</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">件的人都会有此感觉。一个应用总是包含无数错综复杂的细节，而软件开发者则要把所</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">有这些细节都组织起来，使之形成一个可以正常运转的程序，这实在不是一件简单的事。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">为什么会这样？举个例子来说：用户可以很轻松地说“我要一个字处理软件”，他觉得</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">“字处理软件”这样一个概念是再清楚不过的了，根本不需要更多的描述；而真正开发</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">一个字处理软件却是一件困难无比的事情——我曾经亲眼看到开发字处理软件的人们</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">是怎样受尽折磨的。为什么表述一个概念很容易，而实现一个概念很困难？因为人们太</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">擅长抽象、太擅长剥离细节问题了。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">软件不软，症结就在这里：用户很容易抽象地表达自己的需求，而这种抽象却很难转化</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">为程序代码。软件不软，因为很简单的设想也需要大量的时间去实现；软件不软，因为</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">满足用户的需求和期望实在太困难；软件不软，因为软件太容易让用户产生幻想。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">而另一方面，计算机硬件技术却在飞速发展。从几十年前神秘的庞然大物，到现在随身</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">携带的移动芯片；从每秒数千次运算到每秒上百亿次运算。当软件开发者们还在寻找能</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">让软件开发生产力提高一个数量级的“银弹”[Brooks, 95]时，硬件开发的生产力早已提</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">升了百倍千倍。这是为什么？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">硬件工程师们能够如此高效，是因为他们都很懒惰。他们永远恪守“不要去重新发明轮</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">子”的古训，他们尽量利用别人的成果。你看到有硬件工程师自己设计拨码开关的吗？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">你看到有硬件工程师自己设计低通滤波电路的吗？你看到有硬件工程师自己设计计时</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">器的吗？他们有一套非常好的封装技术，他们可以把电路封装在一个接插件里面，只露</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">出接口。别人要用的时候，只管按照接口去用，完全不必操心接插件内部的实现。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">而软件工程师们呢？在 STL成为C++标准之前（甚至之后），每个C++程序员都写过自</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">己的排序算法和链表，并认为自己比别人写得更好⋯⋯真是令人伤心。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">OOD 可以让软件稍微“软”一点</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">软件不软，不过OOD可以帮助它稍微“软”一点。OOD为我们提供了封装某一层面上</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">的功能和复杂性的工具。使用OOD，我们可以创建黑箱软件模块，将一大堆复杂的东</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">西藏到一个简单的接口背后。然后，软件工程师们就可以使用标准的软件技术把这些黑</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">箱组合起来，形成他们想要的应用程序。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Grady Booch 把这些黑箱称为类属（class category），现在我们则通常把它们称为“组件</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">（component）”。类属是由被称为类（class）的实体组成的，类与类之间通过关联</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">（relationship）结合在一起。一个类可以把大量的细节隐藏起来，只露出一个简单的接</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">口，这正好符合人们喜欢抽象的心理。所以，这是一个非常伟大的概念，因为它给我们</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">提供了封装和复用的基础，让我们可以从问题的角度来看问题，而不是从机器的角度来</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">看问题。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">软件的复用最初是从函数库和类库开始的，这两种复用形式实际上都是白箱复用。到 90</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">年代，开始有人开发并出售真正的黑箱软件模块：框架（framework）和控件（control）。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">框架和控件往往还受平台和语言的限制，现在软件技术的新潮流是用SOAP 作为传输介</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">质的Web Service，它可以使软件模块脱离平台和语言的束缚，实现更高程度的复用。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">但是想一想，其实Web Service 也是面向对象，只不过是把类与类之间的关联用XML</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">来描述而已[Li, 02]。在过去的十多年里，面向对象技术对软件行业起到了极大的推动作</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">用。在可以预测的将来，它仍将是软件设计的主要技术——至少我看不到有什么技术可</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">以取代它的。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">上面，我向读者介绍了一些背景知识，也稍微介绍了 OOD 的好处。下面，我将回答几</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">个常见的问题，希望能借这几个问题让读者看清OOD 的轮廓。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">什么是 OOD？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">面向对象设计（Object-Oriented Design，OOD）是一种软件设计方法，是一种工程化规</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">范。这是毫无疑问的。按照Bjarne Stroustrup 的说法，面向对象的编程范式（paradigm）</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">是[Stroustrup, 97]：</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">l 决定你要的类；</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">l 给每个类提供完整的一组操作；</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">l 明确地使用继承来表现共同点。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">由这个定义，我们可以看出：OOD 就是“根据需求决定所需的类、类的操作以及类之</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">间关联的过程”。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">OOD 的目标是管理程序内部各部分的相互依赖。为了达到这个目标，OOD要求将程序</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">分成块，每个块的规模应该小到可以管理的程度，然后分别将各个块隐藏在接口</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">（interface）的后面，让它们只通过接口相互交流。比如说，如果用OOD 的方法来设计</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">一个服务器-客户端（client-server）应用，那么服务器和客户端之间不应该有直接的依</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">赖，而是应该让服务器的接口和客户端的接口相互依赖。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">这种依赖关系的转换使得系统的各部分具有了可复用性。还是拿上面那个例子来说，客</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">户端就不必依赖于特定的服务器，所以就可以复用到其他的环境下。如果要复用某一个</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">程序块，只要实现必须的接口就行了。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">OOD 是一种解决软件问题的设计范式（paradigm），一种抽象的范式。使用OOD 这种</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">设计范式，我们可以用对象（object）来表现问题领域（problem domain）的实体，每个</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">对象都有相应的状态和行为。我们刚才说到：OOD 是一种抽象的范式。抽象可以分成</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">很多层次，从非常概括的到非常特殊的都有，而对象可能处于任何一个抽象层次上。另</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">外，彼此不同但又互有关联的对象可以共同构成抽象：只要这些对象之间有相似性，就</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">可以把它们当成同一类的对象来处理。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">OOD 到底从哪儿来？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">有很多人都认为：OOD是对结构化设计（Structured Design，SD）的扩展，其实这是不</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">对的。OOD 的软件设计观念和SD 完全不同。SD 注重的是数据结构和处理数据结构的</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">过程。而在OOD 中，过程和数据结构都被对象隐藏起来，两者几乎是互不相关的。不</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">过，追根溯源，OOD 和SD 有着非常深的渊源。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">1967 年前后，OOD 和SD 的概念几乎同时诞生，它们分别以不同的方式来表现数据结</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">构和算法。当时，围绕着这两个概念，很多科学家写了大量的论文。其中，由Dijkstra</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">和Hoare 两人所写的一些论文讲到了“恰当的程序控制结构”这个话题，声称goto 语句</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">是有害的，应该用顺序、循环、分支这三种控制结构来构成整个程序流程。这些概念发</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">展构成了结构化程序设计方法；而由Ole-Johan Dahl 所写的另一些论文则主要讨论编程</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">语言中的单位划分，其中的一种程序单位就是类，它已经拥有了面向对象程序设计的主</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">要特征。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">这两种概念立刻就分道扬镳了。在结构化这边的历史大家都很熟悉：NATO会议采纳了</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Dijkstra 的思想，整个软件产业都同意goto 语句的确是有害的，结构化方法、瀑布模型</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">从70 年代开始大行其道。同时，无数的科学家和软件工程师也帮助结构化方法不断发</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">展完善，其中有很多今天足以使我们振聋发聩的名字，例如Constantine、Yourdon、</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">DeMarco 和Dijkstra。有很长一段时间，整个世界都相信：结构化方法就是拯救软件工</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">业的“银弹”。当然，时间最后证明了一切。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">而此时，面向对象则在研究和教育领域缓慢发展。结构化程序设计几乎可以应用于任何</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">编程语言之上，而面向对象程序设计则需要语言的支持1，这也妨碍了面向对象技术的</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">发展。实际上，在60 年代后期，支持面向对象特性的语言只有Simula-67 这一种。到</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">70 年代，施乐帕洛阿尔托研究中心（PARC）的Alan Key 等人又发明了另一种基于面向</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">对象方法的语言，那就是大名鼎鼎的Smalltalk。但是，直到80 年代中期，Smalltalk 和</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">另外几种面向对象语言仍然只停留在实验室里。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">到 90 年代，OOD突然就风靡了整个软件行业，这绝对是软件开发史上的一次革命。不</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">过，登高才能望远，新事物总是站在旧事物的基础之上的。70 年代和80 年代的设计方</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">法揭示出许多有价值的概念，谁都不能也不敢忽视它们，OOD 也一样。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">OOD 和传统方法有什么区别？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">还记得结构化设计方法吗？程序被划分成许多个模块，这些模块被组织成一个树型结</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">构。这棵树的根就是主模块，叶子就是工具模块和最低级的功能模块。同时，这棵树也</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">表示调用结构：每个模块都调用自己的直接下级模块，并被自己的直接上级模块调用。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">那么，哪个模块负责收集应用程序最重要的那些策略？当然是最顶端的那些。在底下的</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">那些模块只管实现最小的细节，最顶端的模块关心规模最大的问题。所以，在这个体系</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">结构中越靠上，概念的抽象层次就越高，也越接近问题领域；体系结构中位置越低，概</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">念就越接近细节，与问题领域的关系就越少，而与解决方案领域的关系就越多。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">但是，由于上方的模块需要调用下方的模块，所以这些上方的模块就依赖于下方的细节。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">换句话说，与问题领域相关的抽象要依赖于与问题领域无关的细节！这也就是说，当实</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">现细节发生变化时，抽象也会受到影响。而且，如果我们想复用某一个抽象的话，就必</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">须把它依赖的细节都一起拖过去。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">而在 OOD 中，我们希望倒转这种依赖关系：我们创建的抽象不依赖于任何细节，而细</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">节则高度依赖于上面的抽象。这种依赖关系的倒转正是OOD 和传统技术之间根本的差</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">异，也正是OOD 思想的精华所在。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">OOD 能给我带来什么？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">问这个问题的人，脑子里通常是在想“OOD 能解决所有的设计问题吗？”没有银弹。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">1 我听见有人说“我可以用 C 语言实现面向对象”，不过我希望你不会说“我也喜欢这样做”。很明显，</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">如果没有语言特性的支持，面向对象方法将寸步难行。其实结构化设计也是一样，不过几乎所有的编</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">程语言都提供了对三种基本流程结构的支持，所以基本不会遇到这个问题。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">OOD 也不是解决一切设计问题、避免软件危机、捍卫世界和平⋯⋯的银弹。OOD 只是</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">一种技术。但是，它是一种优秀的技术，它可以很好地解决目前的大多数软件设计问题</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">——当然，这要求设计者有足够的能力。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">OOD 可能会让你头疼，因为要学会它、掌握它是很困难的；OOD甚至会让你失望，因</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">为它也并不成熟、并不完美。OOD 也会给你带来欣喜，它让你可以专注于设计，而不</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">必操心那些细枝末节；OOD 也会使你成为一个更好的设计师，它能提供给你很好的工</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">具，让你能开发出更坚固、更可维护、更可复用的软件。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">C++是一种“真正的”面向对象编程语言吗？</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">最后这个问题和我们今天的主题关系不大，不过这是一个由来已久的问题，而且以后也</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">不一定会有合适的时机说明这个问题，所以今天一起回答了。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">很多人都觉得 C++缺少“真正的”面向对象语言所必须的一些特性，例如垃圾收集</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">（garbage collection）、多分配（multiple-dispatch）之类的。但是，缺少这些特性并不影</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">响开发者们用C++实现面向对象的设计思路。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">在我看来，任何语言，只要它直接支持面向对象设计的实现，那它就是“真正的”面向</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">对象语言。用这个标准来评价，C++是完全符合的：它直接支持继承、多态、封装和抽</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">象，而这些才是面向对象最重要的。而VB 和C 这样的语言不能直接支持这些（尽管可</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">以用特殊的技巧来实现），所以不是“真正的”面向对象语言。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">参考书目</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">l [Brooks, 95] Frederick Brooks, The Mythical Man-Month, Addison-Wesley, 1995.</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">l [Li, 02] 李维，《Delphi 6/Kylix 2 SOAP/Web Service 程序设计篇》，机械工业出</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">版社，2002 年。</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">l [Martin, 95] Robert Martin, Designing Object-Oriented C++ Applications Using</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">the Booch Method, Prentice-Hall, 1995.</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">l [Stroustrup, 97] Bjarne Stroustrup, The C++ Programming Language (Special</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Edition), Addison-Wesley, 1997.</span> <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></p> <p class="read-more">Continue reading <a class="heading" href="/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B/2011/06/09/e3-80-90-e8-bd-ac-e3-80-91-e6-b7-b1-e5-85-a5-e6-b5-85-e5-87-baood-ef-bc-88-e4-b8-80-ef-bc-89.html" data-flip="title">【转】深入浅出OOD（一）</a></p> </article> <article id="post-web/2011/06/09/nio-%e5%92%8c-web-%e7%ba%bf%e7%a8%8b" class="post mb6" role="article"> <header> <h1 class="post-title"> <a href="/web/2011/06/09/nio-e5-92-8c-web-e7-ba-bf-e7-a8-8b.html" data-flip="title"> nio 和 web 线程 </a> </h1> <p class="post-date heading"> <time datetime="2011-06-09T18:35:37+08:00">09 Jun 2011</time> in <span>Web</span> on <span>Java</span>, <span>Nio</span> </p> <div class="hr" style="padding-bottom:0"></div> </header> <p>见文章 <a href="http://kazge.com/archives/275.html " target="_blank">http://kazge.com/archives/275.html</a> 讲得比较详细。</p> <p>再看 <a href="http://www.ibm.com/developerworks/cn/java/j-nioserver/" target="_blank">http://www.ibm.com/developerworks/cn/java/j-nioserver/</a></p> <p>看看 <a title="http://zddava.iteye.com/blog/835244" href="http://zddava.iteye.com/blog/835244">http://zddava.iteye.com/blog/835244</a></p> <p><strike>综上所述，我认为nio并不能对web 服务器性能提高很大因为每个servlet还是一个线程，这样与没有使用nio的情况是一样的。??</strike></p> <p>现在看看<a title="http://kazge.com/archives/596.html" href="http://kazge.com/archives/596.html">http://kazge.com/archives/596.html</a>，这篇文章分析的比较细。nio跟更像是多路io,性能还是能够提升的！</p> <p class="read-more">Continue reading <a class="heading" href="/web/2011/06/09/nio-e5-92-8c-web-e7-ba-bf-e7-a8-8b.html" data-flip="title">nio 和 web 线程</a></p> </article> <h2 class="sr-only">Pagination</h2> <nav class="pagination heading" role="navigation"> <ul> <li class="pagination-item older" > <a rel="next" href="/page-55/">Older</a> </li> <li class="pagination-item newer" > <a rel="prev" href="/page-53/">Newer</a> </li> </ul> </nav> <footer> <hr/> <p>© 2011 - 2017. All rights reserved.</p> <p> <code>Powered by <a href="https://qwtel.com/hydejack/">Hydejack</a> v<span id="_version">6.6.1</span></code> </p> </footer> </main> </div> <div id="_yDrawer"> <div id="_sidebar" class="sidebar"> <div class="sidebar-bg" style="background-color:#4f86aa;background-image:url()"></div> <header class="sidebar-sticky" role="banner"> <div class="sidebar-about"> <img src="https://avatars0.githubusercontent.com/u/4122902?v=4&s=460" class="me" /> </div> <div class="sidebar-about"> <h1><a id="_title" href="/">Ka's Blog</a></h1> <p>Ka’s blog description…</p> </div> <nav class="sidebar-nav heading" role="navigation"> <span class="sr-only">Navigation:</span> <ul> <li> <a class="sidebar-nav-item" href="/categories.html">Categories</a> </li> <li> <a class="sidebar-nav-item" href="/archive.html">Archive</a> </li> <li> <a class="sidebar-nav-item" href="/tags.html">Tags</a> </li> <li> <a class="sidebar-nav-item" href="/about.html">About</a> </li> </ul> </nav> <div class="sidebar-social"> <span class="sr-only">Social:</span> <ul> <li> <a href="https://twitter.com/imhazige" title="Twitter"> <span class="icon-twitter"></span> <span class="sr-only">Twitter</span> </a> </li> <li> <a href="https://github.com/imhazige" title="GitHub"> <span class="icon-github"></span> <span class="sr-only">GitHub</span> </a> </li> <li> <a href="mailto:imhazige@gmail.com" title="Email"> <span class="icon-mail"></span> <span class="sr-only">Email</span> </a> </li> <li> <a href="https://imhazige.github.io/myblog/feed.xml" title="RSS"> <span class="icon-rss2"></span> <span class="sr-only">RSS</span> </a> </li> </ul> </div> </header> </div> </div> </div> <!--[if gt IE 9]><!----> <script>loadJSDeferred('/assets/js/hydejack.js?v=6.6.1');</script> <!--<![endif]--> </body>
</html>
