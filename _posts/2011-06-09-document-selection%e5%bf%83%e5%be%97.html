---
layout: post
title: document selection心得
date: 2011-06-09 13:45:04.000000000 +01:00
type: post
published: true
status: publish
categories:
- Web前端
tags:
- javascript web 前端
meta:
  views: '108'
author:
  login: ig2net
  email: ig2net@ig2net.info
  display_name: "农夫一号"
  first_name: ''
  last_name: ''
---
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">选中区常用于文本提示，可视化编辑器。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">document.selection指代当前选中区。createRange和createTextRange有什么区别我还没搞明白。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">当用户没有选中任何区域时,但是某个元素具有焦点时document.selection.createRange就指代当前焦点,其实也就是空白选中区，在可以获得交点坐标offsetLeft/Top.</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">否则就是用户选中区的Range,那么textarea.select()后document.selection.createRange就获得了这个textarea的全选文本区。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">关于setEndPoint第二个参数还的研究一下，因为</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #134f5c;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">textarea和input type=text的createTextRange()返回的对像类型好像不一样。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #134f5c;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">input type=text的createTextRange()与document.selection.createRange()得到的对像好像又一至。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #134f5c;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">textarea的setEndPoint(string,TextRange)中的TextRange不能使用document.selection.createRange()取得的对像</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #134f5c;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">input type=text的setEndPoint(string,TextRange)中的TextRange却可以使用document.selection.createRange()取得的对像</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #134f5c;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">另外,TextRange的moveToElementText()可以textarea做参数,而input type=text却不行。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #134f5c;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">上面是网上的，我的实际经验是第二个参数必须是</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #134f5c;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">document.selection.createRange(),</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">不知道为什么？</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">moveStart/End 中的第二个参数是相对于当前选中位置，-1表示向前移动一个单位.</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">另外keydown时间里面处理选中区会有些问题，回车 就被忽略不计了，计算当前光标之前的文本就出了问题，而在keyup事件里面是没有这个问题的。</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #134f5c;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></p>
