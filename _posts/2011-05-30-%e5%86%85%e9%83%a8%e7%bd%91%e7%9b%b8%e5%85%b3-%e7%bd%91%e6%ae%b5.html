---
layout: post
title: "内部网相关--网段"
date: 2011-05-30 09:15:56.000000000 +01:00
type: post
published: true
status: publish
categories:
- Web
tags:
- "网络"
meta:
  views: '163'
author:
  login: ig2net
  email: ig2net@ig2net.info
  display_name: "农夫一号"
  first_name: ''
  last_name: ''
---
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">問：如何定義同一網段內的 IP？什麼是子網路遮罩（Netmask）？如何以子網路遮罩來切割 IP 成不同網段呢？</span></li>
</ul>
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">答：</span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></li>
</ul>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">說說這個問題本身的意義，通常我們都會以虛擬 IP 來架設家裡或企業內部的『區域網路』，那架設區域網路有何好處呢？最大的好處就是所有在你區域網路的電腦都可以直接溝通，也就是電腦之間就可以互相傳遞資 料了（例如網路上的芳鄰般，可以互傳資料！），由於處於同一網段，因此各電腦可以直接向 Server 要資料，而不用再透過其他的中繼介面（例如路由器-Router）。那如果不是在同一網段內呢？例如 192.168.1.1 及 192.168.2.1 其實是兩個不同的網段的 IP ，那樣的話，假設你的 Server 對內的 IP 為 192.168.1.2 則當 192.168.2.1 這個電腦向 Server 要資料的時候， Server 將會不認得這個電腦所傳來的訊息，因為這兩組 IP 是不同的網段內的，資料將必須通過 Router 來確認，因此若沒有 router 也就沒有辦法給予資料了！瞭解了嗎？也就是說，當</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #3333ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">你設定 IP 錯誤的時候，你的區域網路將無法工作，因為資料封包之間將互相不認識囉！</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">所以我們得知道 IP 是否在同一網段之內，這樣才能規劃好區域網路！</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">以下的文章引述了很多</span><a href="http://www.study-area.org/network/networkfr1.htm"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">study-area</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> 的內容，歡迎大家前往參觀網中人的 Linux 學習網站！</span>
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">IP 的形式</span></li>
</ul>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">先來瞭解一下何謂 IP ？基本上電腦是只懂得 1 與 0 這兩個單元的（二進位法），因此，IP 位址在設計上也是以二進位法來設計的。眾所皆知的， IP 是 xxx.yyy.zzz.qqq 共四組 3 位數的數字組合而成的，而每組數字皆由 0~255 所組成，其實，也就是 0 ~ (28-1) 所組成的！也就是</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #3333ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> 0.0.0.0 ~ 255.255.255.255 </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">囉，這就是一般我們所使用的 IP 形式咯。</span>
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">IP 的判別（Class）</span></li>
</ul>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">好了，那網路如何以 IP 來判斷你這個封包要去的地方呢？當然囉， IP 定是有所謂的 NetID 與 HostID 囉，這樣網路的 TCP/IC 協定才知道 IP 是在哪一個地方呀！。因此， IP 可以將網路的識別碼和主機的識別碼放在單一的IP地址上面了。如果以二進位法來看，255 的表示為 11111111 ，而在判斷 IP 上，在最左邊的那一組 3 位數的號碼上，通常你可以這樣分辨：</span>
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">二進位法：</span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">如果是以“0”開頭的﹐這IP是一個A Class的IP(Ex&gt;01000000.00000001.00000001.00000001)</span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">如果是以“10”開頭的﹐這是一個B Class的IP(Ex&gt;10000001.00000001.00000001.00000001)</span></li>
</ul>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">如果是以“110”為開頭的﹐則屬於C Class的IP(Ex&gt;11000001.00000001.00000001.00000001)</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">而換算之後，就有如下的規則：</span>
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">十進位法：</span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">由1到126開頭的IP是A Class(Ex&gt;10.0.0.1)﹔</span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">由128到191開頭的IP是B Class(Ex&gt;129.0.0.1)；</span></li>
</ul>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">由192到223開頭的則為C Class(Ex&gt;211.74.1.1)。</span>
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">關於子網路遮罩：</span></li>
</ul>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">好了，這裡也不多說一些學理的原理了，如果你需要更瞭解的話，就請到 study-area 去看看，網中人前輩已經說明的很清楚了，這裡只指出一些規則罷了！通常是這樣的：</span>
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">A Class: Netmask 255.0.0.0</span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">B Class: Netmask 255.255.0.0</span></li>
</ul>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">C Class: Netmask 255.255.255.0</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">以我們常使用的虛擬 IP 192.168.1.0 這個網段中，因為開頭是 192 因此是一個 C Class 的 IP ，並且他的子網路遮罩為 255.255.255.0 ，那</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">子網路遮罩有何意義呢？其實是這樣的， 255.255.255.0 表示 前三組號碼為 NetID（不變的），而最後一組號碼則為 HostID（唯一的），因此，當我們的 Netmask 設為 255.255.255.0 時，則我們的 192.168.1.0 ~ 192.168.1.255 就屬於同一個網段內了！</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">且在這個網段之內，每一個 hostID 只能存在一台，例如你的區域網路中就只能有一個 192.168.1.100，絕不能出現兩個！</span>
<ul>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">這樣是不是有點概念了呢？如果你是在一個大型企業之內的區域網路，如果嫌麻煩又不怕封包碰撞引起的網路龜速時，可以使用 B Class 的網段，例如：172.18.0.0 這一個，而 Netmask 為 255.255.0.0，也就是說，在你這個網段當中， 172.18.0.0~172.18.255.255 均屬於同一個網段中，</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">那同一個網段有何好處呢？最大的好處就是在同一個網段中，資料將可以透過廣播的方式傳遞，而不必透過 router 來傳送！</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">要知道， Router 可是很貴的哩！所以，你的區網之內的每部機器將可以直接溝通，而不必藉由其他的 router 來傳遞囉！</span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">上面的說明實在說的不好，反正，要曉得的是，若你的 IP 開頭是在 1~126 時，就是 A class 的 IP 群組，至於 C class 的 IP 則是 192~223 之間的 IP 囉。另外， Netmask 才是真正在控制你的 IP 是在哪一個網段的！而通常我們比較常設定的是 C class 的區域網路設定！說真的，要瞭解 IP 的話，還是請到 study-area 去看看吧！</span></li>
</ul>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">------------------------------------------------------------------------------------------------------</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">一提到网段（即网络分段），</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">通常有两个概念，一种是指物理上由网络连接设备所相隔的网络。比如由路由设备（或者交换机，甚至集线器）连接的两个局域网，我们可以称之为两个网段。另一种是指从逻辑上，根据其IP地址中的网络地址来区分其所属的网段。</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">为了说明这个概念，我们需要先理解IP地址的结构，IP地址是由32位二进制位组成的。如果按每8位为一组，转换成十进制的话，可以写成由三个句点分隔的，4位数字的形式。例如192.168.0.1（对应的二进制位是1100000101010000000000000000001).</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">IP地址由网络地址和主机地址两部分组成。分配给网络地址和主机地址的位数随着地址类型（后面会提到）的不同而不同。IP地址编址的方法与街道地址的概念相似，比如中山街100号。IP地址中的网络地址相当于中山街，主机地址相当于100号。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">为了方便管理，IP地址分为5类：数量非常有限的，非常大的网络（A类）；数量较多规模中等的网络（B类）；为数众多的小网络（C类），以及用于组播（D类）和研究和实验之用（E类）。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">那它们是如何区分的呢？IP地址的类型可以通过察看地址的第一个八位组业判断。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">对于A类地址，分配IP地址的前8位作为网络地址，其余24位作为主机地址。并且，这前8位二进制位中的第一位必须是“0”。转换成十进制后，其取值的范围应在0--127之间。再加上0和127已经被留做它用，所以，A类网只有126个。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">对于B类地址，分配IP地址的前16位作为网络地址，其余16位作为主机地址。并且，这前16位二进制位中的前两位必须是“10”。转换成十进制后，其取值的范围应在128--191之间。由于最高两位被限定为“10”，所以，实际上只有其后的14位用来区分网络地址，也就是说，可以有16384个B类网。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">对于C类地址，分配IP地址的前24位作为网络地址，其余8位作为主机地址。并且，这前24位二进制位中的前三位必须是“110”。转换成十进制后，其取值的范围应在192--223之间。可以有2的21次方个C类网。但由于只有8位用于主机机址，所以，每个C类网，只能有254台主机（主机地址不能全为0 或全为1）。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">D类和E类地址的前四位，分别规定为“1110”和“1111”，对应的十进制取值范围为224--239和240--254。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">由于互联网起源于美国国防部研发的ARPANET,所以，美国占用了大部分A类网址，其后的国家，根据接入互联网时间的先后等因素，申请并获得剩余的网络地址。这也是为什么中国网民众多，可得到的许多地址却是C类的主要原因。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">子网掩码，也是由32位二进位组成的，它告诉TCP/IP主机，IP地址的哪些位对应于网络地址，哪些位对应于主机地址。子网掩码中1所对应的部分网络地址，0所对应的部分为主机地址。计算时用IP地址与子网掩码按位进行逻辑与运算。例如一台主机的IP地址为192.168.0.1（对应的二进制位为 110000001010100000000000000000001），子网掩码为255.255.255.0（对应的二进制位为 11111111111111111111111100000000），由于子网掩码的前24位为1，则表示该IP地址的前24位为网络地下，后8位为主机地址。前24位转换成十进制后为192.168.0，这个地址就是192.168.0.1这个IP地址的网络地址，也叫网络ID。不同的网络地址（网络 ID）就属于不同的网段（也叫子网）。因此，说两个IP地址是否是同一个网段（或子网）的，不能仅凭IP地址，必须结合子网掩码来看。例如您提到的 192.168.0.1和192.168.1.5这两个地址，如果子网掩码是255.255.255.0，则这两个IP地址是分属两个子网的，但如果子网掩码是255.255.0.0.则这两个IP地址是同一个子网的。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">有网友可能会问，既然IP地址分为5类，而且每类IP地址都有各自的范围。那么通过IP地址的值，不就可以知道哪几位是网络地址，哪几位是主机地址了吗？说的没错，确实这样。但这是在理想的情况下。前边我们也提到过，C类网中，每个网络只能有254台主机，对于一个比较大的单位和组织来说，这254台主机是远远不够的。那我们就希望能够将连续的若干个C类网，合并成一个较大的网络，在互联网上做为一个单独的网络通告。与此相反，一些机构获得了B类网，甚至A 类网址，为了便于管理，或是出于性能的考虑（如果一个网段内主机数量过多，会使网络运行效率大幅下降。），需要将网络细化。这两种情况（组给小网络和细化大网络）都需要改变子网掩码的位数，使其不同于标准分类中的掩码长度。所以，仅凭IP地址来判断其是否属于一个网段，是不正确的。</span><span style="background-color: transparent;font-style: normal;font-family: verdana;color: #103e7b;font-size: 13pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">-----------------------------------------------------------------------------------------------------------</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">越看越多……无语</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">----------------------------------------------------------------------------------------------------------</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">互动百科，广播风暴</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">交换机不能阻止广播风暴</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: times new roman;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">交换机与集线器的本质区别</span><span style="background-color: transparent;font-style: normal;font-family: times new roman;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">：用集线器组成的网路称为</span><a href="http://www.hudong.com/wiki/%E5%B9%BF%E6%92%AD%E9%A3%8E%E6%9A%B4"><span style="background-color: transparent;font-style: normal;font-family: times new roman;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">共享式网路</span></a><span style="background-color: transparent;font-style: normal;font-family: times new roman;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">， 而用交换机组成的网路称为交换式网路。 共享式以太网存在的主要问题是所有用户共享带宽，每个用户的实际可用带宽随网路用户数的增加而递减。这是因为当资 讯繁忙时，多个用户可能同时“争用”一个信道，而一个信道在某一时刻只允许一个用户占用，所以大量的用户经常处于监测等待状态，致使信号传输时产生抖动、 停滞或失真，严重影响了网路的性能。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></p>
