---
layout: post
title: wordpress i18n多语言支持实现
date: 2012-09-13 17:54:37.000000000 +01:00
type: post
published: true
status: publish
categories:
- php
tags:
- wordpress
meta:
  views: '145'
author:
  login: ig2net
  email: ig2net@ig2net.info
  display_name: "农夫一号"
  first_name: ''
  last_name: ''
---
<p>文档<a href="http://codex.wordpress.org/I18n_for_WordPress_Developers">http://codex.wordpress.org/I18n_for_WordPress_Developers</a></p>
<p>WP使用gettext(GNU来源项目)来实现i18n,带式实际使用是WP的函数__()和_e(), __是返回对应字符串，_e则是加载对应字符串并echo到返回流中。</p>
<p><font color="#0000ff">首先WP的多语言是个全局配置</font>，<tt>wp-config.php中的配置项<tt>WPLANG</tt>指定是哪个语言。</tt></p>
<p><tt><font color="#0000ff">然后在程序中加载mo</font></tt></p>
<p>load_theme_textdomain (theme对应函数)</p>
<p>或是plugin中使用load_plugin_textdomain( $domain, $path_from_abspath, $path_from_plugins_folder )</p>
<p>来加载文件夹中对应语言的mo文件。</p>
<p><font color="#0000ff">然后在你的php代码中使用__或_e来使用这些多语言。</font></p>
<p><font color="#0000ff"></font></p>
<p>wordpress多语言要使用xgettext生成pot文件然后转为po文件再转为mo文件，这位台湾同胞写的比较详细:</p>
<p><a href="http://blog.longwin.com.tw/2010/08/windows-gettext-2010/">http://blog.longwin.com.tw/2010/08/windows-gettext-2010/</a></p>
<p>&#160;</p>
<blockquote><h6>Windows 的 GetText 工具安裝</h6>
<ul>
<li>於 <a href="http://gnuwin32.sourceforge.net/packages/gettext.htm">GetText for Windows</a> 下載 Binaries 版, 安裝即可. (假設安裝於 C:\gettext) </li>
</ul>
<h6>GetText 所需相關 Library 安裝</h6>
<ul>
<li>上述套件下載後, 於 Windows XP 會缺下述兩個 Library:
<ul>
<li>libexpat.dll </li>
<li>libiconv2.dll </li>
</ul>
</li>
<li>可自行去尋找, 或者 直接下載 我抓好的版本 : <a href="http://plog.longwin.com.tw/files/gettext-dll.tgz">gettext-dll.tgz</a> </li>
<li>將這兩個檔案放到 C:\gettext\bin\ 即可. </li>
</ul>
<h6>GetText 工具使用</h6>
<ul>
<li>C:\gettext\bin\xgettext.exe --from-code=UTF-8 -d hello hello.php </li>
<li>C:\gettext\bin\msgmerge.exe -o hello.po locale/zh_TW/LC_MESSAGES/hello.po hello.po </li>
<li>C:\gettext\bin\msgfmt.exe -o locale/zh_TW/LC_MESSAGES/hello.mo hello.po </li>
</ul>
</blockquote>
<li>但是我试过了，不是很好用，其实在windows下最方便的是使用poedit了。</li>
<li><a href="http://www.poedit.net/download.php">http://www.poedit.net/download.php</a>&#160;</li>
<li>它是一个开元免费的工具，可以批量从php中导入生成po并且编辑，生成mo。</li>
<p>这里我来讲一下怎么使用：</p>
<p>新建File/New Catalog,出现对话框，红色框式必填的且要保证正确，</p>
<p><a href="http://blog.ureshika.com/wp-content/uploads/2012/09/Snap11.gif"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="Snap1" border="0" alt="Snap1" src="{{ site.baseurl }}/assets/Snap1_thumb1.gif" width="554" height="448" /></a> </p>
<p><a href="http://blog.ureshika.com/wp-content/uploads/2012/09/Snap21.gif"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="Snap2" border="0" alt="Snap2" src="{{ site.baseurl }}/assets/Snap2_thumb1.gif" width="549" height="445" /></a> </p>
<p>source path就是php代码文件夹</p>
<p><a href="http://blog.ureshika.com/wp-content/uploads/2012/09/Snap3.gif"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="Snap3" border="0" alt="Snap3" src="{{ site.baseurl }}/assets/Snap3_thumb.gif" width="555" height="449" /></a> </p>
<p>由于使用php所以需要添加关键字_e和__</p>
<p>这样点击ok一路ok下去，就发现所有需要翻译的都加进来了。还可以编辑，它自动生成po,mo文件。</p>
<p>很方便是吧。</p></p>
<li>
</li>
