---
layout: post
title: wicket tapestry5 sopo 模板实现浅析
date: 2011-06-09 11:42:35.000000000 +01:00
type: post
published: true
status: publish
categories:
- java
- Web前端
tags:
- javascript web 前端
meta:
  views: '152'
author:
  login: ig2net
  email: ig2net@ig2net.info
  display_name: "农夫一号"
  first_name: ''
  last_name: ''
---
<h3 id="internal-source-marker_0.8637201135828881"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">1 Wicket实现</span></h3>
<p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; Wicket模板是html格式,示例:index.html</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span>
<ol>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;head&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;title&gt;Index.html&lt;/title&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;!--&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;--&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;/head&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;body&gt;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;a wicket:id=&quot;edit&quot; href=&quot;UserEdit.html?uid=1&quot; target=&quot;_blank&quot; &gt;edit form&lt;/a&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;/body&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/html&gt;&#160; </span></li>
</ol>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;   <br class="kix-line-break" />&lt;html&gt;    <br class="kix-line-break" /> &lt;head&gt;    <br class="kix-line-break" />&#160;&#160; &lt;title&gt;Index.html&lt;/title&gt;    <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;    <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt;    <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;    <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;!--&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;--&gt;    <br class="kix-line-break" />    <br class="kix-line-break" /> &lt;/head&gt;    <br class="kix-line-break" />    <br class="kix-line-break" /> &lt;body&gt;     <br class="kix-line-break" />&#160;&#160; &lt;a wicket:id=&quot;edit&quot; href=&quot;UserEdit.html?uid=1&quot; target=&quot;_blank&quot; &gt;edit form&lt;/a&gt;    <br class="kix-line-break" /> &lt;/body&gt;    <br class="kix-line-break" />&lt;/html&gt;</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">还要在后台page类Index 中手动添加进组件列表中。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Java代码</span>
<ol>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public class Index extends WebPage&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">/** </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">* Constructor </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">*/&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public Index()&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; PageLink link = new PageLink(&quot;edit&quot;,new IPageLink());&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; add(link);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li>
</ol>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public class Index extends WebPage   <br class="kix-line-break" />{    <br class="kix-line-break" />/**    <br class="kix-line-break" />* Constructor    <br class="kix-line-break" />*/    <br class="kix-line-break" />public Index()    <br class="kix-line-break" />{    <br class="kix-line-break" />&#160;&#160; PageLink link = new PageLink(&quot;edit&quot;,new IPageLink());    <br class="kix-line-break" />&#160;&#160; add(link);    <br class="kix-line-break" />}    <br class="kix-line-break" />}</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">add方法是继承自父类</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.MarkupContainer</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">的方法</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">，</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">会将组件添加到其字段children中去.</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">模板由</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.MarkupParser</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">解析，遇到</span><span style="background-color: transparent;font-style: normal;font-family: courier new;color: #ff0000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">wicket:id</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">属性的会转换为</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.MarkupElement,</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">最终将html模板解析成</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">MarkupElement</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">列表,添加到</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.Markup</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">的</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">List&lt;MarkupElement&gt; markupElements</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">集合中,在组件绘制的时候,将其</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">包装成</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.MarkupStream</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">，会遍历</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">MarkupElement</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">列表,依据组件id获得组件,让每个组件进行绘制--调用方法</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">void org.apache.wicket.Component.render(MarkupStream markupStream).</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">具体的主要的解析实现是由</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.wicket.markup.parser.XmlPullParser</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">完成的,通过过字符串操作来解析,</span><span style="background-color: #ffff00;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">详见其next方法</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">,并没有使用第三方类库.</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: bold;text-decoration: none">2 tapestry实现</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">tapestry5模板时xml格式,示例Index.tml</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span>
<ol>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html xmlns:t=&quot;http://tapestry.apache.org/schema/tapestry_5_0_0.xsd&quot;&gt; &lt;head&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;title&gt;Test&lt;/title&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/head&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;body&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;h1&gt;Test&lt;/h1&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;h1&gt;Address Book&lt;/h1&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;t:span c=&quot;d&quot; &gt;${fi}&lt;/t:span&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;ul&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;li&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;a t:type=&quot;pagelink&quot; t:page=&quot;index&quot; &gt;Create new address&lt;/a&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/li&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/ul&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/body&gt; &lt;/html&gt;&#160; </span></li>
</ol>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html xmlns:t=&quot;http://tapestry.apache.org/schema/tapestry_5_0_0.xsd&quot;&gt; &lt;head&gt;   <br class="kix-line-break" />&lt;title&gt;Test&lt;/title&gt;    <br class="kix-line-break" />&lt;/head&gt;    <br class="kix-line-break" />&lt;body&gt;    <br class="kix-line-break" />&lt;h1&gt;Test&lt;/h1&gt;    <br class="kix-line-break" />&lt;h1&gt;Address Book&lt;/h1&gt;    <br class="kix-line-break" />&lt;t:span c=&quot;d&quot; &gt;${fi}&lt;/t:span&gt;    <br class="kix-line-break" />&lt;ul&gt;    <br class="kix-line-break" />&lt;li&gt;    <br class="kix-line-break" />&lt;a t:type=&quot;pagelink&quot; t:page=&quot;index&quot; &gt;Create new address&lt;/a&gt;    <br class="kix-line-break" />&lt;/li&gt;    <br class="kix-line-break" />&lt;/ul&gt;    <br class="kix-line-break" />&lt;/body&gt; &lt;/html&gt;</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">因为已经在模板中指明了这个节点是什么类型的组件，所以，tapestry5就不需要再add组件了，它本身也不提供add方法。&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public class Index</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Java代码</span>
<ol>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">@Inject&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">private Logger logger;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">private GridDataSource dss;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">private int fi;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public Index()&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">super();&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">System.out.println(&quot;call ctor.&quot;);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public int getFi()&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">return fi;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">public void setFi(int fi)&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">this.fi = fi;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">}&#160; </span></li>
</ol>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">{   <br class="kix-line-break" />@Inject    <br class="kix-line-break" />private Logger logger;    <br class="kix-line-break" />private GridDataSource dss;    <br class="kix-line-break" />private int fi;    <br class="kix-line-break" />public Index()    <br class="kix-line-break" />{    <br class="kix-line-break" />super();    <br class="kix-line-break" />System.out.println(&quot;call ctor.&quot;);    <br class="kix-line-break" />}    <br class="kix-line-break" />public int getFi()    <br class="kix-line-break" />{    <br class="kix-line-break" />return fi;    <br class="kix-line-break" />}    <br class="kix-line-break" />public void setFi(int fi)    <br class="kix-line-break" />{    <br class="kix-line-break" />this.fi = fi;    <br class="kix-line-break" />}    <br class="kix-line-break" />}</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; tapastry5使用</span><a href="http://stax.codehaus.org/Home"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">stAx</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">实现的,</span></a><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">这篇文章</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">介绍了stax的用法,tapestry5通过注入的方式将</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.tapestry5.internal.services.TemplateParserImpl</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 12pt;vertical-align: baseline;font-weight: normal;text-decoration: none">注入到</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.ComponentTemplateSourceImpl</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">中的</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">private final TemplateParser parser;</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">字段中，</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">TemplateParserImpl</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 实际使用的是</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.tapestry5.internal.services.StaxTemplateParser,</span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">在这里面会使用stax对模板进行解析。它通过节点是否有t:id,t:type属性来判断</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 是否是一个服务端组件。解析完模板会组建成一个节点列表，再在绘制页面的时候依据这个列表的顺序来调用相应的组件绘制。</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 逻辑主要在以下的类中</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">org.apache.tapestry5.internal.parser.ComponentTemplateImpl</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.structure.PageImpl</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.PageRenderRequestHandlerImpl</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.PageResponseRendererImpl</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.PageMarkupRendererImpl</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; org.apache.tapestry5.internal.services.PageRenderQueueImpl</span></a>  <br /><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #0000ff;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Page org.apache.tapestry5.internal.pageload.PageLoaderImpl.loadPage(String logicalPageName, Locale locale)</span></a>  <br /> <br />
<h3><a href="http://www.ibm.com/developerworks/cn/xml/x-stax1.html"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">3</span></a><a href="http://sourceforge.net/projects/sopo/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none"> </span><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: underline">sopo</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">的实现方法</span></h3>
<p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; Sopo是可由每个page类来指明模板内容，只要是html格式就可以，示例:</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">Html代码</span>
<ol>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;html&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;head&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;title&gt;test.html&lt;/title&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;script type=&quot;text/javascript&quot; src=&quot;js/hello.js&quot; &gt;&lt;/script&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; function $(id){&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return document.getElementById(id);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; function test()&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; {&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; $('rst').innerHTML=reg.test($('d').value);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; var reg = new RegExp(&quot;^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$&quot;);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160; //var reg = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/i;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/script&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;/head&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;body&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> h--------&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;!-- hahah&#160; --&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;![CDATA[jkjkjk]]&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;form action=&quot;&quot;&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;label stype=&quot;s:Label&quot; id=&quot;lab1&quot; &gt;Hello World1&lt;label stype=&quot;s:Label&quot; id=&quot;lab2&quot; &gt;Hello World3&lt;/label&gt;&lt;/label&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input type=&quot;password&quot; /&gt;&#160;&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;label stype=&quot;s:Label&quot; id=&quot;lab3&quot; &gt;Hello World2&lt;/label&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input stype=&quot;s:Checkbox&quot; id=&quot;chk&quot; name=&quot;chk&quot; &gt;sss&lt;/input&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;select stype=&quot;s:Select&quot; id=&quot;sel&quot; name=&quot;sel&quot; width=&quot;20px&quot; &gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;1&quot; &gt;&lt;/option&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;2&quot; selected=&quot;selected&quot; &gt;&lt;/option&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;3&quot; &gt;&lt;/option&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/select&gt;&#160;&#160;&#160;&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input id=&quot;d&quot; type=&quot;text&quot; /&gt;&lt;button onclick=&quot;test();&quot;&gt;Test&lt;/button&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;span id=&quot;rst&quot;&gt;true&lt;/span&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; &gt;1&lt;/input&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; &gt;2&lt;/input&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; onclick=&quot;alert(this.value);&quot; &gt;3&lt;/input&gt;3&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160; &lt;/form&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"> &lt;/body&gt;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;/html&gt;&#160; </span></li>
</ol>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;   <br class="kix-line-break" />&lt;html&gt;    <br class="kix-line-break" /> &lt;head&gt;    <br class="kix-line-break" />&#160;&#160; &lt;title&gt;test.html&lt;/title&gt;    <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;keywords&quot; content=&quot;keyword1,keyword2,keyword3&quot;&gt;    <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;description&quot; content=&quot;this is my page&quot;&gt;    <br class="kix-line-break" />&#160;&#160; &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=ISO-8859-1&quot;&gt;    <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;./styles.css&quot;&gt;    <br class="kix-line-break" />&#160;&#160; &lt;script type=&quot;text/javascript&quot; src=&quot;js/hello.js&quot; &gt;&lt;/script&gt;    <br class="kix-line-break" />&#160;&#160; &lt;script type=&quot;text/javascript&quot;&gt;    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; function $(id){    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return document.getElementById(id);    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; }    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; function test()    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; {    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; $('rst').innerHTML=reg.test($('d').value);    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; }    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; var reg = new RegExp(&quot;^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$&quot;);    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; //var reg = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/i;    <br class="kix-line-break" />&#160;&#160; &lt;/script&gt;    <br class="kix-line-break" /> &lt;/head&gt;    <br class="kix-line-break" />    <br class="kix-line-break" /> &lt;body&gt;    <br class="kix-line-break" /> h--------    <br class="kix-line-break" /> &lt;!-- hahah&#160; --&gt;    <br class="kix-line-break" />&#160;&#160; &lt;![CDATA[jkjkjk]]&gt;    <br class="kix-line-break" />&#160;&#160; &lt;form action=&quot;&quot;&gt;    <br class="kix-line-break" />&#160;&#160; &lt;label stype=&quot;s:Label&quot; id=&quot;lab1&quot; &gt;Hello World1&lt;label stype=&quot;s:Label&quot; id=&quot;lab2&quot; &gt;Hello World3&lt;/label&gt;&lt;/label&gt;    <br class="kix-line-break" />&#160;&#160; &lt;input type=&quot;password&quot; /&gt;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;label stype=&quot;s:Label&quot; id=&quot;lab3&quot; &gt;Hello World2&lt;/label&gt;    <br class="kix-line-break" />&#160;&#160; &lt;input stype=&quot;s:Checkbox&quot; id=&quot;chk&quot; name=&quot;chk&quot; &gt;sss&lt;/input&gt;    <br class="kix-line-break" />&#160;&#160; &lt;select stype=&quot;s:Select&quot; id=&quot;sel&quot; name=&quot;sel&quot; width=&quot;20px&quot; &gt;    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;1&quot; &gt;&lt;/option&gt;    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;2&quot; selected=&quot;selected&quot; &gt;&lt;/option&gt;    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160; &lt;option stype=&quot;s:Option&quot; text=&quot;3&quot; &gt;&lt;/option&gt;    <br class="kix-line-break" />&#160;&#160; &lt;/select&gt;&#160;&#160;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160; &lt;input id=&quot;d&quot; type=&quot;text&quot; /&gt;&lt;button onclick=&quot;test();&quot;&gt;Test&lt;/button&gt;    <br class="kix-line-break" />&#160;&#160; &lt;span id=&quot;rst&quot;&gt;true&lt;/span&gt;    <br class="kix-line-break" />&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; &gt;1&lt;/input&gt;    <br class="kix-line-break" />&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; &gt;2&lt;/input&gt;    <br class="kix-line-break" />&#160;&#160; &lt;input type=&quot;radio&quot; name=&quot;1&quot; onclick=&quot;alert(this.value);&quot; &gt;3&lt;/input&gt;3    <br class="kix-line-break" />&#160;&#160; &lt;/form&gt;    <br class="kix-line-break" /> &lt;/body&gt;    <br class="kix-line-break" />&lt;/html&gt;</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">它和tapestry有些像，因为模板里面指明了组件类型，所以就不需要再添加了.</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">Java代码</span>
<ol>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">public class Index extends Page&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">{&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; @Override&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; public String getTemplate()&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; {&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; try&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; {&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return FileUtils.readFileToString(new File(getSession().getServletContext().getRealPath(&quot;Index.html&quot;)));&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; catch (IOException e)&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; {&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw new RuntimeException(e);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160;&#160;&#160;&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; }&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; @Override&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; public void onLoad()&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; {&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; Label lab = (Label)getRoot().findComponent(&quot;lab3&quot;);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; lab.addComponent(new Literal(&quot;&lt;a href=\&quot;#\&quot;&gt;hi i am dynamic!!&lt;/a&gt;&quot;));&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; Integer count = (Integer)getViewSate().get(&quot;count&quot;);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; if (null == count)&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; {&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; count = 0;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; }&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; count ++;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; getViewSate().put(&quot;count&quot;, count);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; Button btn = new Button(&quot;Ok&quot; + count);&#160;&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160;&#160;&#160;&#160; lab.addComponent(btn);&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">&#160;&#160; }&#160;&#160;&#160; </span></li>
<li><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">}&#160; </span></li>
</ol>
<p><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none">public class Index extends Page   <br class="kix-line-break" />{    <br class="kix-line-break" />&#160;&#160; @Override    <br class="kix-line-break" />&#160;&#160; public String getTemplate()    <br class="kix-line-break" />&#160;&#160; {    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; try    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; {    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; return FileUtils.readFileToString(new File(getSession().getServletContext().getRealPath(&quot;Index.html&quot;)));    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; }    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; catch (IOException e)    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; {&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; throw new RuntimeException(e);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; }&#160;&#160;&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160; }    <br class="kix-line-break" />&#160;&#160; <br class="kix-line-break" />&#160;&#160; @Override    <br class="kix-line-break" />&#160;&#160; public void onLoad()    <br class="kix-line-break" />&#160;&#160; {    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; Label lab = (Label)getRoot().findComponent(&quot;lab3&quot;);    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; lab.addComponent(new Literal(&quot;&lt;a href=\&quot;#\&quot;&gt;hi i am dynamic!!&lt;/a&gt;&quot;));    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; Integer count = (Integer)getViewSate().get(&quot;count&quot;);    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; if (null == count)    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; {    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; count = 0;    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; }    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; count ++;    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; getViewSate().put(&quot;count&quot;, count);    <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; Button btn = new Button(&quot;Ok&quot; + count);&#160;&#160;&#160; <br class="kix-line-break" />&#160;&#160;&#160;&#160;&#160; lab.addComponent(btn);    <br class="kix-line-break" />&#160;&#160; }&#160;&#160; <br class="kix-line-break" />}</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: bold;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; Sopo则是由</span><a href="http://sourceforge.net/projects/nekohtml/"><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000099;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: underline">neko</span></a><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">解析模板,生成页面的组件树，web.sopo.template这个包下面包含了所有的模板解析类。每个page都有一个根组件</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">ComponentRoot web.sopo.page.Page.getRoot(),当开始绘制的时候则会从跟组件开始绘制。它的特点是可以在程序逻辑阶段动态的改变组件树的构造，上面的例子可以看到动态的加了个链接和按钮。使用了它的viewstate特性—存贮页面级变量，这和asp.net很像。</span>  <br /> <br />
<h3><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 14pt;vertical-align: baseline;font-weight: bold;text-decoration: none">比较</span></h3>
<p> <span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none">&#160;&#160;&#160;&#160; 这三种都支持模板(包括页面模板和组件模板)，共同特点是模板是html格式，美工可以直接编辑模板，没有讨厌的jsp标签.wicket取经于 tapestry,tapestry取经于asp.net,而sopo也是学asp.net并且和它最像。Wicket需要后台add对应模板的组件,通过匹配,这样做虽然可以动态的决定绘制组件的类型但是也比较繁琐,它类似于swing的方式，但是Mode这个概念入侵很大，通过session来保持状态。tapestry通过模板和组件的绘制来展示页面，不允许你new 一个组件，并且和prototype, scriptaculous集成了，它的performance是这三个中最快的，虽然page和组件都是pojo,但是有注入依赖，到底这个特性有没有用那是见仁见智了。Sopo则是比较灵活，可以动态的修改组件树，和asp.net非常接近，写组件和tapestry一样非常清晰，概念和实现都很单，缺点是它的性能只适用于中小型应用。</span>  <br /><span style="background-color: transparent;font-style: normal;font-family: arial;color: #000000;font-size: 11pt;vertical-align: baseline;font-weight: normal;text-decoration: none"></span></p>
