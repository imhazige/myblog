---
layout: post
title: "缓存算法和缓存策略"
date: 2011-11-09 10:56:59.000000000 +00:00
type: post
published: true
status: publish
categories:
- Web
tags:
- "缓存策略"
- "缓存算法"
meta:
  views: '158'
author:
  login: ig2net
  email: ig2net@ig2net.info
  display_name: "农夫一号"
  first_name: ''
  last_name: ''
---
<p><strong>缓存算法</strong>：</p>
<p>缓存法通过设计良好的数据分块、预取、顺序预取、缓存替换等算法来提高对缓存内容的命中率。缓存算法可以分为</p>
<ul>
<li>基于访问时间的策略</li>
<li>基于访问频率的策略</li>
<li>访问时间与频率兼顾策略</li>
<li>时间距离分布策略等类型</li>
<li>另有基于数据访问模式、基于VoD系统架构的策略等。</li>
</ul>
<p>&#160;</p>
<p><strong>缓存策略：</strong></p>
<p>缓存策略主要三方面:</p>
<ul>
<li>①缓存什么内容;</li>
<li>②何时进行缓存;</li>
<li>③当缓存空间已满时如何进行替换,即缓存替换算法。</li>
</ul>
<p>对于第二方面,大部分缓存算法使用预取策略来提前将部分磁盘数据放入缓存,以进一步减少磁盘I/O,加大缓存命中率。通过记录、分析以往的数据请求模式来预测将来可能被请求到的数据段,将访问可能性大的数据段放入缓存。</p>
<p><strong>缓存策略的分类：</strong></p>
<p>由于不同系统的数据访问模式不尽相同,同一种缓存策难以在各种数据访问模式下均取得满意性能,</p>
<p>研究人员提出不同缓存策略以适应不同需求。缓存策略可分为以下几类:</p>
<ul>
<li><strong>基于访问时间:</strong>此类算法按各缓存项的被访问时间来组织缓存队列,决定替换对象。如LRU。</li>
<li><strong>基于访问频率:</strong>此类算法用缓存项的被访问频率来组织缓存。如LFU、LRU-2、2Q、LIRS。</li>
<li><strong>访问时间与频率兼顾:</strong>通过兼顾访问时间与频率,使得在数据访问模式变化时缓存策略仍有较好性能。如FBR、LRFU、ALRFU。多数此类算法具有一个可调或自适应参数,通过该参数的调节使缓存策略在基于访问时间与频率间取得一定平衡。</li>
<li><strong>基于访问模式:</strong>某些应用有较明确的的数据访问特点,进而产生与其相适应的缓存策略。如专为VoD系统设计的A&amp;L缓存策略,同时适应随机、顺序两种访问模式的SARC策略。</li>
</ul>
<p>&#160;</p>
<p><strong>比较:</strong></p>
<ul>
<li>基于访问时间的缓存策略：</li>
</ul>
<blockquote><p>LRU (LeastRecentlyUsed,最近最少使用)是一种应用广泛的缓存算法。该算法维护一个缓存项队列,队列中的缓存项按每项的最后被访问时间排序。当缓存空间已满时,将处于队尾,即删除最后一次被访问时间距现在最久的项,将新的区段放入队列首部。</p>
<p>但LRU算法仅维护了缓存块的访问时间信息,没有考虑被访问频率等因素,在某些访问模式下无法获得理想命中率。例如对于VoD系统,在没有VCR操作的情况下,数据被由前至后顺序访问,已访问过的数据不会被再次访问。所以LRU算法将最新被访问的数据最后被替换不适用于VoD系统。</p>
</blockquote>
<ul>
<li>基于访问频率的缓存策略：</li>
</ul>
<blockquote><p>LFU (LeastFrequentlyUsed,最小频率使用)按每个缓存块的被访问频率将缓存中的各块排序,当缓存空间已满时,替换掉缓存队列中访问频率最低的一项。与LRU的缺点类似, LFU仅维护各项的被访问频率信息,对于某缓存项,如果该项在过去有着极高的访问频率而最近访问频率较低,当缓存空间已满时该项很难被从缓存中替换出来,进而导致命中率下降。</p>
<p>LRU-2[2, 3]算法记录下每个缓存页面最后两次被访问的时间。替换页面时替换掉倒数第二次访问时间距现在最久的一项。</p>
</blockquote>
<blockquote><p>在IRM (IndependentReferenceModel)访问模式下,LRU-2有着最好的预期命中率,由于LRU-2算法要维护一个优先级队列,所以该算法复杂度为logN(N为缓存队列中缓存项的数量)。</p>
<p>2Q[4](2 Queues)使用LRU队列替换了LRU-2中的优先级队列,将算法时间复杂度由logN降为常数,且维护缓存项的各信息所需空间比LRU-2小。</p>
<p>LIRS[5](Low Inter-ReferenceRecency Set)维护一个变长的LRU队列,该队列的LRU端为最近至少被访问过2次的第Llirs项(Llirs为算法参数)。LIRS算法在IRM访问模式下可以获得很高的命中率,但对于SDD访问模式效率明显下降。</p>
<p>对于VoD系统,基于访问频率的策略可以捕捉到热点影片片段,使得对热点片段的大量请求免于进行缓慢的磁盘I/O。但影片热点会随时间不断变化,且此类策略无法利用VoD的顺序访问模式,所以纯粹以访问频率为度量来进行替换操作不适合VoD系统。</p>
</blockquote>
<ul>
<li>兼顾访问时间与频率：</li>
</ul>
<blockquote><p>FBR[6](Frequency Based Replacement)维护一个LRU队列,并将该队列分为New、Middle、Old三段。对队列中的每一缓存项均维护一个计数值。当缓存中的一项被命中时,被命中的缓存项被移至New段的MRU端,如果该项原本位于Old或Middle段,则其计数值加1,原位于New段则计数值不变。当进行替换操作时,删除Old段计数值最小的一项(LRU端)。</p>
<p>LRFU[7](LeastRecently FrequentlyUsed)为每一个缓存项维护一个权值C(x),其初始值为0, C(x)按以下公式变化。</p>
<p>在t时刻, C(x) =1+2-λC(x): x被访问到2-λC(x) : x未被访问进行替换操作时,C(x)值最小的一项被删除。当时, LRFU算法行为类似于LFU;而当时,该算法行为逼近LRU算法。该算法通过选用合适的λ值来获得时间与频率因素的平衡。</p>
<p>LRFU虽然通过一个值来兼顾访问时间与频率因素,但由于值固定,当访问模式变化时,该算法无法做出相应的调整而造成性能下降。ALRFU[8](Adaptive LRFU)在此方面对LRFU进行了改进。通过对数据访问模式的历史进行监控,ALRFU动态调整值来适应数据访问模式的改变,表现出比LRFU更好的适应性。</p>
</blockquote>
<ul>
<li>基于访问模式的缓存策略：</li>
</ul>
<blockquote><p>文献[9]针对VoD系统的特点提出A&amp;L算法。该算法通过记录每个缓存项的历史访问时间与访问数量来估计该项的未来被访问频率。以该频率值为度量,在进行缓存替换时替换掉该值最小的一项。由于该算法考虑了VoD系统的数据访问特点,所以广泛应用于VoD系统。</p>
<p>但A&amp;L算法通过直接计算缓存区段生成以来的总的访问数量、频率来生成缓存权值,没有考虑VoD影片的访问热点会随时间不断变化。当某些缓存区段历史访问频率较高但最近访问频率下降时,仍保持较大权值,影响新的热点片段的缓存,无法适应影片热点的动态变化。</p>
<p>IBM提出的SARC[10]是针对于大型服务器的缓存算法,可在随机访问与顺序访问的数据访问模式下做出动态适应。SARC通过将随机访问与顺序访问分为两个队列分别管理来实现对两种不同访问模式的适应。并通过分析缓存大小-命中率的仿真试验数据曲线,得出对随机队列与顺序队列项分别进行替换的代价函数。当进行缓存替换时,通过两队列的代价函数来对代价小的队列进行替换。</p>
</blockquote>
<p>&#160;</p>
<p>常用的算法是LRU(最经最少使用)，FIFO(先进先出),随机</p>
<p>从oscache来看:</p>
<p>OSCache支持多种类型的缓存添加策略：LRU，FIFO，无限制，自定义   <br />OSCache支持多种类型的缓存过期策略：时间，cron表达式，编程计算</p>
<p>OSCache支持基于事件的触发机制：增加，修改，刷新，移除   <br /> OSCache支持开辟多个缓存区域，每个区域可以有不同的缓存策略    <br /> OSCache的刷新不单可以作用于单个对象，还可以作用于所有和对象相关的其它缓存数据</p>
<p>&#160;</p>
<p>参见:</p>
<p>&#160;<a href="http://blog.csdn.net/zhghost/article/details/5344962">http://blog.csdn.net/zhghost/article/details/5344962</a></p>
<p><a href="http://aguang520.iteye.com/blog/1016072">http://aguang520.iteye.com/blog/1016072</a></p>
