---
layout: post
title: javascript闭包
date: 2011-12-31 16:52:34.000000000 +00:00
type: post
published: true
status: publish
categories:
- Web前端
tags:
- "闭包"
meta:
  views: '26'
author:
  login: ig2net
  email: ig2net@ig2net.info
  display_name: "农夫一号"
  first_name: ''
  last_name: ''
---
<p>关于闭包，要说清楚那要说半天，见我转载的文章:<a href="http://kazge.com/archives/257.html">http://kazge.com/archives/257.html</a></p>
<p>我来说说这个经典问题:</p>
<div>
<pre>&lt;script language=&quot;<span style="color: #8b0000">javascript</span>&quot; type=&quot;<span style="color: #8b0000">text/javascript</span>&quot;&gt; 
<span style="color: #0000ff">var</span> li=<span style="color: #0000ff">document</span>.getElementsByTagName(&quot;<span style="color: #8b0000">li</span>&quot;); 
<span style="color: #0000ff">for</span>(<span style="color: #0000ff">var</span> i=0;i&lt;li.<span style="color: #0000ff">length</span>;i++){ 
  li[i].onclick=<span style="color: #0000ff">function</span>(){<span style="color: #0000ff">alert</span>(i);} 
} 
&lt;/script&gt;</pre>
</div>
<p></p>
<p>执行结果很“古怪”，每个li元素点击时都是显示相同的提示。</p>
<p>实际上理解了闭包的原理就很清楚了。</p>
<p>所谓闭包即函数定义和函数表达式位于另一个函数的函数体内。而且，这些内部函数可以访问它们所在的外部函数中声明的所有局部变量、参数和声明的其他内部函数。</p>
<p>重点是它可以访问上层范围的局部变量，闭包执行时它如果访问上层变量，那么访问到的是<font color="#0000ff">上层变量在闭包执行时的值。</font></p>
<p>这样就好理解所谓的经典问题了:</p>
<p>代码中闭包中访问了i是上层变量，这个循环结束后，i值为li元素的个数，当点击li元素时执行闭包，那么自然就是固定的值了。</p>
<p>正是具有这种特性闭包才如此的灵活。假如访问的上层变量是定义闭包时的值，那么闭包就不是闭包了。</p>
