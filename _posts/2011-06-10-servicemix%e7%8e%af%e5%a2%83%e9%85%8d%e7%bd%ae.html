---
layout: post
title: ServiceMix环境配置
date: 2011-06-10 17:11:12.000000000 +01:00
type: post
published: true
status: publish
categories:
- java
tags:
- esb
- j2ee
- java
meta:
  views: '333'
author:
  login: ig2net
  email: ig2net@ig2net.info
  display_name: "农夫一号"
  first_name: ''
  last_name: ''
---
<div class="Section1">
<p style="text-align: justify;margin-left: 0pt;margin-right: 0pt"><span><font size="3">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">配置使用的</font></span><span><font size="3">ServiceMix</font></span><span><font size="3">版本是</font></span><span><font size="3">servicemix-3.3</font></span><span><font size="3">，</font></span><span><font size="3">在</font></span><span><font size="3">tomcat5.5</font></span><span><font size="3">以上运行</font></span><span><font size="3">。</font></span><span><font size="3">(</font></span><span><font size="3">因为依赖包大部分是需要</font></span><span><font size="3">jdk1.5)</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">ServiceMix</font></span><span><font size="3">有三种部署</font></span><span><font size="3">方式</font></span><span><font size="3">：单独程序方式，</font></span><span><font size="3">servlet</font></span><span><font size="3">方式，</font></span><span><font size="3">与</font></span><span><font size="2">Geronimo and </font></span><span><font size="2">JB</font></span><span><font size="2">oss.</font></span><span><font size="2">整合方式。</font></span><span><font size="2">这里主要介绍</font></span><span><font size="2">servlet</font></span><span><font size="2">方式，</font></span><span><font size="2">因为这样可以整合到任何</font></span><span><font size="2">servlet</font></span><span><font size="2">容器中。</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">S</font></span><span><font size="2">ervlet</font></span><span><font size="2">部署需要在</font></span><span><font size="2">web.xml</font></span><span><font size="2">中配置</font></span><span><font size="2">spring</font></span><span><font size="2">加载文件</font></span><span><font size="2">，这种</font></span><span><font size="2">spring</font></span><span><font size="2">是和</font></span><span><font size="2">xbean</font></span><span><font size="2">整合的自定义配置文件。</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">配置文件说明</font></span><span><font size="2">:</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">W</font></span><span><font size="2">eb.xml</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&lt;?</font></span><span><font size="2">xml </font></span><span><font size="2">vers</font></span><span><font size="2">ion</font></span><span><font size="2">=</font></span><span><font size="2">&quot;1.0&quot; </font></span><span><font size="2">encoding</font></span><span><font size="2">=</font></span><span><font size="2">&quot;UTF-8&quot;</font></span><span><font size="2">?&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&lt;!</font></span><span><font size="2">DOCTYPE </font></span><span><font size="2">web-app</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">PUBLIC </font></span><span><font size="2">&quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&lt;</font></span><span><font size="2">web-app</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">display-name</font></span><span><font size="2">&gt;</font></span><span><font size="2">ServiceMix Web Application</font></span><span><font size="2">&lt;/</font></span><span><font size="2">display-name</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">description</font></span><span><font size="2">&gt;</font></span><span><font size="2">Deploys ServiceMix inside a Web Application</font></span><span><font size="2">&lt;/</font></span><span><font size="2">description</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">context-param</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">param-name</font></span><span><font size="2">&gt;</font></span><span><font size="2">contextConfigLocation</font></span><span><font size="2">&lt;/</font></span><span><font size="2">param-name</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">param-value</font></span><span><font size="2">&gt;</font></span><span><font size="2">/WEB-INF/jmx.xml /WEB-INF/core.xml /WEB-INF/activemq.xml</font></span><span><font size="2">&lt;/</font></span><span><font size="2">param-value</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">context-param</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">S</font></span><span><font size="3">pring</font></span><span><font size="3">配置文件</font></span></p></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">context-param</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">param-name</font></span><span><font size="2">&gt;</font></span><span><font size="2">contextClass</font></span><span><font size="2">&lt;/</font></span><span><font size="2">param-name</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">param-value</font></span><span><font size="2">&gt;</font></span><span><font size="2">org.apache.xbean.spring.context.XmlWebApplicationContext</font></span><span><font size="2">&lt;/</font></span><span><font size="2">param-value</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">context-param</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">listener</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">listener-class</font></span><span><font size="2">&gt;</font></span><span><font size="2">org.springframework.web.context.ContextLoaderListener</font></span><span><font size="2">&lt;/</font></span><span><font size="2">listener-class</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">listener</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt">
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">S</font></span><span><font size="3">pring </font></span><span><font size="3">监听器</font></span></p></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;!-- servlet mappings --&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;!-- the main JMX servlet --&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet-name</font></span><span><font size="2">&gt;</font></span><span><font size="2">JMXServlet</font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet-name</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet-class</font></span><span><font size="2">&gt;</font></span><span><font size="2">org.apache.servicemix.web.jmx.JMXServlet</font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet-class</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">load-on-startup</font></span><span><font size="2">&gt;</font></span><span><font size="2">1</font></span><span><font size="2">&lt;/</font></span><span><font size="2">load-on-startup</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;!--&#160; the HTTP binding servlet --&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;!-- START SNIPPET: servicemix-http--&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet-name</font></span><span><font size="2">&gt;</font></span><span><font size="2">HttpManagedServlet</font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet-name</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet-class</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; org.apache.servicemix.http.HttpManagedServlet</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet-class</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">load-on-startup</font></span><span><font size="2">&gt;</font></span><span><font size="2">1</font></span><span><font size="2">&lt;/</font></span><span><font size="2">load-on-startup</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt">
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">http bean</font></span><span><font size="3">组件</font></span><span><font size="3">(BC)servlet</font></span></p></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet-mapping</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet-name</font></span><span><font size="2">&gt;</font></span><span><font size="2">HttpManagedServlet</font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet-name</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">url-pattern</font></span><span><font size="2">&gt;</font></span><span><font size="2">/jbi/*</font></span><span><font size="2">&lt;/</font></span><span><font size="2">url-pattern</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet-mapping</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;!-- END SNIPPET: httpBinding --&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet-mapping</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">servlet-name</font></span><span><font size="2">&gt;</font></span><span><font size="2">JMXServlet</font></span><span><font size="2">&lt;/</font></span><span><font size="2">servl</font></span><span><font size="2">et-name</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">url-pattern</font></span><span><font size="2">&gt;</font></span><span><font size="2">/jmx/*</font></span><span><font size="2">&lt;/</font></span><span><font size="2">url-pattern</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">servlet-mapping</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&lt;/</font></span><span><font size="2">web-app</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">demo</font></span><span><font size="2">主要</font></span><span><font size="2">功能</font></span><span><font size="2">的配置在</font></span><span><font size="2">core.xml</font></span><span><font size="2">中</font></span><span><font size="2">:</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&lt;?</font></span><span><font size="2">xml </font></span><span><font size="2">version</font></span><span><font size="2">=</font></span><span><font size="2">&quot;1.0&quot; </font></span><span><font size="2">encoding</font></span><span><font size="2">=</font></span><span><font size="2">&quot;UTF-8&quot;</font></span><span><font size="2">?&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&lt;</font></span><span><font size="2">beans </font></span><span><font size="2">xmlns:sm</font></span><span><font size="2">=</font></span><span><font size="2">&quot;http://servicemix.apache.org/config/1.0&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">xmlns:http</font></span><span><font size="2">=</font></span><span><font size="2">&quot;http://servicemix.apache.org/http/1.</font></span><span><font size="2">0&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&#160;&#160;&#160;&#160; </font></span><span><font size="2">xmlns:my</font></span><span><font size="2">=</font></span><span><font size="2">&quot;http://servicemix.apache.org/demo/&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">xmlns:foo</font></span><span><font size="2">=</font></span><span><font size="2">&quot;http://servicemix.apache.org/demo/&quot;</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;!-- the JBI container --&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">sm:container </font></span><span><font size="2">id</font></span><span><font size="2">=</font></span><span><font size="2">&quot;jbi&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">rootDir</font></span><span><font size="2">=</font></span><span><font size="2">&quot;#rootDir&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">useMBeanServer</font></span><span><font size="2">=</font></span><span><font size="2">&quot;true&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&#160; </font></span><span><font size="2">createMBeanServer</font></span><span><font size="2">=</font></span><span><font size="2">&quot;false&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">MBeanServer</font></span><span><font size="2">=</font></span><span><font size="2">&quot;#jmxServer&quot; </font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">installationDirPath</font></span><span><font size="2">=</font></span><span><font size="2">&quot;#installDir&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">deploymentDirPath</font></span><span><font size="2">=</font></span><span><font size="2">&quot;#deployDir&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&#160; </font></span><span><font size="2">monitorInstallationDirectory</font></span><span><font size="2">=</font></span><span><font size="2">&quot;true&quot; </font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">transactionManager</font></span><span><font size="2">=</font></span><span><font size="2">&quot;#transactionManager&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">depends-on</font></span><span><font size="2">=</font></span><span><font size="2">&quot;broker&quot;</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">sm:activationSpecs</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;!--&#160; an example HTTP binding for use by the SpringBindingServlet&#160; --&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;!-- START SNIPPET: http --&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">sm:activationSpec </font></span><span><font size="2">componentName</font></span><span><font size="2">=</font></span><span><font size="2">&quot;servicemix-http&quot; </font></span><span><font size="2">service</font></span><span><font size="2">=</font></span><span><font size="2">&quot;foo:httpBinding&quot; </font></span><span><font size="2">destinationService</font></span><span><font size="2">=</font></span><span><font size="2">&quot;foo:echo&quot;</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">sm:component</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">http:component</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">http:configuration </font></span><span><font size="2">managed</font></span><span><font size="2">=</font></span><span><font size="2">&quot;true&quot; </font></span><span><font size="2">/&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">http:endpoints</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">http:endpoint </font></span><span><font size="2">service</font></span><span><font size="2">=</font></span><span><font size="2">&quot;foo:httpBinding&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">endpoint</font></span><span><font size="2">=</font></span><span><font size="2">&quot;endpoint&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">targetService</font></span><span><font size="2">=</font></span><span><font size="2">&quot;foo:echo&quot; </font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">role</font></span><span><font size="2">=</font></span><span><font size="2">&quot;consumer&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">locationURI</font></span><span><font size="2">=</font></span><span><font size="2">&quot;http://localhost/exampleUri/</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">配置</font></span><span><font size="3">url</font></span><span><font size="3">， 会被</font></span><span><font size="3">tomcat</font></span><span><font size="3">自动转换为</font></span><span><font size="3">serverapp/jbi/</font></span> <span><font size="2">exampleUri</font></span></p>
<p>   <span><font size="2">&quot;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">defaultMep</font></span><span><font size="2">=</font></span><span><font size="2">&quot;http://www.w3.org/2004/08/wsdl/in-out</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">消息请求方式是</font></span><span><font size="3">in-out,</font></span><span><font size="3">即期望又返回消息</font></span></p>
<p>   <span><font size="2">&quot; </font></span><span><font size="2">/&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">http:endpoints</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">http:component</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">sm:component</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">sm:activationSpec</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">使用</font></span><span><font size="3">http BC,</font></span><span><font size="3">作为一个消费者</font></span><span><font size="3">(</font></span><span><font size="3">consumer</font></span><span><font size="3">)</font></span><span><font size="3">目标指向</font></span><span><font size="3">服务引擎</font></span><span><font size="3">(SE)</font></span><span><font size="2">foo:echo</font></span></p></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;!-- END SNIPPET: http --&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;!--&#160; a simple Echo service to test InOut message exchanges using HTTP--&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">sm:activationSpec </font></span><span><font size="2">componentName</font></span><span><font size="2">=</font></span><span><font size="2">&quot;echo&quot; </font></span><span><font size="2">service</font></span><span><font size="2">=</font></span><span><font size="2">&quot;foo:echo&quot; </font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">sm:component</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">bean </font></span><span><font size="2">class</font></span><span><font size="2">=</font></span><span><font size="2">&quot;org.apache.servicemix.components.HelloWorldComponent&quot;</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;</font></span><span><font size="2">property </font></span><span><font size="2">name</font></span><span><font size="2">=</font></span><span><font size="2">&quot;property&quot; </font></span><span><font size="2">value</font></span><span><font size="2">=</font></span><span><font size="2">&quot;name&quot;</font></span><span><font size="2">/&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">bean</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">sm:component</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;&#160;&#160;&#160;&#160; </font></span><span><font size="2">&lt;/</font></span><span><font size="2">sm:activationSpec</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt">
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="3">SE </font></span><span><font size="2">foo:echo</font></span><span><font size="2">,</font></span><span><font size="2">这是一个简单的</font></span><span><font size="2">helloworld</font></span></p>
<p>   <span><font size="2">&lt;/</font></span><span><font size="2">beans</font></span><span><font size="2">&gt;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">经过这样的配置和在</font></span><span><font size="2">web.xml</font></span><span><font size="2">中配置的</font></span><span><font size="2">servlet,</font></span><span><font size="2">那么</font></span><span><font size="2">uri </font></span><span><font size="2">pattern</font></span><span><font size="2">形如</font></span> <span><font size="2">/jbi/</font></span><span><font size="2">exa</font></span><span><font size="2">mpleUri</font></span><span><font size="2">会</font></span><span><font size="2">请求</font></span><span><font size="2">foo:httpBinding</font></span><span><font size="2"> (BC)</font></span><span><font size="2">，在</font></span><span><font size="2">ESB</font></span><span><font size="2">内部</font></span><span><font size="2">foo:httpBinding</font></span><span><font size="2">通过消息</font></span><span><font size="2">路由</font></span><span><font size="2">(</font></span><span><font size="1">normalized message router</font></span><span><font size="2">)</font></span><span><font size="2">与</font></span><span><font size="2">foo:echo</font></span><span><font size="2">通信</font></span><span><font size="2">。</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">W</font></span><span><font size="2">eb</font></span><span><font size="2">测试页面</font></span><span><font size="2">链接为</font></span><a href="http://localhost:%28tomcat%E7%AB%AF%E5%8F%A3%29/ESB-ServerMix-Web/examples/"><span><u><font size="2">http://localhost:</font></u></span><span><u><font size="2">(tomcat</font></u></span><span><u><font size="2">端口</font></u></span><span><u><font size="2">)</font></u></span><span><u><font size="2">/ESB-ServerMix-Web/examples/</font></u></span></a></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="text-align: justify;margin-left: 0pt;margin-right: 0pt"><span><font size="3">需要在</font></span><span><font size="3">firefox</font></span><span><font size="3">下测试。</font></span></p>
<p style="text-align: justify;margin-left: 0pt;margin-right: 0pt"><span><font size="3">测试页面使用</font></span><span><font size="3">ajax</font></span><span><font size="3">请求</font></span><span><font size="2">/jbi/</font></span><span><font size="2">exampleUri</font></span><span><font size="3">经过</font></span><span><font size="3">foo:httpBinding</font></span><span><font size="3">,</font></span><span><font size="3"> foo:echo</font></span><span><font size="3">处理返回信息。</font></span></p>
<p style="margin-left: 0pt;margin-right: 0pt"><span><font size="2">&#160;</font></span></p>
<p style="text-align: justify;margin-left: 0pt;margin-right: 0pt"><span><font size="3">&#160;</font></span></p>
</p></div>
