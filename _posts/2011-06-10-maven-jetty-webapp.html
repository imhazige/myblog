---
layout: post
title: maven-jetty webapp
date: 2011-06-10 16:40:35.000000000 +01:00
type: post
published: true
status: publish
categories:
- java
tags:
- java
- maven
- web
meta:
  views: '344'
author:
  login: ig2net
  email: ig2net@ig2net.info
  display_name: "农夫一号"
  first_name: ''
  last_name: ''
---
<h3 id="sites-page-title-header" align="left">&#160;</h3>
<div class="sites-canvas-main">
<div>
<table class="sites-layout-name-one-column sites-layout-hbox zeroBorder" cellspacing="0">
<tbody>
<tr>
<td class="sites-layout-tile sites-tile-name-content-1">
<div dir="ltr">
<div>在myeclipse中，需要修改classpath,将输出文件夹指向src/main/webapp,这是maven指定的路径。                 </p>
<p><a href="http://www.blogjava.net/alwayscy/archive/2007/05/19/118584.html" rel="nofollow">天生一对&quot;Maven2+Jetty&quot; -- Maven2创建并管理WebApp，并使用Maven Jetty Plugin在Eclipse中调试</a></div>
<p>Maven2代比1代改进很多，其中主要强调的是--它不仅仅是个依赖包管理器!                 <br />开始先要推荐一个专讲Maven2的电子书给大家，对MAVEN学习相当有助益：<a href="http://www.mergere.com/m2book_download.jsp" rel="nofollow">Better Builds with Maven&#160;&#160; </p>
<p></a>                  <br />下面就专门介绍下Maven2对WEBAPP在管理和调试方面的支持。                  </p>
<p>1.创建项目</p>
<p>mvn archetype:create -DgroupId=com.mycompany.app -DartifactId=my-webapp -DarchetypeArtifactId=maven-archetype-webapp                 </p>
<p>也可参看<a href="http://maven.apache.org/guides/mini/guide-webapp.html" rel="nofollow">这里</a>                  </p>
<p>创建要注意遵循MAVEN的目录结构，尤其要注意源文件要放在main/java下：                  </p>
<p>2. POM文件的配置                  </p>
<p>这里要特别注意对resource一节的配置，因为我的SPRING以及WEB相关的XML是放在WEB-INF目录，为了在unit test的时候也能用，加入了对这些配置文件的引用。相当于加了一个classpath。                  </p>
<p>这里还有个插曲：不知为何MAVEN2里没有JTA的包，自动下载时会有提示教你如何手工通过命令加入，非常简单。                  </p>
<p>JETTY的plugin是为后面用它来调试做准备。                  </p>
<p>DWR也是目前WEB开发一个热选。                  </p>
<p>另外，为使用JAVA5代来编译，加入了maven-compiler-plugin一节。                  </p>
<div><font size="2"><span>&lt;</span><span>project </span><span>xmlns</span><span>=&quot;http://maven.apache.org/POM/4.0.0&quot;</span><span> xmlns:xsi</span><span>=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><span>                     <br />&#160; xsi:schemaLocation</span><span>=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd&quot;</span><span>&gt;</span><span>                     <br />&#160; </span><span>&lt;</span><span>modelVersion</span><span>&gt;</span><span>4.0.0</span><span>&lt;/</span><span>modelVersion</span><span>&gt;</span><span>                     <br />&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>com.exchangebit.nms</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>ebnms</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160; </span><span>&lt;</span><span>packaging</span><span>&gt;</span><span>war</span><span>&lt;/</span><span>packaging</span><span>&gt;</span><span>                     <br />&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>1.0-SNAPSHOT</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160; </span><span>&lt;</span><span>name</span><span>&gt;</span><span>ebnms Maven Webapp</span><span>&lt;/</span><span>name</span><span>&gt;</span><span>                     <br />&#160; </span><span>&lt;</span><span>url</span><span>&gt;</span><span>http://maven.apache.org</span><span>&lt;/</span><span>url</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160; </span><span>&lt;</span><span>build</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;</span><span>finalName</span><span>&gt;</span><span>ebnms</span><span>&lt;/</span><span>finalName</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>resources</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>resource</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>directory</span><span>&gt;</span><span>src/main/java</span><span>&lt;/</span><span>directory</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>includes</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>include</span><span>&gt;</span><span>**/*.xml</span><span>&lt;/</span><span>include</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>includes</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>resource</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>resource</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>directory</span><span>&gt;</span><span>src/main/webapp/WEB-INF</span><span>&lt;/</span><span>directory</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>includes</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>include</span><span>&gt;</span><span>**/*.xml</span><span>&lt;/</span><span>include</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>include</span><span>&gt;</span><span>**/log4j.properties</span><span>&lt;/</span><span>include</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>includes</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>resource</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>resources</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>plugins</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>plugin</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>org.apache.maven.plugins</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>maven-compiler-plugin</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>configuration</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>source</span><span>&gt;</span><span>1.5</span><span>&lt;/</span><span>source</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>target</span><span>&gt;</span><span>1.5</span><span>&lt;/</span><span>target</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>configuration</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>plugin</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>plugin</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>org.mortbay.jetty</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>maven-jetty-plugin</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>plugin</span><span>&gt;</span><span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;/</span><span>plugins</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>build</span><span>&gt;</span><span>&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160; </span><span>&lt;</span><span>dependencies</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>junit</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>junit</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>3.8.1</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>scope</span><span>&gt;</span><span>test</span><span>&lt;/</span><span>scope</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>org.hibernate</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>hibernate</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>3.1</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>log4j</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>log4j</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>1.2.11</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>mysql</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>mysql-connector-java</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>3.1.11</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>scope</span><span>&gt;</span><span>runtime</span><span>&lt;/</span><span>scope</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>javax.servlet</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>servlet-api</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>2.4</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>scope</span><span>&gt;</span><span>provided</span><span>&lt;/</span><span>scope</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>javax.servlet</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>jstl</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>1.1.2</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>scope</span><span>&gt;</span><span>runtime</span><span>&lt;/</span><span>scope</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>taglibs</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>standard</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>1.1.2</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>scope</span><span>&gt;</span><span>runtime</span><span>&lt;/</span><span>scope</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>org.springframework</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>spring</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>1.2.6</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160;&#160;&#160; </span><span>&lt;</span><span>dependency</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>groupId</span><span>&gt;</span><span>dwr</span><span>&lt;/</span><span>groupId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>artifactId</span><span>&gt;</span><span>dwr</span><span>&lt;/</span><span>artifactId</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160;&#160;&#160; </span><span>&lt;</span><span>version</span><span>&gt;</span><span>1.1.3</span><span>&lt;/</span><span>version</span><span>&gt;</span><span>                     <br />&#160;&#160;&#160; </span><span>&lt;/</span><span>dependency</span><span>&gt;</span><span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <br />&#160; </span><span>&lt;/</span><span>dependencies</span><span>&gt;</span><span>                     <br />&#160;&#160; <br /></span><span>&lt;/</span><span>project</span><span>&gt;</span>                    <br /></font></div>
<p>代码放入/main/java后，可以在项目目录下执行：                <br />mvn compile来做编译尝试，                <br />也可以用mvn war直接生成打包文件，                <br />当然最后可以用 mvn jetty:run来运行你的WEBAPP!                </p>
<p>3.&#160; 在Eclipse中配置jetty进行调试                <br />要把之前的项目导入Eclipse首先让maven为我们生成Eclipse工程文件，执行：                <br />mvn eclipse:eclipse                <br />再把M2_REPO加入到Eclipse的classpath中，有两种方法，其中的b)方法是有效的：                <br />a) mvn -Declipse.workspace=&lt;path-to-eclipse-workspace&gt; eclipse:add-maven-repo                <br />b) Window &gt; Preferences. Select the Java &gt; Build Path &gt; Classpath Variables page                </p>
<p>之后，就可以通过Eclipse的File-&gt;Import功能将工程导入。                </p>
<p>有人为了使用WEBAPP开发功能，而装象MYECLIPSE这样的巨物。有了JETTY，通过轻松配置就可以实现比TOMCAT更快更便捷的容器，所以在调试时强力推荐这个东东。下面就来看下如何配置。                </p>
<p>先下配置一个外部工具，来运行JETTY：                <br />选择菜单Run-&gt;External Tools-&gt;External Tools ...在左边选择Program，再点New：                <br />配置Location为mvn完整命令行。                </p>
<p>选择Working Directory为本项目。                </p>
<p>Arguments填写：jetty:run                </p>
<p>再点选Enviroment页：加入MAVEN_OPTS变量，值为：                <br />-Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,address=4000,server=y,suspend=y                <br />其中，如果suspend=n 表示不调试，直接运行。                </p>
<p>然后，点APPLY，再关闭本对话框。                <br />另外注意一点，好像external tool菜单项在java browering的perspective下才会出现。如果在java下看不见，可以切换下试试。                </p>
<p>下面新建运行配置：                <br />点选run-&gt;debug...                <br />选中左树中的Remote Java Application，再点New。                <br />选择你的项目，关键是要填和之前设置外部工具时相同的端口号。                </p>
<p>配置就完成了，正面开始调试运行：                <br />首先要把JETTY运行起来(有点象TOMCAT里的运行APPSERVER)，从Run-&gt;External Tools中选择之前配置的外部工具运行，这时LOG里会显示：                <br />listening at port 4000字样，                <br />再选择Run-&gt;Debug选择我们刚建的运行配置，这时程序就RUN起来了，可以通过WEB进行访问，设置断点调试了。                </p>
<p>后记：                <br />在ECLIPSE中，有更方便高效的调试方式，<a href="http://www.blogjava.net/alwayscy/archive/2007/09/13/144969.html" rel="nofollow">点这里</a></div>
</td>
</tr>
</tbody>
</table></div>
</p></div>
